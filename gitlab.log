Thank you for using GitLab Docker Image!
Current version: gitlab-ce=10.8.0-ce.0

Configure GitLab for your system by editing /etc/gitlab/gitlab.rb file
And restart this container to reload settings.
To do it use docker exec:

  docker exec -it gitlab vim /etc/gitlab/gitlab.rb
  docker restart gitlab

For a comprehensive list of configuration options please see the Omnibus GitLab readme
https://gitlab.com/gitlab-org/omnibus-gitlab/blob/master/README.md

If this container fails to start due to permission problems try to fix it by executing:

  docker exec -it gitlab update-permissions
  docker restart gitlab

Installing gitlab.rb config...
Generating ssh_host_rsa_key...
Generating public/private rsa key pair.
Your identification has been saved in /etc/gitlab/ssh_host_rsa_key.
Your public key has been saved in /etc/gitlab/ssh_host_rsa_key.pub.
The key fingerprint is:
SHA256:eROdz5lc9pKsctbZ6M9+nbE7Na87jyuPdT+WIbDorVc root@97ed981a1a04
The key's randomart image is:
+---[RSA 2048]----+
|                 |
|           . .   |
|          . o   o|
|         . o = *.|
|        S + o X .|
|         o o E O.|
|        . o = * &|
|         . *.+.@=|
|         .o .oOX@|
+----[SHA256]-----+
Generating ssh_host_ecdsa_key...
Generating public/private ecdsa key pair.
Your identification has been saved in /etc/gitlab/ssh_host_ecdsa_key.
Your public key has been saved in /etc/gitlab/ssh_host_ecdsa_key.pub.
The key fingerprint is:
SHA256:QkHYHGR3CBBAQ5dBGjMeJoeqyXMG5bWUXRA5BZLF/rE root@97ed981a1a04
The key's randomart image is:
+---[ECDSA 256]---+
|.+%o*%&BO+.      |
|.= Xo*+B..       |
|. = o + .        |
|.. . o . .       |
|o..   . S o      |
|oo o   . E       |
|  +              |
|                 |
|                 |
+----[SHA256]-----+
Generating ssh_host_ed25519_key...
Generating public/private ed25519 key pair.
Your identification has been saved in /etc/gitlab/ssh_host_ed25519_key.
Your public key has been saved in /etc/gitlab/ssh_host_ed25519_key.pub.
The key fingerprint is:
SHA256:Zw9YcwkjbcJqXdVdGA0VKYKKAQQ4jOSyeTY/sITZ6dk root@97ed981a1a04
The key's randomart image is:
+--[ED25519 256]--+
|=ooo.  ...+...oO*|
|=.   .  oo++ oo.o|
|.o    oo.+o + .  |
|.* . .o..o o     |
|= O  .  S +      |
| = B     o o     |
|  + E       .    |
|     .           |
|                 |
+----[SHA256]-----+
Preparing services...
Starting services...
Configuring GitLab package...
JSON file with existing configuration not found inside /opt/gitlab/embedded/nodes.
Skipping config check.
gitlab preinstall: 
gitlab preinstall: This node does not appear to be running a database
gitlab preinstall: Skipping version check, if you think this is an error exit now
gitlab preinstall: 
Configuring GitLab...
Starting Chef Client, version 13.6.4[0m
resolving cookbooks for run list: ["gitlab"][0m
Synchronizing Cookbooks:[0m
  - gitlab (0.0.1)[0m
  - package (0.1.0)[0m
  - postgresql (0.1.0)[0m
  - registry (0.1.0)[0m
  - mattermost (0.1.0)[0m
  - consul (0.0.0)[0m
  - gitaly (0.1.0)[0m
  - letsencrypt (0.1.0)[0m
  - nginx (0.1.0)[0m
  - runit (0.14.2)[0m
  - acme (3.1.0)[0m
  - crond (0.1.0)[0m
  - compat_resource (12.19.0)[0m
Installing Cookbook Gems:[0m
Compiling Cookbooks...[0m
Recipe: gitlab::default[0m
  * directory[/etc/gitlab] action create
    [32m- change mode from '0755' to '0775'[0m
[0m  Converging 458 resources[0m
  * directory[/etc/gitlab] action create (up to date)
  * directory[Create /var/opt/gitlab] action create
    [32m- change owner from 'git' to 'root'[0m
    [32m- change group from 'git' to 'root'[0m
[0m  * directory[/opt/gitlab/embedded/etc] action create
    [32m- create new directory /opt/gitlab/embedded/etc[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/embedded/etc/gitconfig] action create
    [32m- create new file /opt/gitlab/embedded/etc/gitconfig[0m
    [32m- update content in file /opt/gitlab/embedded/etc/gitconfig from none to 987af3[0m
    [37m--- /opt/gitlab/embedded/etc/gitconfig	2018-05-30 10:03:36.663708669 +0000[0m
    [37m+++ /opt/gitlab/embedded/etc/.chef-gitconfig20180530-48-188s9vm	2018-05-30 10:03:36.663708669 +0000[0m
    [37m@@ -1 +1,11 @@[0m
    [37m+[pack][0m
    [37m+  threads = 1[0m
    [37m+[receive][0m
    [37m+  fsckObjects = true[0m
    [37m+advertisePushOptions = true[0m
    [37m+[repack][0m
    [37m+  writeBitmaps = true[0m
    [37m+[transfer][0m
    [37m+  hideRefs=^refs/tmp/[0m
    [37m+hideRefs=^refs/keep-around/[0m
    [32m- change mode from '' to '0755'[0m
[0mRecipe: gitlab::web-server[0m
  * account[Webserver user and group] action create (up to date)
Recipe: gitlab::users[0m
  * directory[/var/opt/gitlab] action create (up to date)
  * account[GitLab user and group] action create (up to date)
  * template[/var/opt/gitlab/.gitconfig] action create
    [32m- create new file /var/opt/gitlab/.gitconfig[0m
    [32m- update content in file /var/opt/gitlab/.gitconfig from none to d9e90c[0m
    [37m--- /var/opt/gitlab/.gitconfig	2018-05-30 10:03:36.683708669 +0000[0m
    [37m+++ /var/opt/gitlab/.chef-.gitconfig20180530-48-1okp26g.gitconfig	2018-05-30 10:03:36.683708669 +0000[0m
    [37m@@ -1 +1,12 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m+[user][0m
    [37m+        name = GitLab[0m
    [37m+        email = gitlab@97ed981a1a04[0m
    [37m+[core][0m
    [37m+        autocrlf = input[0m
    [37m+[gc][0m
    [37m+        auto = 0[0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'git'[0m
    [32m- change group from '' to 'git'[0m
[0mRecipe: gitlab::gitlab-shell[0m
  * storage_directory[/var/opt/gitlab/.ssh] action create
    * ruby_block[directory resource: /var/opt/gitlab/.ssh] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/.ssh[0m
[0m  
[0m  * directory[/var/log/gitlab/gitlab-shell/] action create
    [32m- create new directory /var/log/gitlab/gitlab-shell/[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[/var/opt/gitlab/gitlab-shell] action create
    [32m- create new directory /var/opt/gitlab/gitlab-shell[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * templatesymlink[Create a config.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-shell/config.yml] action create
      [32m- create new file /var/opt/gitlab/gitlab-shell/config.yml[0m
      [32m- update content in file /var/opt/gitlab/gitlab-shell/config.yml from none to d824f9[0m
      [37m--- /var/opt/gitlab/gitlab-shell/config.yml	2018-05-30 10:03:36.943708669 +0000[0m
      [37m+++ /var/opt/gitlab/gitlab-shell/.chef-config20180530-48-82dbe1.yml	2018-05-30 10:03:36.943708669 +0000[0m
      [37m@@ -1 +1,44 @@[0m
      [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
      [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
      [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
      [37m+[0m
      [37m+# GitLab user. git by default[0m
      [37m+user: git[0m
      [37m+[0m
      [37m+# Url to gitlab instance. Used for api calls. Should end with a slash.[0m
      [37m+gitlab_url: "http://127.0.0.1:8080"[0m
      [37m+[0m
      [37m+http_settings:[0m
      [37m+  [0m
      [37m+#  user: someone[0m
      [37m+#  password: somepass[0m
      [37m+#  ca_file: /etc/ssl/cert.pem[0m
      [37m+#  ca_path: /etc/pki/tls/certs[0m
      [37m+#  self_signed_cert: false[0m
      [37m+[0m
      [37m+# File used as authorized_keys for gitlab user[0m
      [37m+auth_file: "/var/opt/gitlab/.ssh/authorized_keys"[0m
      [37m+[0m
      [37m+# Redis settings used for pushing commit notices to gitlab[0m
      [37m+redis:[0m
      [37m+  host: 127.0.0.1[0m
      [37m+  port: [0m
      [37m+  socket: /var/opt/gitlab/redis/redis.socket[0m
      [37m+  database: [0m
      [37m+  namespace: resque:gitlab[0m
      [37m+[0m
      [37m+# Log file.[0m
      [37m+# Default is gitlab-shell.log in the root directory.[0m
      [37m+log_file: "/var/log/gitlab/gitlab-shell/gitlab-shell.log"[0m
      [37m+[0m
      [37m+# Log level. INFO by default[0m
      [37m+log_level: [0m
      [37m+[0m
      [37m+[0m
      [37m+# Audit usernames.[0m
      [37m+# Set to true to see real usernames in the logs instead of key ids, which is easier to follow, but[0m
      [37m+# incurs an extra API call on every gitlab-shell command.[0m
      [37m+audit_usernames: [0m
      [37m+[0m
      [37m+[0m
[0m    * link[Link /opt/gitlab/embedded/service/gitlab-shell/config.yml to /var/opt/gitlab/gitlab-shell/config.yml] action create
      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-shell/config.yml to /var/opt/gitlab/gitlab-shell/config.yml[0m
[0m  
[0m  * link[/opt/gitlab/embedded/service/gitlab-shell/.gitlab_shell_secret] action create
    [32m- create symlink at /opt/gitlab/embedded/service/gitlab-shell/.gitlab_shell_secret to /opt/gitlab/embedded/service/gitlab-rails/.gitlab_shell_secret[0m
[0m  * execute[/opt/gitlab/embedded/service/gitlab-shell/bin/gitlab-keys check-permissions] action run
    [32m- execute /opt/gitlab/embedded/service/gitlab-shell/bin/gitlab-keys check-permissions[0m
[0m  * bash[Set proper security context on ssh files for selinux] action run (skipped due to only_if)
Recipe: gitlab::gitlab-rails[0m
  * storage_directory[/var/opt/gitlab/git-data] action create
    * ruby_block[directory resource: /var/opt/gitlab/git-data] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/git-data[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/git-data/repositories] action create
    * ruby_block[directory resource: /var/opt/gitlab/git-data/repositories] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/git-data/repositories[0m
[0m  
[0m  * directory[/var/log/gitlab] action create
    [32m- change owner from 'root' to 'git'[0m
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/artifacts] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/artifacts] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/artifacts[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/lfs-objects] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/lfs-objects] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/lfs-objects[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/uploads] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/uploads] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/uploads[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-ci/builds] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-ci/builds] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-ci/builds[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/cache] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/cache] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/cache[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/tmp] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/tmp] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/tmp[0m
[0m  
[0m  * storage_directory[/var/opt/gitlab/gitlab-rails/shared/pages] action create
    * ruby_block[directory resource: /var/opt/gitlab/gitlab-rails/shared/pages] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/gitlab-rails/shared/pages[0m
[0m  
[0m  * directory[create /var/opt/gitlab/gitlab-rails/etc] action create
    [32m- create new directory /var/opt/gitlab/gitlab-rails/etc[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[create /opt/gitlab/etc/gitlab-rails] action create
    [32m- create new directory /opt/gitlab/etc/gitlab-rails[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[create /var/opt/gitlab/gitlab-rails/working] action create
    [32m- create new directory /var/opt/gitlab/gitlab-rails/working[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[create /var/opt/gitlab/gitlab-rails/tmp] action create
    [32m- create new directory /var/opt/gitlab/gitlab-rails/tmp[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[create /var/opt/gitlab/gitlab-rails/upgrade-status] action create
    [32m- create new directory /var/opt/gitlab/gitlab-rails/upgrade-status[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[create /var/log/gitlab/gitlab-rails] action create
    [32m- create new directory /var/log/gitlab/gitlab-rails[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * storage_directory[/var/opt/gitlab/backups] action create
    * ruby_block[directory resource: /var/opt/gitlab/backups] action run
      [32m- execute the ruby block directory resource: /var/opt/gitlab/backups[0m
[0m  
[0m  * directory[/var/opt/gitlab/gitlab-rails] action create
    [32m- change owner from 'root' to 'git'[0m
[0m  * directory[/var/opt/gitlab/gitlab-ci] action create
    [32m- change owner from 'root' to 'git'[0m
[0m  * file[/var/opt/gitlab/gitlab-rails/etc/gitlab-registry.key] action create (skipped due to only_if)
  * template[/opt/gitlab/etc/gitlab-rails/gitlab-rails-rc] action create
    [32m- create new file /opt/gitlab/etc/gitlab-rails/gitlab-rails-rc[0m
    [32m- update content in file /opt/gitlab/etc/gitlab-rails/gitlab-rails-rc from none to 15c7d9[0m
    [37m--- /opt/gitlab/etc/gitlab-rails/gitlab-rails-rc	2018-05-30 10:03:39.293708669 +0000[0m
    [37m+++ /opt/gitlab/etc/gitlab-rails/.chef-gitlab-rails-rc20180530-48-1pkwdec	2018-05-30 10:03:39.293708669 +0000[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+gitlab_user='git'[0m
[0m  * file[/opt/gitlab/embedded/service/gitlab-rails/.secret] action delete (up to date)
  * file[/var/opt/gitlab/gitlab-rails/etc/secret] action delete (up to date)
  * templatesymlink[Create a database.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/database.yml] action create
      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/database.yml[0m
      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/database.yml from none to 00a743[0m
      [37m--- /var/opt/gitlab/gitlab-rails/etc/database.yml	2018-05-30 10:03:39.303708669 +0000[0m
      [37m+++ /var/opt/gitlab/gitlab-rails/etc/.chef-database20180530-48-bz1esq.yml	2018-05-30 10:03:39.303708669 +0000[0m
      [37m@@ -1 +1,23 @@[0m
      [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
      [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
      [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
      [37m+[0m
      [37m+production:[0m
      [37m+  adapter: postgresql[0m
      [37m+  encoding: unicode[0m
      [37m+  collation: [0m
      [37m+  database: gitlabhq_production[0m
      [37m+  pool: 10[0m
      [37m+  username: "gitlab"[0m
      [37m+  password: [0m
      [37m+  host: "/var/opt/gitlab/postgresql"[0m
      [37m+  port: 5432[0m
      [37m+  socket: [0m
      [37m+  sslmode: [0m
      [37m+  sslrootcert: [0m
      [37m+  sslca: [0m
      [37m+  load_balancing: {"hosts":[]}[0m
      [37m+  prepared_statements: false[0m
      [37m+  statements_limit: 1000[0m
      [37m+  fdw: [0m
      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
[0m    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/database.yml to /var/opt/gitlab/gitlab-rails/etc/database.yml] action create
      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/database.yml to /var/opt/gitlab/gitlab-rails/etc/database.yml[0m
[0m  
[0m  * templatesymlink[Create a secrets.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/secrets.yml] action create
      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/secrets.yml[0m
      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/secrets.yml from none to 1a06a3[0m
      [32m- suppressed sensitive resource[0m
      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
[0m    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml to /var/opt/gitlab/gitlab-rails/etc/secrets.yml] action create
      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml to /var/opt/gitlab/gitlab-rails/etc/secrets.yml[0m
[0m  
[0m  * templatesymlink[Create a resque.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/resque.yml] action create
      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/resque.yml[0m
      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/resque.yml from none to ec4232[0m
      [37m--- /var/opt/gitlab/gitlab-rails/etc/resque.yml	2018-05-30 10:03:39.333708669 +0000[0m
      [37m+++ /var/opt/gitlab/gitlab-rails/etc/.chef-resque20180530-48-83wmtw.yml	2018-05-30 10:03:39.333708669 +0000[0m
      [37m@@ -1 +1,3 @@[0m
      [37m+production:[0m
      [37m+  url: unix:/var/opt/gitlab/redis/redis.socket[0m
      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
[0m    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/resque.yml to /var/opt/gitlab/gitlab-rails/etc/resque.yml] action create
      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/resque.yml to /var/opt/gitlab/gitlab-rails/etc/resque.yml[0m
[0m  
[0m  * templatesymlink[Create a redis.cache.yml and create a symlink to Rails root] action create (skipped due to not_if)
  * templatesymlink[Create a redis.queues.yml and create a symlink to Rails root] action create (skipped due to not_if)
  * templatesymlink[Create a redis.shared_state.yml and create a symlink to Rails root] action create (skipped due to not_if)
  * templatesymlink[Create a aws.yml and create a symlink to Rails root] action delete
    * file[/var/opt/gitlab/gitlab-rails/etc/aws.yml] action delete (up to date)
    * link[/opt/gitlab/embedded/service/gitlab-rails/config/aws.yml] action delete (up to date)
     (up to date)
  * templatesymlink[Create a smtp_settings.rb and create a symlink to Rails root] action delete
    * file[/var/opt/gitlab/gitlab-rails/etc/smtp_settings.rb] action delete (up to date)
    * link[/opt/gitlab/embedded/service/gitlab-rails/config/initializers/smtp_settings.rb] action delete (up to date)
     (up to date)
  * templatesymlink[Create a gitlab.yml and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/gitlab.yml] action create
      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/gitlab.yml[0m
      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab.yml from none to 8c8dc8[0m
      [37m--- /var/opt/gitlab/gitlab-rails/etc/gitlab.yml	2018-05-30 10:03:39.343708669 +0000[0m
      [37m+++ /var/opt/gitlab/gitlab-rails/etc/.chef-gitlab20180530-48-fxa588.yml	2018-05-30 10:03:39.343708669 +0000[0m
      [37m@@ -1 +1,509 @@[0m
      [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
      [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
      [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
      [37m+[0m
      [37m+production: &base[0m
      [37m+  #[0m
      [37m+  # 1. GitLab app settings[0m
      [37m+  # ==========================[0m
      [37m+[0m
      [37m+  ## GitLab settings[0m
      [37m+  gitlab:[0m
      [37m+    ## Web server settings (note: host is the FQDN, do not include http://)[0m
      [37m+    host: 97ed981a1a04[0m
      [37m+    port: 80[0m
      [37m+    https: false[0m
      [37m+[0m
      [37m+    # Uncommment this line below if your ssh host is different from HTTP/HTTPS one[0m
      [37m+    # (you'd obviously need to replace ssh.host_example.com with your own host).[0m
      [37m+    # Otherwise, ssh host will be set to the `host:` value above[0m
      [37m+    ssh_host: [0m
      [37m+[0m
      [37m+    # WARNING: See config/application.rb under "Relative url support" for the list of[0m
      [37m+    # other files that need to be changed for relative url support[0m
      [37m+    relative_url_root: [0m
      [37m+[0m
      [37m+    # Trusted Proxies[0m
      [37m+    # Customize if you have GitLab behind a reverse proxy which is running on a different machine.[0m
      [37m+    # Add the IP address for your reverse proxy to the list, otherwise users will appear signed in from that address.[0m
      [37m+    trusted_proxies:[0m
      [37m+[0m
      [37m+    # Uncomment and customize if you can't use the default user to run GitLab (default: 'git')[0m
      [37m+    user: git[0m
      [37m+[0m
      [37m+    ## Date & Time settings[0m
      [37m+    time_zone: [0m
      [37m+[0m
      [37m+    ## Email settings[0m
      [37m+    # Uncomment and set to false if you need to disable email sending from GitLab (default: true)[0m
      [37m+    email_enabled: [0m
      [37m+    # Email address used in the "From" field in mails sent by GitLab[0m
      [37m+    email_from: gitlab@97ed981a1a04[0m
      [37m+    email_display_name: [0m
      [37m+    email_reply_to: [0m
      [37m+    email_subject_suffix: [0m
      [37m+[0m
      [37m+    # Email server smtp settings are in [a separate file](initializers/smtp_settings.rb.sample).[0m
      [37m+[0m
      [37m+    ## User settings[0m
      [37m+    default_can_create_group:   # default: true[0m
      [37m+    username_changing_enabled:  # default: true - User can change her username/namespace[0m
      [37m+    ## Default theme[0m
      [37m+    ##   1 - Graphite[0m
      [37m+    ##   2 - Charcoal[0m
      [37m+    ##   3 - Green[0m
      [37m+    ##   4 - Gray[0m
      [37m+    ##   5 - Violet[0m
      [37m+    ##   6 - Blue[0m
      [37m+    default_theme:  # default: 2[0m
      [37m+[0m
      [37m+    ## Automatic issue closing[0m
      [37m+    # If a commit message matches this regular expression, all issues referenced from the matched text will be closed.[0m
      [37m+    # This happens when the commit is pushed or merged into the default branch of a project.[0m
      [37m+    # When not specified the default issue_closing_pattern as specified below will be used.[0m
      [37m+    # Tip: you can test your closing pattern at http://rubular.com[0m
      [37m+    issue_closing_pattern: [0m
      [37m+[0m
      [37m+    ## Default project features settings[0m
      [37m+    default_projects_features:[0m
      [37m+      issues: [0m
      [37m+      merge_requests: [0m
      [37m+      wiki: [0m
      [37m+      snippets: [0m
      [37m+      builds: [0m
      [37m+      container_registry: [0m
      [37m+[0m
      [37m+    ## Webhook settings[0m
      [37m+    # Number of seconds to wait for HTTP response after sending webhook HTTP POST request (default: 10)[0m
      [37m+    webhook_timeout: [0m
      [37m+[0m
      [37m+    ## Repository downloads directory[0m
      [37m+    # When a user clicks e.g. 'Download zip' on a project, a temporary zip file is created in the following directory.[0m
      [37m+    # The default is 'tmp/repositories' relative to the root of the Rails app.[0m
      [37m+    repository_downloads_path: [0m
      [37m+[0m
      [37m+    usage_ping_enabled: [0m
      [37m+[0m
      [37m+  ## Reply by email[0m
      [37m+  # Allow users to comment on issues and merge requests by replying to notification emails.[0m
      [37m+  # For documentation on how to set this up, see https://docs.gitlab.com/ce/administration/reply_by_email.html[0m
      [37m+  incoming_email:[0m
      [37m+    enabled: false[0m
      [37m+[0m
      [37m+    # The email address including the `%{key}` placeholder that will be replaced to reference the item being replied to.[0m
      [37m+    # The placeholder can be omitted but if present, it must appear in the "user" part of the address (before the `@`).[0m
      [37m+    address: [0m
      [37m+[0m
      [37m+    # Email account username[0m
      [37m+    # With third party providers, this is usually the full email address.[0m
      [37m+    # With self-hosted email servers, this is usually the user part of the email address.[0m
      [37m+    user: [0m
      [37m+    # Email account password[0m
      [37m+    password: [0m
      [37m+[0m
      [37m+    # IMAP server host[0m
      [37m+    host: [0m
      [37m+    # IMAP server port[0m
      [37m+    port: [0m
      [37m+    # Whether the IMAP server uses SSL[0m
      [37m+    ssl: [0m
      [37m+    # Whether the IMAP server uses StartTLS[0m
      [37m+    start_tls: [0m
      [37m+[0m
      [37m+    # The mailbox where incoming mail will end up. Usually "inbox".[0m
      [37m+    mailbox: "inbox"[0m
      [37m+    # The IDLE command timeout.[0m
      [37m+    idle_timeout: [0m
      [37m+[0m
      [37m+  ## Build Artifacts[0m
      [37m+  artifacts:[0m
      [37m+    enabled: true[0m
      [37m+    # The location where Build Artifacts are stored (default: shared/artifacts).[0m
      [37m+    path: /var/opt/gitlab/gitlab-rails/shared/artifacts[0m
      [37m+    object_store:[0m
      [37m+      enabled: false[0m
      [37m+      direct_upload: false[0m
      [37m+      background_upload: true[0m
      [37m+      proxy_download: false[0m
      [37m+      remote_directory: "artifacts"[0m
      [37m+      connection: {}[0m
      [37m+[0m
      [37m+  ## Git LFS[0m
      [37m+  lfs:[0m
      [37m+    enabled: [0m
      [37m+    # The location where LFS objects are stored (default: shared/lfs-objects).[0m
      [37m+    storage_path: /var/opt/gitlab/gitlab-rails/shared/lfs-objects[0m
      [37m+    object_store:[0m
      [37m+      enabled: false[0m
      [37m+      direct_upload: false[0m
      [37m+      background_upload: true[0m
      [37m+      proxy_download: false[0m
      [37m+      remote_directory: "lfs-objects"[0m
      [37m+      connection: {}[0m
      [37m+[0m
      [37m+  ## Uploads[0m
      [37m+  uploads:[0m
      [37m+    # The location where uploads objects are stored (default: public/).[0m
      [37m+    storage_path: /opt/gitlab/embedded/service/gitlab-rails/public[0m
      [37m+    object_store:[0m
      [37m+      enabled: false[0m
      [37m+      direct_upload: false[0m
      [37m+      background_upload: true[0m
      [37m+      proxy_download: false[0m
      [37m+      remote_directory: "uploads"[0m
      [37m+      connection: {}[0m
      [37m+[0m
      [37m+  ## Container Registry[0m
      [37m+  registry:[0m
      [37m+    enabled: false[0m
      [37m+    host: [0m
      [37m+    port: [0m
      [37m+    api_url:  # internal address to the registry, will be used by GitLab to directly communicate with API[0m
      [37m+    path: [0m
      [37m+    key: /var/opt/gitlab/gitlab-rails/etc/gitlab-registry.key[0m
      [37m+    issuer: omnibus-gitlab-issuer[0m
      [37m+[0m
      [37m+  mattermost:[0m
      [37m+    enabled: false[0m
      [37m+    host: [0m
      [37m+[0m
      [37m+  ## GitLab Pages[0m
      [37m+  pages:[0m
      [37m+    enabled: false[0m
      [37m+    path: /var/opt/gitlab/gitlab-rails/shared/pages[0m
      [37m+    host: [0m
      [37m+    port: [0m
      [37m+    https: false[0m
      [37m+    external_http: null[0m
      [37m+    external_https: null[0m
      [37m+    artifacts_server: true[0m
      [37m+[0m
      [37m+  ## Gravatar[0m
      [37m+  ## For Libravatar see: https://docs.gitlab.com/ce/customization/libravatar.html[0m
      [37m+  gravatar:[0m
      [37m+    # gravatar urls: possible placeholders: %{hash} %{size} %{email}[0m
      [37m+    plain_url:      # default: http://www.gravatar.com/avatar/%{hash}?s=%{size}&d=identicon[0m
      [37m+    ssl_url:       # default: https://secure.gravatar.com/avatar/%{hash}?s=%{size}&d=identicon[0m
      [37m+[0m
      [37m+  ## Sidekiq[0m
      [37m+  sidekiq:[0m
      [37m+    log_format: default[0m
      [37m+[0m
      [37m+  ## Auxiliary jobs[0m
      [37m+  # Periodically executed jobs, to self-heal GitLab, do external synchronizations, etc.[0m
      [37m+  # Please read here for more information: https://github.com/ondrejbartas/sidekiq-cron#adding-cron-job[0m
      [37m+  cron_jobs:[0m
      [37m+    # Flag stuck CI builds as failed[0m
      [37m+    stuck_ci_jobs_worker:[0m
      [37m+      cron:[0m
      [37m+    # Remove expired build artifacts[0m
      [37m+    expire_build_artifacts_worker:[0m
      [37m+      cron:[0m
      [37m+    # Schedule pipelines in the near future[0m
      [37m+    pipeline_schedule_worker:[0m
      [37m+      cron:[0m
      [37m+    # Periodically run 'git fsck' on all repositories. If started more than[0m
      [37m+    # once per hour you will have concurrent 'git fsck' jobs.[0m
      [37m+    repository_check_worker:[0m
      [37m+      cron:[0m
      [37m+    # Send admin emails once a week[0m
      [37m+    admin_email_worker:[0m
      [37m+      cron:[0m
      [37m+[0m
      [37m+    # Remove outdated repository archives[0m
      [37m+    repository_archive_cache_worker:[0m
      [37m+      cron:[0m
      [37m+[0m
      [37m+    # Verify custom GitLab Pages domains[0m
      [37m+    pages_domain_verification_cron_worker:[0m
      [37m+      cron:[0m
      [37m+[0m
      [37m+    ##[0m
      [37m+    # GitLab EE only jobs:[0m
      [37m+[0m
      [37m+    # Snapshot active users statistics[0m
      [37m+[0m
      [37m+    # In addition to refreshing users when they log in,[0m
      [37m+    # periodically refresh LDAP users membership.[0m
      [37m+    # NOTE: This will only take effect if LDAP is enabled[0m
      [37m+[0m
      [37m+    # GitLab LDAP group sync worker[0m
      [37m+    # NOTE: This will only take effect if LDAP is enabled[0m
      [37m+[0m
      [37m+    # GitLab Geo repository sync worker[0m
      [37m+    # NOTE: This will only take effect if Geo is enabled[0m
      [37m+[0m
      [37m+    # GitLab Geo file download dispatch worker[0m
      [37m+    # NOTE: This will only take effect if Geo is enabled[0m
      [37m+[0m
      [37m+    # GitLab Geo repository verification primary batch worker[0m
      [37m+    # NOTE: This will only take effect if Geo is enabled[0m
      [37m+[0m
      [37m+    # GitLab Geo repository verification secondary scheduler worker[0m
      [37m+    # NOTE: This will only take effect if Geo is enabled[0m
      [37m+[0m
      [37m+    # GitLab Geo migrated local files clean up worker[0m
      [37m+    # NOTE: This will only take effect if Geo is enabled (secondary nodes only)[0m
      [37m+[0m
      [37m+  #[0m
      [37m+  # 2. GitLab CI settings[0m
      [37m+  # ==========================[0m
      [37m+[0m
      [37m+  gitlab_ci:[0m
      [37m+    # Default project notifications settings:[0m
      [37m+    #[0m
      [37m+    # Send emails only on broken builds (default: true)[0m
      [37m+    all_broken_builds: [0m
      [37m+    #[0m
      [37m+    # Add pusher to recipients list (default: false)[0m
      [37m+    add_pusher: [0m
      [37m+[0m
      [37m+    # The location where build traces are stored (default: builds/). Relative paths are relative to Rails.root[0m
      [37m+    builds_path: /var/opt/gitlab/gitlab-ci/builds[0m
      [37m+[0m
      [37m+  #[0m
      [37m+  # 3. Auth settings[0m
      [37m+  # ==========================[0m
      [37m+[0m
      [37m+  ## LDAP settings[0m
      [37m+  # You can inspect a sample of the LDAP users with login access by running:[0m
      [37m+  #   bundle exec rake gitlab:ldap:check RAILS_ENV=production[0m
      [37m+  ldap:[0m
      [37m+    enabled: false[0m
      [37m+    sync_time: [0m
      [37m+    host: [0m
      [37m+    port: [0m
      [37m+    uid: [0m
      [37m+    method:  # "tls" or "ssl" or "plain"[0m
      [37m+    bind_dn: [0m
      [37m+    password: [0m
      [37m+    active_directory: [0m
      [37m+    allow_username_or_email_login: [0m
      [37m+    lowercase_usernames: [0m
      [37m+    base: [0m
      [37m+    user_filter: [0m
      [37m+[0m
      [37m+    ## EE only[0m
      [37m+    group_base: [0m
      [37m+    admin_group: [0m
      [37m+    sync_ssh_keys: [0m
      [37m+    sync_time: [0m
      [37m+[0m
      [37m+  ## Kerberos settings[0m
      [37m+  kerberos:[0m
      [37m+    # Allow the HTTP Negotiate authentication method for Git clients[0m
      [37m+    enabled: [0m
      [37m+[0m
      [37m+    # Kerberos 5 keytab file. The keytab file must be readable by the GitLab user,[0m
      [37m+    # and should be different from other keytabs in the system.[0m
      [37m+    # (default: use default keytab from Krb5 config)[0m
      [37m+    keytab: [0m
      [37m+[0m
      [37m+    # The Kerberos service name to be used by GitLab.[0m
      [37m+    # (default: accept any service name in keytab file)[0m
      [37m+    service_principal_name: [0m
      [37m+[0m
      [37m+    # Dedicated port: Git before 2.4 does not fall back to Basic authentication if Negotiate fails.[0m
      [37m+    # To support both Basic and Negotiate methods with older versions of Git, configure[0m
      [37m+    # nginx to proxy GitLab on an extra port (e.g. 8443) and uncomment the following lines[0m
      [37m+    # to dedicate this port to Kerberos authentication. (default: false)[0m
      [37m+    use_dedicated_port: [0m
      [37m+    port: [0m
      [37m+    https: [0m
      [37m+[0m
      [37m+[0m
      [37m+  ## OmniAuth settings[0m
      [37m+  omniauth:[0m
      [37m+    # Allow login via Twitter, Google, etc. using OmniAuth providers[0m
      [37m+    enabled: false[0m
      [37m+[0m
      [37m+    # Uncomment this to automatically sign in with a specific omniauth provider's without[0m
      [37m+    # showing GitLab's sign-in page (default: show the GitLab sign-in page)[0m
      [37m+    auto_sign_in_with_provider: [0m
      [37m+[0m
      [37m+    # Sync user's email address from the specified Omniauth provider every time the user logs[0m
      [37m+    # in (default: nil). And consequently make this field read-only.[0m
      [37m+[0m
      [37m+    # Sync user's profile from the specified Omniauth providers every time the user logs in (default: empty).[0m
      [37m+    # Define the allowed providers using an array, e.g. ["cas3", "saml", "twitter"],[0m
      [37m+    # or as true/false to allow all providers or none.[0m
      [37m+    # sync_profile_from_provider: [][0m
      [37m+[0m
      [37m+    # Select which info to sync from the providers above. (default: email).[0m
      [37m+    # Define the synced profile info using an array. Available options are "name", "email" and "location"[0m
      [37m+    # e.g. ["name", "email", "location"] or as true to sync all available.[0m
      [37m+    # This consequently will make the selected attributes read-only.[0m
      [37m+    # sync_profile_attributes: true[0m
      [37m+[0m
      [37m+    # CAUTION![0m
      [37m+    # This allows users to login without having a user account first. Define the allowed[0m
      [37m+    # providers using an array, e.g. ["saml", "twitter"][0m
      [37m+    # User accounts will be created automatically when authentication was successful.[0m
      [37m+    allow_single_sign_on: ["saml"][0m
      [37m+[0m
      [37m+    # Locks down those users until they have been cleared by the admin (default: true).[0m
      [37m+    block_auto_created_users: [0m
      [37m+    # Look up new users in LDAP servers. If a match is found (same uid), automatically[0m
      [37m+    # link the omniauth identity with the LDAP account. (default: false)[0m
      [37m+    auto_link_ldap_user: [0m
      [37m+[0m
      [37m+    # Allow users with existing accounts to login and auto link their account via SAML[0m
      [37m+    # login, without having to do a manual login first and manually add SAML[0m
      [37m+    # (default: false)[0m
      [37m+    auto_link_saml_user: null[0m
      [37m+[0m
      [37m+    # Set different Omniauth providers as external so that all users creating accounts[0m
      [37m+    # via these providers will not be able to have access to internal projects. You[0m
      [37m+    # will need to use the full name of the provider, like `google_oauth2` for Google.[0m
      [37m+    # Refer to the examples below for the full names of the supported providers.[0m
      [37m+    # (default: [])[0m
      [37m+    external_providers: null[0m
      [37m+[0m
      [37m+    ## Auth providers[0m
      [37m+    # Uncomment the following lines and fill in the data of the auth provider you want to use[0m
      [37m+    # If your favorite auth provider is not listed you can use others:[0m
      [37m+    # see https://github.com/gitlabhq/gitlab-public-wiki/wiki/Custom-omniauth-provider-configurations[0m
      [37m+    # The 'app_id' and 'app_secret' parameters are always passed as the first two[0m
      [37m+    # arguments, followed by optional 'args' which can be either a hash or an array.[0m
      [37m+    # Documentation for this is available at https://docs.gitlab.com/ce/integration/omniauth.html[0m
      [37m+    providers:[0m
      [37m+      # - { name: 'google_oauth2', app_id: 'YOUR APP ID',[0m
      [37m+      #     app_secret: 'YOUR APP SECRET',[0m
      [37m+      #     args: { access_type: 'offline', approval_prompt: '' } }[0m
      [37m+      # - { name: 'twitter', app_id: 'YOUR APP ID',[0m
      [37m+      #     app_secret: 'YOUR APP SECRET'}[0m
      [37m+      # - { name: 'github', app_id: 'YOUR APP ID',[0m
      [37m+      #     app_secret: 'YOUR APP SECRET',[0m
      [37m+      #     args: { scope: 'user:email' } }[0m
      [37m+[0m
      [37m+  # Shared file storage settings[0m
      [37m+  shared:[0m
      [37m+    path: /var/opt/gitlab/gitlab-rails/shared[0m
      [37m+[0m
      [37m+  # Gitaly settings[0m
      [37m+  # This setting controls whether GitLab uses Gitaly[0m
      [37m+  # Eventually Gitaly use will become mandatory and[0m
      [37m+  # this option will disappear.[0m
      [37m+  gitaly:[0m
      [37m+    client_path: /opt/gitlab/embedded/bin[0m
      [37m+    token: ""[0m
      [37m+[0m
      [37m+[0m
      [37m+  #[0m
      [37m+  # 4. Advanced settings[0m
      [37m+  # ==========================[0m
      [37m+[0m
      [37m+  ## Repositories settings[0m
      [37m+  repositories:[0m
      [37m+    # Paths where repositories can be stored. Give the canonicalized absolute pathname.[0m
      [37m+    # NOTE: REPOS PATHS MUST NOT CONTAIN ANY SYMLINK!!![0m
      [37m+    storages: {"default":{"path":"/var/opt/gitlab/git-data/repositories","gitaly_address":"unix:/var/opt/gitlab/gitaly/gitaly.socket"}}[0m
      [37m+[0m
      [37m+  ## Backup settings[0m
      [37m+  backup:[0m
      [37m+    path: "/var/opt/gitlab/backups"   # Relative paths are relative to Rails.root (default: tmp/backups/)[0m
      [37m+    archive_permissions:  # Permissions for the resulting backup.tar file (default: 0600)[0m
      [37m+    keep_time:    # default: 0 (forever) (in seconds)[0m
      [37m+    pg_schema:    # default: nil, it means that all schemas will be backed up[0m
      [37m+    upload:[0m
      [37m+      # Fog storage connection settings, see http://fog.io/storage/ .[0m
      [37m+      connection: [0m
      [37m+      # The remote 'directory' to store your backups. For S3, this would be the bucket name.[0m
      [37m+      remote_directory: [0m
      [37m+      multipart_chunk_size: [0m
      [37m+      encryption: [0m
      [37m+      storage_class: [0m
      [37m+[0m
      [37m+  ## GitLab Shell settings[0m
      [37m+  gitlab_shell:[0m
      [37m+    path: /opt/gitlab/embedded/service/gitlab-shell/[0m
      [37m+    hooks_path: /opt/gitlab/embedded/service/gitlab-shell/hooks/[0m
      [37m+[0m
      [37m+    # Git over HTTP[0m
      [37m+    upload_pack: [0m
      [37m+    receive_pack: [0m
      [37m+[0m
      [37m+    # If you use non-standard ssh port you need to specify it[0m
      [37m+    ssh_port: [0m
      [37m+[0m
      [37m+    # Git import/fetch timeout[0m
      [37m+    git_timeout: 10800[0m
      [37m+[0m
      [37m+  ## Git settings[0m
      [37m+  # CAUTION![0m
      [37m+  # Use the default values unless you really know what you are doing[0m
      [37m+  git:[0m
      [37m+    bin_path: /opt/gitlab/embedded/bin/git[0m
      [37m+[0m
      [37m+  monitoring:[0m
      [37m+    # Time between sampling of unicorn socket metrics, in seconds[0m
      [37m+    unicorn_sampler_interval: 10[0m
      [37m+    # IP whitelist controlling access to monitoring endpoints[0m
      [37m+    ip_whitelist:[0m
      [37m+      - 127.0.0.0/8[0m
      [37m+    # Sidekiq exporter is webserver built in to Sidekiq to expose Prometheus metrics[0m
      [37m+    sidekiq_exporter:[0m
      [37m+      enabled: true[0m
      [37m+      address: 127.0.0.1[0m
      [37m+      port: 8082[0m
      [37m+[0m
      [37m+  #[0m
      [37m+  # 5. Extra customization[0m
      [37m+  # ==========================[0m
      [37m+[0m
      [37m+  extra:[0m
      [37m+[0m
      [37m+[0m
      [37m+  rack_attack:[0m
      [37m+    git_basic_auth: [0m
      [37m+[0m
      [37m+[0m
      [37m+development:[0m
      [37m+  <<: *base[0m
      [37m+[0m
      [37m+test:[0m
      [37m+  <<: *base[0m
      [37m+  gravatar:[0m
      [37m+    enabled: true[0m
      [37m+  gitlab:[0m
      [37m+    host: localhost[0m
      [37m+    port: 80[0m
      [37m+[0m
      [37m+    # When you run tests we clone and setup gitlab-shell[0m
      [37m+    # In order to setup it correctly you need to specify[0m
      [37m+    # your system username you use to run GitLab[0m
      [37m+    # user: YOUR_USERNAME[0m
      [37m+  repositories:[0m
      [37m+    storages:[0m
      [37m+      default: { "path": "tmp/tests/repositories/" }[0m
      [37m+  gitlab_shell:[0m
      [37m+    path: tmp/tests/gitlab-shell/[0m
      [37m+    hooks_path: tmp/tests/gitlab-shell/hooks/[0m
      [37m+  issues_tracker:[0m
      [37m+    redmine:[0m
      [37m+      title: "Redmine"[0m
      [37m+      project_url: "http://redmine/projects/:issues_tracker_id"[0m
      [37m+      issues_url: "http://redmine/:project_id/:issues_tracker_id/:id"[0m
      [37m+      new_issue_url: "http://redmine/projects/:issues_tracker_id/issues/new"[0m
      [37m+    jira:[0m
      [37m+      title: "JIRA"[0m
      [37m+      url: https://samplecompany.example.net[0m
      [37m+      project_key: PROJECT[0m
      [37m+  ldap:[0m
      [37m+    enabled: false[0m
      [37m+    servers:[0m
      [37m+      main:[0m
      [37m+        label: ldap[0m
      [37m+        host: 127.0.0.1[0m
      [37m+        port: 3890[0m
      [37m+        uid: 'uid'[0m
      [37m+        method: 'plain' # "tls" or "ssl" or "plain"[0m
      [37m+        base: 'dc=example,dc=com'[0m
      [37m+        user_filter: ''[0m
      [37m+        group_base: 'ou=groups,dc=example,dc=com'[0m
      [37m+        admin_group: ''[0m
      [37m+        sync_ssh_keys: false[0m
      [37m+[0m
      [37m+staging:[0m
      [37m+  <<: *base[0m
      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
[0m    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/gitlab.yml to /var/opt/gitlab/gitlab-rails/etc/gitlab.yml] action create
      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/gitlab.yml to /var/opt/gitlab/gitlab-rails/etc/gitlab.yml[0m
[0m  
[0m  * templatesymlink[Create a rack_attack.rb and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/rack_attack.rb] action create
      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/rack_attack.rb[0m
      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/rack_attack.rb from none to a61b95[0m
      [37m--- /var/opt/gitlab/gitlab-rails/etc/rack_attack.rb	2018-05-30 10:03:39.383708669 +0000[0m
      [37m+++ /var/opt/gitlab/gitlab-rails/etc/.chef-rack_attack20180530-48-1dj4m7k.rb	2018-05-30 10:03:39.383708669 +0000[0m
      [37m@@ -1 +1,32 @@[0m
      [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
      [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
      [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
      [37m+[0m
      [37m+# 1. Rename this file to rack_attack.rb[0m
      [37m+# 2. Review the paths_to_be_protected and add any other path you need protecting[0m
      [37m+#[0m
      [37m+[0m
      [37m+paths_to_be_protected = [[0m
      [37m+  "#{Rails.application.config.relative_url_root}/users/password",[0m
      [37m+  "#{Rails.application.config.relative_url_root}/users/sign_in",[0m
      [37m+  "#{Rails.application.config.relative_url_root}/api/#{API::API.version}/session.json",[0m
      [37m+  "#{Rails.application.config.relative_url_root}/api/#{API::API.version}/session",[0m
      [37m+  "#{Rails.application.config.relative_url_root}/users",[0m
      [37m+  "#{Rails.application.config.relative_url_root}/users/confirmation",[0m
      [37m+  "#{Rails.application.config.relative_url_root}/unsubscribes/",[0m
      [37m+  "#{Rails.application.config.relative_url_root}/import/github/personal_access_token",[0m
      [37m+][0m
      [37m+[0m
      [37m+# Create one big regular expression that matches strings starting with any of[0m
      [37m+# the paths_to_be_protected.[0m
      [37m+paths_regex = Regexp.union(paths_to_be_protected.map { |path| /\A#{Regexp.escape(path)}/ })[0m
      [37m+rack_attack_enabled = Gitlab.config.rack_attack.git_basic_auth['enabled'][0m
      [37m+[0m
      [37m+unless Rails.env.test? || !rack_attack_enabled[0m
      [37m+  Rack::Attack.throttle('protected paths', limit: 10, period: 60.seconds) do |req|[0m
      [37m+    if req.post? && req.path =~ paths_regex[0m
      [37m+      req.ip[0m
      [37m+    end[0m
      [37m+  end[0m
      [37m+end[0m
      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
[0m    * link[Link /opt/gitlab/embedded/service/gitlab-rails/config/initializers/rack_attack.rb to /var/opt/gitlab/gitlab-rails/etc/rack_attack.rb] action create
      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/config/initializers/rack_attack.rb to /var/opt/gitlab/gitlab-rails/etc/rack_attack.rb[0m
[0m  
[0m  * templatesymlink[Create a gitlab_workhorse_secret and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret] action create
      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret[0m
      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret from none to 196469[0m
      [32m- suppressed sensitive resource[0m
      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
[0m    * link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret] action create
      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_workhorse_secret[0m
[0m  
[0m  * templatesymlink[Create a gitlab_shell_secret and create a symlink to Rails root] action create
    * template[/var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret] action create
      [32m- create new file /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret[0m
      [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret from none to a316a6[0m
      [32m- suppressed sensitive resource[0m
      [32m- change mode from '' to '0644'[0m
      [32m- change owner from '' to 'root'[0m
      [32m- change group from '' to 'root'[0m
[0m    * link[Link /opt/gitlab/embedded/service/gitlab-rails/.gitlab_shell_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret] action create
      [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/.gitlab_shell_secret to /var/opt/gitlab/gitlab-rails/etc/gitlab_shell_secret[0m
[0m  
[0m  * link[/opt/gitlab/embedded/service/gitlab-rails/config/initializers/relative_url.rb] action delete (up to date)
  * file[/var/opt/gitlab/gitlab-rails/etc/relative_url.rb] action delete (up to date)
  * env_dir[/opt/gitlab/etc/gitlab-rails/env] action create
    * directory[/opt/gitlab/etc/gitlab-rails/env] action create
      [32m- create new directory /opt/gitlab/etc/gitlab-rails/env[0m
[0m    * file[/opt/gitlab/etc/gitlab-rails/env/HOME] action create
      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/HOME[0m
      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/HOME from none to 205bb9[0m
      [37m--- /opt/gitlab/etc/gitlab-rails/env/HOME	2018-05-30 10:03:39.423708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitlab-rails/env/.chef-HOME20180530-48-8s62jl	2018-05-30 10:03:39.423708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+/var/opt/gitlab[0m
[0m    * file[/opt/gitlab/etc/gitlab-rails/env/RAILS_ENV] action create
      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/RAILS_ENV[0m
      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/RAILS_ENV from none to ab8e18[0m
      [37m--- /opt/gitlab/etc/gitlab-rails/env/RAILS_ENV	2018-05-30 10:03:39.423708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitlab-rails/env/.chef-RAILS_ENV20180530-48-1vdclyh	2018-05-30 10:03:39.423708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+production[0m
[0m    * file[/opt/gitlab/etc/gitlab-rails/env/LD_PRELOAD] action create
      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/LD_PRELOAD[0m
      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/LD_PRELOAD from none to f79114[0m
      [37m--- /opt/gitlab/etc/gitlab-rails/env/LD_PRELOAD	2018-05-30 10:03:39.433708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitlab-rails/env/.chef-LD_PRELOAD20180530-48-1krbefa	2018-05-30 10:03:39.433708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+/opt/gitlab/embedded/lib/libjemalloc.so[0m
[0m    * file[/opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS] action create
      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS[0m
      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS from none to 6cce36[0m
      [37m--- /opt/gitlab/etc/gitlab-rails/env/SIDEKIQ_MEMORY_KILLER_MAX_RSS	2018-05-30 10:03:39.433708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitlab-rails/env/.chef-SIDEKIQ_MEMORY_KILLER_MAX_RSS20180530-48-grhwd5	2018-05-30 10:03:39.433708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+1000000[0m
[0m    * file[/opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE] action create
      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE[0m
      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE from none to 28d586[0m
      [37m--- /opt/gitlab/etc/gitlab-rails/env/BUNDLE_GEMFILE	2018-05-30 10:03:39.433708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitlab-rails/env/.chef-BUNDLE_GEMFILE20180530-48-1uk5alc	2018-05-30 10:03:39.433708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+/opt/gitlab/embedded/service/gitlab-rails/Gemfile[0m
[0m    * file[/opt/gitlab/etc/gitlab-rails/env/PATH] action create
      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/PATH[0m
      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/PATH from none to d5dc07[0m
      [37m--- /opt/gitlab/etc/gitlab-rails/env/PATH	2018-05-30 10:03:39.433708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitlab-rails/env/.chef-PATH20180530-48-hqzs5w	2018-05-30 10:03:39.433708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+/opt/gitlab/bin:/opt/gitlab/embedded/bin:/bin:/usr/bin[0m
[0m    * file[/opt/gitlab/etc/gitlab-rails/env/ICU_DATA] action create
      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/ICU_DATA[0m
      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/ICU_DATA from none to a04260[0m
      [37m--- /opt/gitlab/etc/gitlab-rails/env/ICU_DATA	2018-05-30 10:03:39.443708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitlab-rails/env/.chef-ICU_DATA20180530-48-ane2jp	2018-05-30 10:03:39.443708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+/opt/gitlab/embedded/share/icu/current[0m
[0m    * file[/opt/gitlab/etc/gitlab-rails/env/PYTHONPATH] action create
      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/PYTHONPATH[0m
      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/PYTHONPATH from none to 990cc2[0m
      [37m--- /opt/gitlab/etc/gitlab-rails/env/PYTHONPATH	2018-05-30 10:03:39.443708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitlab-rails/env/.chef-PYTHONPATH20180530-48-1xtf2oi	2018-05-30 10:03:39.443708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+/opt/gitlab/embedded/lib/python3.4/site-packages[0m
[0m    * file[/opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME] action create
      [32m- create new file /opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME[0m
      [32m- update content in file /opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME from none to 75081b[0m
      [37m--- /opt/gitlab/etc/gitlab-rails/env/EXECJS_RUNTIME	2018-05-30 10:03:39.443708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitlab-rails/env/.chef-EXECJS_RUNTIME20180530-48-1eyi7cc	2018-05-30 10:03:39.443708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+Disabled[0m
[0m  
[0m  * link[/opt/gitlab/embedded/service/gitlab-rails/tmp] action create
    [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/tmp to /var/opt/gitlab/gitlab-rails/tmp[0m
[0m  * link[/opt/gitlab/embedded/service/gitlab-rails/public/uploads] action create
    [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/public/uploads to /var/opt/gitlab/gitlab-rails/uploads[0m
[0m  * link[/opt/gitlab/embedded/service/gitlab-rails/log] action create
    [32m- create symlink at /opt/gitlab/embedded/service/gitlab-rails/log to /var/log/gitlab/gitlab-rails[0m
[0m  * link[/var/log/gitlab/gitlab-rails/sidekiq.log] action create
    [32m- create symlink at /var/log/gitlab/gitlab-rails/sidekiq.log to /var/log/gitlab/sidekiq/current[0m
[0m  * file[/opt/gitlab/embedded/service/gitlab-rails/db/schema.rb] action create
    [32m- change owner from 'root' to 'git'[0m
[0m  * remote_file[/var/opt/gitlab/gitlab-rails/VERSION] action create
    [32m- create new file /var/opt/gitlab/gitlab-rails/VERSION[0m
    [32m- update content in file /var/opt/gitlab/gitlab-rails/VERSION from none to bc6c5c[0m
    [37m--- /var/opt/gitlab/gitlab-rails/VERSION	2018-05-30 10:03:39.463708669 +0000[0m
    [37m+++ /var/opt/gitlab/gitlab-rails/.chef-VERSION20180530-48-1sq2t8t	2018-05-30 10:03:39.463708669 +0000[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+10.8.0[0m
[0m  * remote_file[/var/opt/gitlab/gitlab-rails/REVISION] action create
    [32m- create new file /var/opt/gitlab/gitlab-rails/REVISION[0m
    [32m- update content in file /var/opt/gitlab/gitlab-rails/REVISION from none to e8b975[0m
    [37m--- /var/opt/gitlab/gitlab-rails/REVISION	2018-05-30 10:03:39.463708669 +0000[0m
    [37m+++ /var/opt/gitlab/gitlab-rails/.chef-REVISION20180530-48-9gelec	2018-05-30 10:03:39.463708669 +0000[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+55e4a0b[0m
[0m  * file[/var/opt/gitlab/gitlab-rails/RUBY_VERSION] action create
    [32m- create new file /var/opt/gitlab/gitlab-rails/RUBY_VERSION[0m
    [32m- update content in file /var/opt/gitlab/gitlab-rails/RUBY_VERSION from none to 3dd12e[0m
    [37m--- /var/opt/gitlab/gitlab-rails/RUBY_VERSION	2018-05-30 10:03:39.463708669 +0000[0m
    [37m+++ /var/opt/gitlab/gitlab-rails/.chef-RUBY_VERSION20180530-48-1a9lx86	2018-05-30 10:03:39.463708669 +0000[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+ruby 2.3.7p456 (2018-03-28 revision 63024) [x86_64-linux][0m
[0m  * execute[chown -R root:root /opt/gitlab/embedded/service/gitlab-rails/public] action run
    [32m- execute chown -R root:root /opt/gitlab/embedded/service/gitlab-rails/public[0m
[0m  * execute[clear the gitlab-rails cache] action nothing (skipped due to action :nothing)
  * file[/var/opt/gitlab/gitlab-rails/config.ru] action delete (up to date)
Recipe: gitlab::add_trusted_certs[0m
  * directory[/etc/gitlab/trusted-certs] action create
    [32m- create new directory /etc/gitlab/trusted-certs[0m
    [32m- change mode from '' to '0755'[0m
[0m  * directory[/opt/gitlab/embedded/ssl/certs] action create (up to date)
  * file[/opt/gitlab/embedded/ssl/certs/README] action create
    [32m- create new file /opt/gitlab/embedded/ssl/certs/README[0m
    [32m- update content in file /opt/gitlab/embedded/ssl/certs/README from none to 623059[0m
    [37m--- /opt/gitlab/embedded/ssl/certs/README	2018-05-30 10:03:41.373708669 +0000[0m
    [37m+++ /opt/gitlab/embedded/ssl/certs/.chef-README20180530-48-1dzqpdx	2018-05-30 10:03:41.373708669 +0000[0m
    [37m@@ -1 +1,4 @@[0m
    [37m+This directory is managed by omnibus-gitlab.[0m
    [37m+ Any file placed in this directory will be ignored[0m
    [37m+. Place certificates in /etc/gitlab/trusted-certs.[0m
    [32m- change mode from '' to '0644'[0m
[0m  * ruby_block[Move existing certs and link to /opt/gitlab/embedded/ssl/certs] action run

  * Moving existing certificates found in /opt/gitlab/embedded/ssl/certs

  * Symlinking existing certificates found in /etc/gitlab/trusted-certs

    [32m- execute the ruby block Move existing certs and link to /opt/gitlab/embedded/ssl/certs[0m
[0mRecipe: gitlab::default[0m
  * service[create a temporary unicorn service] action nothing (skipped due to action :nothing)
  * service[create a temporary sidekiq service] action nothing (skipped due to action :nothing)
  * service[create a temporary mailroom service] action nothing (skipped due to action :nothing)
Recipe: gitlab::redis[0m
  * account[user and group for redis] action create (up to date)
  * group[Socket group] action create (up to date)
  * directory[/var/opt/gitlab/redis] action create
    [32m- change mode from '0755' to '0750'[0m
    [32m- change group from 'gitlab-redis' to 'git'[0m
[0m  * directory[/var/log/gitlab/redis] action create
    [32m- create new directory /var/log/gitlab/redis[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-redis'[0m
[0m  * template[/var/opt/gitlab/redis/redis.conf] action create
    [32m- create new file /var/opt/gitlab/redis/redis.conf[0m
    [32m- update content in file /var/opt/gitlab/redis/redis.conf from none to d493be[0m
    [37m--- /var/opt/gitlab/redis/redis.conf	2018-05-30 10:03:41.443708669 +0000[0m
    [37m+++ /var/opt/gitlab/redis/.chef-redis20180530-48-1fvgdhe.conf	2018-05-30 10:03:41.443708669 +0000[0m
    [37m@@ -1 +1,1062 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m+# Redis configuration file example.[0m
    [37m+#[0m
    [37m+# Note that in order to read the configuration file, Redis must be[0m
    [37m+# started with the file path as first argument:[0m
    [37m+#[0m
    [37m+# ./redis-server /path/to/redis.conf[0m
    [37m+[0m
    [37m+# Note on units: when memory size is needed, it is possible to specify[0m
    [37m+# it in the usual form of 1k 5GB 4M and so forth:[0m
    [37m+#[0m
    [37m+# 1k => 1000 bytes[0m
    [37m+# 1kb => 1024 bytes[0m
    [37m+# 1m => 1000000 bytes[0m
    [37m+# 1mb => 1024*1024 bytes[0m
    [37m+# 1g => 1000000000 bytes[0m
    [37m+# 1gb => 1024*1024*1024 bytes[0m
    [37m+#[0m
    [37m+# units are case insensitive so 1GB 1Gb 1gB are all the same.[0m
    [37m+[0m
    [37m+################################## INCLUDES ###################################[0m
    [37m+[0m
    [37m+# Include one or more other config files here.  This is useful if you[0m
    [37m+# have a standard template that goes to all Redis servers but also need[0m
    [37m+# to customize a few per-server settings.  Include files can include[0m
    [37m+# other files, so use this wisely.[0m
    [37m+#[0m
    [37m+# Notice option "include" won't be rewritten by command "CONFIG REWRITE"[0m
    [37m+# from admin or Redis Sentinel. Since Redis always uses the last processed[0m
    [37m+# line as value of a configuration directive, you'd better put includes[0m
    [37m+# at the beginning of this file to avoid overwriting config change at runtime.[0m
    [37m+#[0m
    [37m+# If instead you are interested in using includes to override configuration[0m
    [37m+# options, it is better to use include as the last line.[0m
    [37m+#[0m
    [37m+# include /path/to/local.conf[0m
    [37m+# include /path/to/other.conf[0m
    [37m+[0m
    [37m+################################## NETWORK #####################################[0m
    [37m+[0m
    [37m+# By default, if no "bind" configuration directive is specified, Redis listens[0m
    [37m+# for connections from all the network interfaces available on the server.[0m
    [37m+# It is possible to listen to just one or multiple selected interfaces using[0m
    [37m+# the "bind" configuration directive, followed by one or more IP addresses.[0m
    [37m+#[0m
    [37m+# Examples:[0m
    [37m+#[0m
    [37m+# bind 192.168.1.100 10.0.0.1[0m
    [37m+# bind 127.0.0.1 ::1[0m
    [37m+#[0m
    [37m+# ~~~ WARNING ~~~ If the computer running Redis is directly exposed to the[0m
    [37m+# internet, binding to all the interfaces is dangerous and will expose the[0m
    [37m+# instance to everybody on the internet. So by default we uncomment the[0m
    [37m+# following bind directive, that will force Redis to listen only into[0m
    [37m+# the IPv4 lookback interface address (this means Redis will be able to[0m
    [37m+# accept connections only from clients running into the same computer it[0m
    [37m+# is running).[0m
    [37m+#[0m
    [37m+# IF YOU ARE SURE YOU WANT YOUR INSTANCE TO LISTEN TO ALL THE INTERFACES[0m
    [37m+# JUST COMMENT THE FOLLOWING LINE.[0m
    [37m+# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [37m+bind 127.0.0.1[0m
    [37m+[0m
    [37m+# Protected mode is a layer of security protection, in order to avoid that[0m
    [37m+# Redis instances left open on the internet are accessed and exploited.[0m
    [37m+#[0m
    [37m+# When protected mode is on and if:[0m
    [37m+#[0m
    [37m+# 1) The server is not binding explicitly to a set of addresses using the[0m
    [37m+#    "bind" directive.[0m
    [37m+# 2) No password is configured.[0m
    [37m+#[0m
    [37m+# The server only accepts connections from clients connecting from the[0m
    [37m+# IPv4 and IPv6 loopback addresses 127.0.0.1 and ::1, and from Unix domain[0m
    [37m+# sockets.[0m
    [37m+#[0m
    [37m+# By default protected mode is enabled. You should disable it only if[0m
    [37m+# you are sure you want clients from other hosts to connect to Redis[0m
    [37m+# even if no authentication is configured, nor a specific set of interfaces[0m
    [37m+# are explicitly listed using the "bind" directive.[0m
    [37m+# protected-mode yes[0m
    [37m+[0m
    [37m+# Accept connections on the specified port, default is 6379 (IANA #815344).[0m
    [37m+# If port 0 is specified Redis will not listen on a TCP socket.[0m
    [37m+port 0[0m
    [37m+[0m
    [37m+# TCP listen() backlog.[0m
    [37m+#[0m
    [37m+# In high requests-per-second environments you need an high backlog in order[0m
    [37m+# to avoid slow clients connections issues. Note that the Linux kernel[0m
    [37m+# will silently truncate it to the value of /proc/sys/net/core/somaxconn so[0m
    [37m+# make sure to raise both the value of somaxconn and tcp_max_syn_backlog[0m
    [37m+# in order to get the desired effect.[0m
    [37m+# tcp-backlog 511[0m
    [37m+[0m
    [37m+# Unix socket.[0m
    [37m+#[0m
    [37m+# Specify the path for the Unix socket that will be used to listen for[0m
    [37m+# incoming connections. There is no default, so Redis will not listen[0m
    [37m+# on a unix socket when not specified.[0m
    [37m+#[0m
    [37m+unixsocket /var/opt/gitlab/redis/redis.socket[0m
    [37m+unixsocketperm 777[0m
    [37m+[0m
    [37m+# Close the connection after a client is idle for N seconds (0 to disable)[0m
    [37m+timeout 60[0m
    [37m+[0m
    [37m+# TCP keepalive.[0m
    [37m+#[0m
    [37m+# If non-zero, use SO_KEEPALIVE to send TCP ACKs to clients in absence[0m
    [37m+# of communication. This is useful for two reasons:[0m
    [37m+#[0m
    [37m+# 1) Detect dead peers.[0m
    [37m+# 2) Take the connection alive from the point of view of network[0m
    [37m+#    equipment in the middle.[0m
    [37m+#[0m
    [37m+# On Linux, the specified value (in seconds) is the period used to send ACKs.[0m
    [37m+# Note that to close the connection the double of the time is needed.[0m
    [37m+# On other kernels the period depends on the kernel configuration.[0m
    [37m+#[0m
    [37m+# A reasonable value for this option is 300 seconds, which is the new[0m
    [37m+# Redis default starting with Redis 3.2.1.[0m
    [37m+tcp-keepalive 300[0m
    [37m+[0m
    [37m+################################# GENERAL #####################################[0m
    [37m+[0m
    [37m+# By default Redis does not run as a daemon. Use 'yes' if you need it.[0m
    [37m+# Note that Redis will write a pid file in /var/run/redis.pid when daemonized.[0m
    [37m+daemonize no[0m
    [37m+[0m
    [37m+# If you run Redis from upstart or systemd, Redis can interact with your[0m
    [37m+# supervision tree. Options:[0m
    [37m+#   supervised no      - no supervision interaction[0m
    [37m+#   supervised upstart - signal upstart by putting Redis into SIGSTOP mode[0m
    [37m+#   supervised systemd - signal systemd by writing READY=1 to $NOTIFY_SOCKET[0m
    [37m+#   supervised auto    - detect upstart or systemd method based on[0m
    [37m+#                        UPSTART_JOB or NOTIFY_SOCKET environment variables[0m
    [37m+# Note: these supervision methods only signal "process is ready."[0m
    [37m+#       They do not enable continuous liveness pings back to your supervisor.[0m
    [37m+# supervised no[0m
    [37m+[0m
    [37m+# If a pid file is specified, Redis writes it where specified at startup[0m
    [37m+# and removes it at exit.[0m
    [37m+#[0m
    [37m+# When the server runs non daemonized, no pid file is created if none is[0m
    [37m+# specified in the configuration. When the server is daemonized, the pid file[0m
    [37m+# is used even if not specified, defaulting to "/var/run/redis.pid".[0m
    [37m+#[0m
    [37m+# Creating a pid file is best effort: if Redis is not able to create it[0m
    [37m+# nothing bad happens, the server will start and run normally.[0m
    [37m+pidfile "/var/run/redis_0.pid"[0m
    [37m+[0m
    [37m+# Specify the server verbosity level.[0m
    [37m+# This can be one of:[0m
    [37m+# debug (a lot of information, useful for development/testing)[0m
    [37m+# verbose (many rarely useful info, but not a mess like the debug level)[0m
    [37m+# notice (moderately verbose, what you want in production probably)[0m
    [37m+# warning (only very important / critical messages are logged)[0m
    [37m+loglevel notice[0m
    [37m+[0m
    [37m+# Specify the log file name. Also the empty string can be used to force[0m
    [37m+# Redis to log on the standard output. Note that if you use standard[0m
    [37m+# output for logging but daemonize, logs will be sent to /dev/null[0m
    [37m+logfile ""[0m
    [37m+[0m
    [37m+# To enable logging to the system logger, just set 'syslog-enabled' to yes,[0m
    [37m+# and optionally update the other syslog parameters to suit your needs.[0m
    [37m+# syslog-enabled no[0m
    [37m+[0m
    [37m+# Specify the syslog identity.[0m
    [37m+# syslog-ident redis[0m
    [37m+[0m
    [37m+# Specify the syslog facility. Must be USER or between LOCAL0-LOCAL7.[0m
    [37m+# syslog-facility local0[0m
    [37m+[0m
    [37m+# Set the number of databases. The default database is DB 0, you can select[0m
    [37m+# a different one on a per-connection basis using SELECT <dbid> where[0m
    [37m+# dbid is a number between 0 and 'databases'-1[0m
    [37m+databases 16[0m
    [37m+[0m
    [37m+################################ SNAPSHOTTING  ################################[0m
    [37m+#[0m
    [37m+# Save the DB on disk:[0m
    [37m+#[0m
    [37m+#   save <seconds> <changes>[0m
    [37m+#[0m
    [37m+#   Will save the DB if both the given number of seconds and the given[0m
    [37m+#   number of write operations against the DB occurred.[0m
    [37m+#[0m
    [37m+#   In the example below the behaviour will be to save:[0m
    [37m+#   after 900 sec (15 min) if at least 1 key changed[0m
    [37m+#   after 300 sec (5 min) if at least 10 keys changed[0m
    [37m+#   after 60 sec if at least 10000 keys changed[0m
    [37m+#[0m
    [37m+#   Note: you can disable saving completely by commenting out all "save" lines.[0m
    [37m+#[0m
    [37m+#   It is also possible to remove all the previously configured save[0m
    [37m+#   points by adding a save directive with a single empty string argument[0m
    [37m+#   like in the following example:[0m
    [37m+#[0m
    [37m+#   save ""[0m
    [37m+[0m
    [37m+save 900 1[0m
    [37m+save 300 10[0m
    [37m+save 60 10000[0m
    [37m+[0m
    [37m+# By default Redis will stop accepting writes if RDB snapshots are enabled[0m
    [37m+# (at least one save point) and the latest background save failed.[0m
    [37m+# This will make the user aware (in a hard way) that data is not persisting[0m
    [37m+# on disk properly, otherwise chances are that no one will notice and some[0m
    [37m+# disaster will happen.[0m
    [37m+#[0m
    [37m+# If the background saving process will start working again Redis will[0m
    [37m+# automatically allow writes again.[0m
    [37m+#[0m
    [37m+# However if you have setup your proper monitoring of the Redis server[0m
    [37m+# and persistence, you may want to disable this feature so that Redis will[0m
    [37m+# continue to work as usual even if there are problems with disk,[0m
    [37m+# permissions, and so forth.[0m
    [37m+stop-writes-on-bgsave-error yes[0m
    [37m+[0m
    [37m+# Compress string objects using LZF when dump .rdb databases?[0m
    [37m+# For default that's set to 'yes' as it's almost always a win.[0m
    [37m+# If you want to save some CPU in the saving child set it to 'no' but[0m
    [37m+# the dataset will likely be bigger if you have compressible values or keys.[0m
    [37m+rdbcompression yes[0m
    [37m+[0m
    [37m+# Since version 5 of RDB a CRC64 checksum is placed at the end of the file.[0m
    [37m+# This makes the format more resistant to corruption but there is a performance[0m
    [37m+# hit to pay (around 10%) when saving and loading RDB files, so you can disable it[0m
    [37m+# for maximum performances.[0m
    [37m+#[0m
    [37m+# RDB files created with checksum disabled have a checksum of zero that will[0m
    [37m+# tell the loading code to skip the check.[0m
    [37m+rdbchecksum yes[0m
    [37m+[0m
    [37m+# The filename where to dump the DB[0m
    [37m+dbfilename "dump.rdb"[0m
    [37m+[0m
    [37m+# The working directory.[0m
    [37m+#[0m
    [37m+# The DB will be written inside this directory, with the filename specified[0m
    [37m+# above using the 'dbfilename' configuration directive.[0m
    [37m+#[0m
    [37m+# The Append Only File will also be created inside this directory.[0m
    [37m+#[0m
    [37m+# Note that you must specify a directory here, not a file name.[0m
    [37m+dir "/var/opt/gitlab/redis"[0m
    [37m+[0m
    [37m+################################# REPLICATION #################################[0m
    [37m+[0m
    [37m+# Master-Slave replication. Use slaveof to make a Redis instance a copy of[0m
    [37m+# another Redis server. A few things to understand ASAP about Redis replication.[0m
    [37m+#[0m
    [37m+# 1) Redis replication is asynchronous, but you can configure a master to[0m
    [37m+#    stop accepting writes if it appears to be not connected with at least[0m
    [37m+#    a given number of slaves.[0m
    [37m+# 2) Redis slaves are able to perform a partial resynchronization with the[0m
    [37m+#    master if the replication link is lost for a relatively small amount of[0m
    [37m+#    time. You may want to configure the replication backlog size (see the next[0m
    [37m+#    sections of this file) with a sensible value depending on your needs.[0m
    [37m+# 3) Replication is automatic and does not need user intervention. After a[0m
    [37m+#    network partition slaves automatically try to reconnect to masters[0m
    [37m+#    and resynchronize with them.[0m
    [37m+#[0m
    [37m+# slaveof <masterip> <masterport>[0m
    [37m+[0m
    [37m+[0m
    [37m+# If the master is password protected (using the "requirepass" configuration[0m
    [37m+# directive below) it is possible to tell the slave to authenticate before[0m
    [37m+# starting the replication synchronization process, otherwise the master will[0m
    [37m+# refuse the slave request.[0m
    [37m+#[0m
    [37m+# masterauth <master-password>[0m
    [37m+[0m
    [37m+[0m
    [37m+# When a slave loses its connection with the master, or when the replication[0m
    [37m+# is still in progress, the slave can act in two different ways:[0m
    [37m+#[0m
    [37m+# 1) if slave-serve-stale-data is set to 'yes' (the default) the slave will[0m
    [37m+#    still reply to client requests, possibly with out of date data, or the[0m
    [37m+#    data set may just be empty if this is the first synchronization.[0m
    [37m+#[0m
    [37m+# 2) if slave-serve-stale-data is set to 'no' the slave will reply with[0m
    [37m+#    an error "SYNC with master in progress" to all the kind of commands[0m
    [37m+#    but to INFO and SLAVEOF.[0m
    [37m+#[0m
    [37m+slave-serve-stale-data yes[0m
    [37m+[0m
    [37m+# You can configure a slave instance to accept writes or not. Writing against[0m
    [37m+# a slave instance may be useful to store some ephemeral data (because data[0m
    [37m+# written on a slave will be easily deleted after resync with the master) but[0m
    [37m+# may also cause problems if clients are writing to it because of a[0m
    [37m+# misconfiguration.[0m
    [37m+#[0m
    [37m+# Since Redis 2.6 by default slaves are read-only.[0m
    [37m+#[0m
    [37m+# Note: read only slaves are not designed to be exposed to untrusted clients[0m
    [37m+# on the internet. It's just a protection layer against misuse of the instance.[0m
    [37m+# Still a read only slave exports by default all the administrative commands[0m
    [37m+# such as CONFIG, DEBUG, and so forth. To a limited extent you can improve[0m
    [37m+# security of read only slaves using 'rename-command' to shadow all the[0m
    [37m+# administrative / dangerous commands.[0m
    [37m+slave-read-only yes[0m
    [37m+[0m
    [37m+# Replication SYNC strategy: disk or socket.[0m
    [37m+#[0m
    [37m+# -------------------------------------------------------[0m
    [37m+# WARNING: DISKLESS REPLICATION IS EXPERIMENTAL CURRENTLY[0m
    [37m+# -------------------------------------------------------[0m
    [37m+#[0m
    [37m+# New slaves and reconnecting slaves that are not able to continue the replication[0m
    [37m+# process just receiving differences, need to do what is called a "full[0m
    [37m+# synchronization". An RDB file is transmitted from the master to the slaves.[0m
    [37m+# The transmission can happen in two different ways:[0m
    [37m+#[0m
    [37m+# 1) Disk-backed: The Redis master creates a new process that writes the RDB[0m
    [37m+#                 file on disk. Later the file is transferred by the parent[0m
    [37m+#                 process to the slaves incrementally.[0m
    [37m+# 2) Diskless: The Redis master creates a new process that directly writes the[0m
    [37m+#              RDB file to slave sockets, without touching the disk at all.[0m
    [37m+#[0m
    [37m+# With disk-backed replication, while the RDB file is generated, more slaves[0m
    [37m+# can be queued and served with the RDB file as soon as the current child producing[0m
    [37m+# the RDB file finishes its work. With diskless replication instead once[0m
    [37m+# the transfer starts, new slaves arriving will be queued and a new transfer[0m
    [37m+# will start when the current one terminates.[0m
    [37m+#[0m
    [37m+# When diskless replication is used, the master waits a configurable amount of[0m
    [37m+# time (in seconds) before starting the transfer in the hope that multiple slaves[0m
    [37m+# will arrive and the transfer can be parallelized.[0m
    [37m+#[0m
    [37m+# With slow disks and fast (large bandwidth) networks, diskless replication[0m
    [37m+# works better.[0m
    [37m+# repl-diskless-sync no[0m
    [37m+[0m
    [37m+# When diskless replication is enabled, it is possible to configure the delay[0m
    [37m+# the server waits in order to spawn the child that transfers the RDB via socket[0m
    [37m+# to the slaves.[0m
    [37m+#[0m
    [37m+# This is important since once the transfer starts, it is not possible to serve[0m
    [37m+# new slaves arriving, that will be queued for the next RDB transfer, so the server[0m
    [37m+# waits a delay in order to let more slaves arrive.[0m
    [37m+#[0m
    [37m+# The delay is specified in seconds, and by default is 5 seconds. To disable[0m
    [37m+# it entirely just set it to 0 seconds and the transfer will start ASAP.[0m
    [37m+# repl-diskless-sync-delay 5[0m
    [37m+[0m
    [37m+# Slaves send PINGs to server in a predefined interval. It's possible to change[0m
    [37m+# this interval with the repl_ping_slave_period option. The default value is 10[0m
    [37m+# seconds.[0m
    [37m+#[0m
    [37m+# repl-ping-slave-period 10[0m
    [37m+[0m
    [37m+# The following option sets the replication timeout for:[0m
    [37m+#[0m
    [37m+# 1) Bulk transfer I/O during SYNC, from the point of view of slave.[0m
    [37m+# 2) Master timeout from the point of view of slaves (data, pings).[0m
    [37m+# 3) Slave timeout from the point of view of masters (REPLCONF ACK pings).[0m
    [37m+#[0m
    [37m+# It is important to make sure that this value is greater than the value[0m
    [37m+# specified for repl-ping-slave-period otherwise a timeout will be detected[0m
    [37m+# every time there is low traffic between the master and the slave.[0m
    [37m+#[0m
    [37m+# repl-timeout 60[0m
    [37m+[0m
    [37m+# Disable TCP_NODELAY on the slave socket after SYNC?[0m
    [37m+#[0m
    [37m+# If you select "yes" Redis will use a smaller number of TCP packets and[0m
    [37m+# less bandwidth to send data to slaves. But this can add a delay for[0m
    [37m+# the data to appear on the slave side, up to 40 milliseconds with[0m
    [37m+# Linux kernels using a default configuration.[0m
    [37m+#[0m
    [37m+# If you select "no" the delay for data to appear on the slave side will[0m
    [37m+# be reduced but more bandwidth will be used for replication.[0m
    [37m+#[0m
    [37m+# By default we optimize for low latency, but in very high traffic conditions[0m
    [37m+# or when the master and slaves are many hops away, turning this to "yes" may[0m
    [37m+# be a good idea.[0m
    [37m+repl-disable-tcp-nodelay no[0m
    [37m+[0m
    [37m+# Set the replication backlog size. The backlog is a buffer that accumulates[0m
    [37m+# slave data when slaves are disconnected for some time, so that when a slave[0m
    [37m+# wants to reconnect again, often a full resync is not needed, but a partial[0m
    [37m+# resync is enough, just passing the portion of data the slave missed while[0m
    [37m+# disconnected.[0m
    [37m+#[0m
    [37m+# The bigger the replication backlog, the longer the time the slave can be[0m
    [37m+# disconnected and later be able to perform a partial resynchronization.[0m
    [37m+#[0m
    [37m+# The backlog is only allocated once there is at least a slave connected.[0m
    [37m+#[0m
    [37m+# repl-backlog-size 1mb[0m
    [37m+[0m
    [37m+# After a master has no longer connected slaves for some time, the backlog[0m
    [37m+# will be freed. The following option configures the amount of seconds that[0m
    [37m+# need to elapse, starting from the time the last slave disconnected, for[0m
    [37m+# the backlog buffer to be freed.[0m
    [37m+#[0m
    [37m+# A value of 0 means to never release the backlog.[0m
    [37m+#[0m
    [37m+# repl-backlog-ttl 3600[0m
    [37m+[0m
    [37m+# The slave priority is an integer number published by Redis in the INFO output.[0m
    [37m+# It is used by Redis Sentinel in order to select a slave to promote into a[0m
    [37m+# master if the master is no longer working correctly.[0m
    [37m+#[0m
    [37m+# A slave with a low priority number is considered better for promotion, so[0m
    [37m+# for instance if there are three slaves with priority 10, 100, 25 Sentinel will[0m
    [37m+# pick the one with priority 10, that is the lowest.[0m
    [37m+#[0m
    [37m+# However a special priority of 0 marks the slave as not able to perform the[0m
    [37m+# role of master, so a slave with priority of 0 will never be selected by[0m
    [37m+# Redis Sentinel for promotion.[0m
    [37m+#[0m
    [37m+# By default the priority is 100.[0m
    [37m+slave-priority 100[0m
    [37m+[0m
    [37m+# It is possible for a master to stop accepting writes if there are less than[0m
    [37m+# N slaves connected, having a lag less or equal than M seconds.[0m
    [37m+#[0m
    [37m+# The N slaves need to be in "online" state.[0m
    [37m+#[0m
    [37m+# The lag in seconds, that must be <= the specified value, is calculated from[0m
    [37m+# the last ping received from the slave, that is usually sent every second.[0m
    [37m+#[0m
    [37m+# This option does not GUARANTEE that N replicas will accept the write, but[0m
    [37m+# will limit the window of exposure for lost writes in case not enough slaves[0m
    [37m+# are available, to the specified number of seconds.[0m
    [37m+#[0m
    [37m+# For example to require at least 3 slaves with a lag <= 10 seconds use:[0m
    [37m+#[0m
    [37m+# min-slaves-to-write 3[0m
    [37m+# min-slaves-max-lag 10[0m
    [37m+#[0m
    [37m+# Setting one or the other to 0 disables the feature.[0m
    [37m+#[0m
    [37m+# By default min-slaves-to-write is set to 0 (feature disabled) and[0m
    [37m+# min-slaves-max-lag is set to 10.[0m
    [37m+[0m
    [37m+# A Redis master is able to list the address and port of the attached[0m
    [37m+# slaves in different ways. For example the "INFO replication" section[0m
    [37m+# offers this information, which is used, among other tools, by[0m
    [37m+# Redis Sentinel in order to discover slave instances.[0m
    [37m+# Another place where this info is available is in the output of the[0m
    [37m+# "ROLE" command of a masteer.[0m
    [37m+#[0m
    [37m+# The listed IP and address normally reported by a slave is obtained[0m
    [37m+# in the following way:[0m
    [37m+#[0m
    [37m+#   IP: The address is auto detected by checking the peer address[0m
    [37m+#   of the socket used by the slave to connect with the master.[0m
    [37m+#[0m
    [37m+#   Port: The port is communicated by the slave during the replication[0m
    [37m+#   handshake, and is normally the port that the slave is using to[0m
    [37m+#   list for connections.[0m
    [37m+#[0m
    [37m+# However when port forwarding or Network Address Translation (NAT) is[0m
    [37m+# used, the slave may be actually reachable via different IP and port[0m
    [37m+# pairs. The following two options can be used by a slave in order to[0m
    [37m+# report to its master a specific set of IP and port, so that both INFO[0m
    [37m+# and ROLE will report those values.[0m
    [37m+#[0m
    [37m+# There is no need to use both the options if you need to override just[0m
    [37m+# the port or the IP address.[0m
    [37m+#[0m
    [37m+[0m
    [37m+[0m
    [37m+[0m
    [37m+################################## SECURITY ###################################[0m
    [37m+[0m
    [37m+# Require clients to issue AUTH <PASSWORD> before processing any other[0m
    [37m+# commands.  This might be useful in environments in which you do not trust[0m
    [37m+# others with access to the host running redis-server.[0m
    [37m+#[0m
    [37m+# This should stay commented out for backward compatibility and because most[0m
    [37m+# people do not need auth (e.g. they run their own servers).[0m
    [37m+#[0m
    [37m+# Warning: since Redis is pretty fast an outside user can try up to[0m
    [37m+# 150k passwords per second against a good box. This means that you should[0m
    [37m+# use a very strong password otherwise it will be very easy to break.[0m
    [37m+#[0m
    [37m+[0m
    [37m+[0m
    [37m+# Command renaming.[0m
    [37m+#[0m
    [37m+# It is possible to change the name of dangerous commands in a shared[0m
    [37m+# environment. For instance the CONFIG command may be renamed into something[0m
    [37m+# hard to guess so that it will still be available for internal-use tools[0m
    [37m+# but not available for general clients.[0m
    [37m+#[0m
    [37m+# Example:[0m
    [37m+#[0m
    [37m+# rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52[0m
    [37m+#[0m
    [37m+# It is also possible to completely kill a command by renaming it into[0m
    [37m+# an empty string:[0m
    [37m+#[0m
    [37m+# rename-command CONFIG ""[0m
    [37m+#[0m
    [37m+# Please note that changing the name of commands that are logged into the[0m
    [37m+# AOF file or transmitted to slaves may cause problems.[0m
    [37m+[0m
    [37m+################################### LIMITS ####################################[0m
    [37m+[0m
    [37m+# Set the max number of connected clients at the same time. By default[0m
    [37m+# this limit is set to 10000 clients, however if the Redis server is not[0m
    [37m+# able to configure the process file limit to allow for the specified limit[0m
    [37m+# the max number of allowed clients is set to the current file limit[0m
    [37m+# minus 32 (as Redis reserves a few file descriptors for internal uses).[0m
    [37m+#[0m
    [37m+# Once the limit is reached Redis will close all the new connections sending[0m
    [37m+# an error 'max number of clients reached'.[0m
    [37m+#[0m
    [37m+maxclients 10000[0m
    [37m+[0m
    [37m+# Don't use more memory than the specified amount of bytes.[0m
    [37m+# When the memory limit is reached Redis will try to remove keys[0m
    [37m+# according to the eviction policy selected (see maxmemory-policy).[0m
    [37m+#[0m
    [37m+# If Redis can't remove keys according to the policy, or if the policy is[0m
    [37m+# set to 'noeviction', Redis will start to reply with errors to commands[0m
    [37m+# that would use more memory, like SET, LPUSH, and so on, and will continue[0m
    [37m+# to reply to read-only commands like GET.[0m
    [37m+#[0m
    [37m+# This option is usually useful when using Redis as an LRU cache, or to set[0m
    [37m+# a hard memory limit for an instance (using the 'noeviction' policy).[0m
    [37m+#[0m
    [37m+# WARNING: If you have slaves attached to an instance with maxmemory on,[0m
    [37m+# the size of the output buffers needed to feed the slaves are subtracted[0m
    [37m+# from the used memory count, so that network problems / resyncs will[0m
    [37m+# not trigger a loop where keys are evicted, and in turn the output[0m
    [37m+# buffer of slaves is full with DELs of keys evicted triggering the deletion[0m
    [37m+# of more keys, and so forth until the database is completely emptied.[0m
    [37m+#[0m
    [37m+# In short... if you have slaves attached it is suggested that you set a lower[0m
    [37m+# limit for maxmemory so that there is some free RAM on the system for slave[0m
    [37m+# output buffers (but this is not needed if the policy is 'noeviction').[0m
    [37m+#[0m
    [37m+# maxmemory <bytes>[0m
    [37m+maxmemory 0[0m
    [37m+[0m
    [37m+# MAXMEMORY POLICY: how Redis will select what to remove when maxmemory[0m
    [37m+# is reached. You can select among five behaviors:[0m
    [37m+#[0m
    [37m+# volatile-lru -> remove the key with an expire set using an LRU algorithm[0m
    [37m+# allkeys-lru -> remove any key according to the LRU algorithm[0m
    [37m+# volatile-random -> remove a random key with an expire set[0m
    [37m+# allkeys-random -> remove a random key, any key[0m
    [37m+# volatile-ttl -> remove the key with the nearest expire time (minor TTL)[0m
    [37m+# noeviction -> don't expire at all, just return an error on write operations[0m
    [37m+#[0m
    [37m+# Note: with any of the above policies, Redis will return an error on write[0m
    [37m+#       operations, when there are no suitable keys for eviction.[0m
    [37m+#[0m
    [37m+#       At the date of writing these commands are: set setnx setex append[0m
    [37m+#       incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd[0m
    [37m+#       sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby[0m
    [37m+#       zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby[0m
    [37m+#       getset mset msetnx exec sort[0m
    [37m+#[0m
    [37m+# The default is:[0m
    [37m+#[0m
    [37m+# maxmemory-policy noeviction[0m
    [37m+maxmemory-policy noeviction[0m
    [37m+[0m
    [37m+# LRU and minimal TTL algorithms are not precise algorithms but approximated[0m
    [37m+# algorithms (in order to save memory), so you can tune it for speed or[0m
    [37m+# accuracy. For default Redis will check five keys and pick the one that was[0m
    [37m+# used less recently, you can change the sample size using the following[0m
    [37m+# configuration directive.[0m
    [37m+#[0m
    [37m+# The default of 5 produces good enough results. 10 Approximates very closely[0m
    [37m+# true LRU but costs a bit more CPU. 3 is very fast but not very accurate.[0m
    [37m+#[0m
    [37m+# maxmemory-samples 5[0m
    [37m+maxmemory-samples 5[0m
    [37m+[0m
    [37m+############################## APPEND ONLY MODE ###############################[0m
    [37m+[0m
    [37m+# By default Redis asynchronously dumps the dataset on disk. This mode is[0m
    [37m+# good enough in many applications, but an issue with the Redis process or[0m
    [37m+# a power outage may result into a few minutes of writes lost (depending on[0m
    [37m+# the configured save points).[0m
    [37m+#[0m
    [37m+# The Append Only File is an alternative persistence mode that provides[0m
    [37m+# much better durability. For instance using the default data fsync policy[0m
    [37m+# (see later in the config file) Redis can lose just one second of writes in a[0m
    [37m+# dramatic event like a server power outage, or a single write if something[0m
    [37m+# wrong with the Redis process itself happens, but the operating system is[0m
    [37m+# still running correctly.[0m
    [37m+#[0m
    [37m+# AOF and RDB persistence can be enabled at the same time without problems.[0m
    [37m+# If the AOF is enabled on startup Redis will load the AOF, that is the file[0m
    [37m+# with the better durability guarantees.[0m
    [37m+#[0m
    [37m+# Please check http://redis.io/topics/persistence for more information.[0m
    [37m+[0m
    [37m+appendonly no[0m
    [37m+[0m
    [37m+# The name of the append only file (default: "appendonly.aof")[0m
    [37m+[0m
    [37m+# appendfilename "appendonly.aof"[0m
    [37m+[0m
    [37m+# The fsync() call tells the Operating System to actually write data on disk[0m
    [37m+# instead of waiting for more data in the output buffer. Some OS will really flush[0m
    [37m+# data on disk, some other OS will just try to do it ASAP.[0m
    [37m+#[0m
    [37m+# Redis supports three different modes:[0m
    [37m+#[0m
    [37m+# no: don't fsync, just let the OS flush the data when it wants. Faster.[0m
    [37m+# always: fsync after every write to the append only log. Slow, Safest.[0m
    [37m+# everysec: fsync only one time every second. Compromise.[0m
    [37m+#[0m
    [37m+# The default is "everysec", as that's usually the right compromise between[0m
    [37m+# speed and data safety. It's up to you to understand if you can relax this to[0m
    [37m+# "no" that will let the operating system flush the output buffer when[0m
    [37m+# it wants, for better performances (but if you can live with the idea of[0m
    [37m+# some data loss consider the default persistence mode that's snapshotting),[0m
    [37m+# or on the contrary, use "always" that's very slow but a bit safer than[0m
    [37m+# everysec.[0m
    [37m+#[0m
    [37m+# More details please check the following article:[0m
    [37m+# http://antirez.com/post/redis-persistence-demystified.html[0m
    [37m+#[0m
    [37m+# If unsure, use "everysec".[0m
    [37m+[0m
    [37m+# appendfsync always[0m
    [37m+appendfsync everysec[0m
    [37m+# appendfsync no[0m
    [37m+[0m
    [37m+# When the AOF fsync policy is set to always or everysec, and a background[0m
    [37m+# saving process (a background save or AOF log background rewriting) is[0m
    [37m+# performing a lot of I/O against the disk, in some Linux configurations[0m
    [37m+# Redis may block too long on the fsync() call. Note that there is no fix for[0m
    [37m+# this currently, as even performing fsync in a different thread will block[0m
    [37m+# our synchronous write(2) call.[0m
    [37m+#[0m
    [37m+# In order to mitigate this problem it's possible to use the following option[0m
    [37m+# that will prevent fsync() from being called in the main process while a[0m
    [37m+# BGSAVE or BGREWRITEAOF is in progress.[0m
    [37m+#[0m
    [37m+# This means that while another child is saving, the durability of Redis is[0m
    [37m+# the same as "appendfsync none". In practical terms, this means that it is[0m
    [37m+# possible to lose up to 30 seconds of log in the worst scenario (with the[0m
    [37m+# default Linux settings).[0m
    [37m+#[0m
    [37m+# If you have latency problems turn this to "yes". Otherwise leave it as[0m
    [37m+# "no" that is the safest pick from the point of view of durability.[0m
    [37m+[0m
    [37m+no-appendfsync-on-rewrite no[0m
    [37m+[0m
    [37m+# Automatic rewrite of the append only file.[0m
    [37m+# Redis is able to automatically rewrite the log file implicitly calling[0m
    [37m+# BGREWRITEAOF when the AOF log size grows by the specified percentage.[0m
    [37m+#[0m
    [37m+# This is how it works: Redis remembers the size of the AOF file after the[0m
    [37m+# latest rewrite (if no rewrite has happened since the restart, the size of[0m
    [37m+# the AOF at startup is used).[0m
    [37m+#[0m
    [37m+# This base size is compared to the current size. If the current size is[0m
    [37m+# bigger than the specified percentage, the rewrite is triggered. Also[0m
    [37m+# you need to specify a minimal size for the AOF file to be rewritten, this[0m
    [37m+# is useful to avoid rewriting the AOF file even if the percentage increase[0m
    [37m+# is reached but it is still pretty small.[0m
    [37m+#[0m
    [37m+# Specify a percentage of zero in order to disable the automatic AOF[0m
    [37m+# rewrite feature.[0m
    [37m+[0m
    [37m+auto-aof-rewrite-percentage 100[0m
    [37m+auto-aof-rewrite-min-size 64mb[0m
    [37m+[0m
    [37m+# An AOF file may be found to be truncated at the end during the Redis[0m
    [37m+# startup process, when the AOF data gets loaded back into memory.[0m
    [37m+# This may happen when the system where Redis is running[0m
    [37m+# crashes, especially when an ext4 filesystem is mounted without the[0m
    [37m+# data=ordered option (however this can't happen when Redis itself[0m
    [37m+# crashes or aborts but the operating system still works correctly).[0m
    [37m+#[0m
    [37m+# Redis can either exit with an error when this happens, or load as much[0m
    [37m+# data as possible (the default now) and start if the AOF file is found[0m
    [37m+# to be truncated at the end. The following option controls this behavior.[0m
    [37m+#[0m
    [37m+# If aof-load-truncated is set to yes, a truncated AOF file is loaded and[0m
    [37m+# the Redis server starts emitting a log to inform the user of the event.[0m
    [37m+# Otherwise if the option is set to no, the server aborts with an error[0m
    [37m+# and refuses to start. When the option is set to no, the user requires[0m
    [37m+# to fix the AOF file using the "redis-check-aof" utility before to restart[0m
    [37m+# the server.[0m
    [37m+#[0m
    [37m+# Note that if the AOF file will be found to be corrupted in the middle[0m
    [37m+# the server will still exit with an error. This option only applies when[0m
    [37m+# Redis will try to read more data from the AOF file but not enough bytes[0m
    [37m+# will be found.[0m
    [37m+# aof-load-truncated yes[0m
    [37m+[0m
    [37m+################################ LUA SCRIPTING  ###############################[0m
    [37m+[0m
    [37m+# Max execution time of a Lua script in milliseconds.[0m
    [37m+#[0m
    [37m+# If the maximum execution time is reached Redis will log that a script is[0m
    [37m+# still in execution after the maximum allowed time and will start to[0m
    [37m+# reply to queries with an error.[0m
    [37m+#[0m
    [37m+# When a long running script exceeds the maximum execution time only the[0m
    [37m+# SCRIPT KILL and SHUTDOWN NOSAVE commands are available. The first can be[0m
    [37m+# used to stop a script that did not yet called write commands. The second[0m
    [37m+# is the only way to shut down the server in the case a write command was[0m
    [37m+# already issued by the script but the user doesn't want to wait for the natural[0m
    [37m+# termination of the script.[0m
    [37m+#[0m
    [37m+# Set it to 0 or a negative value for unlimited execution without warnings.[0m
    [37m+lua-time-limit 5000[0m
    [37m+[0m
    [37m+################################ REDIS CLUSTER  ###############################[0m
    [37m+#[0m
    [37m+# ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[0m
    [37m+# WARNING EXPERIMENTAL: Redis Cluster is considered to be stable code, however[0m
    [37m+# in order to mark it as "mature" we need to wait for a non trivial percentage[0m
    [37m+# of users to deploy it in production.[0m
    [37m+# ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[0m
    [37m+#[0m
    [37m+# Normal Redis instances can't be part of a Redis Cluster; only nodes that are[0m
    [37m+# started as cluster nodes can. In order to start a Redis instance as a[0m
    [37m+# cluster node enable the cluster support uncommenting the following:[0m
    [37m+#[0m
    [37m+# cluster-enabled yes[0m
    [37m+[0m
    [37m+# Every cluster node has a cluster configuration file. This file is not[0m
    [37m+# intended to be edited by hand. It is created and updated by Redis nodes.[0m
    [37m+# Every Redis Cluster node requires a different cluster configuration file.[0m
    [37m+# Make sure that instances running in the same system do not have[0m
    [37m+# overlapping cluster configuration file names.[0m
    [37m+#[0m
    [37m+# cluster-config-file nodes-6379.conf[0m
    [37m+[0m
    [37m+# Cluster node timeout is the amount of milliseconds a node must be unreachable[0m
    [37m+# for it to be considered in failure state.[0m
    [37m+# Most other internal time limits are multiple of the node timeout.[0m
    [37m+#[0m
    [37m+# cluster-node-timeout 15000[0m
    [37m+[0m
    [37m+# A slave of a failing master will avoid to start a failover if its data[0m
    [37m+# looks too old.[0m
    [37m+#[0m
    [37m+# There is no simple way for a slave to actually have a exact measure of[0m
    [37m+# its "data age", so the following two checks are performed:[0m
    [37m+#[0m
    [37m+# 1) If there are multiple slaves able to failover, they exchange messages[0m
    [37m+#    in order to try to give an advantage to the slave with the best[0m
    [37m+#    replication offset (more data from the master processed).[0m
    [37m+#    Slaves will try to get their rank by offset, and apply to the start[0m
    [37m+#    of the failover a delay proportional to their rank.[0m
    [37m+#[0m
    [37m+# 2) Every single slave computes the time of the last interaction with[0m
    [37m+#    its master. This can be the last ping or command received (if the master[0m
    [37m+#    is still in the "connected" state), or the time that elapsed since the[0m
    [37m+#    disconnection with the master (if the replication link is currently down).[0m
    [37m+#    If the last interaction is too old, the slave will not try to failover[0m
    [37m+#    at all.[0m
    [37m+#[0m
    [37m+# The point "2" can be tuned by user. Specifically a slave will not perform[0m
    [37m+# the failover if, since the last interaction with the master, the time[0m
    [37m+# elapsed is greater than:[0m
    [37m+#[0m
    [37m+#   (node-timeout * slave-validity-factor) + repl-ping-slave-period[0m
    [37m+#[0m
    [37m+# So for example if node-timeout is 30 seconds, and the slave-validity-factor[0m
    [37m+# is 10, and assuming a default repl-ping-slave-period of 10 seconds, the[0m
    [37m+# slave will not try to failover if it was not able to talk with the master[0m
    [37m+# for longer than 310 seconds.[0m
    [37m+#[0m
    [37m+# A large slave-validity-factor may allow slaves with too old data to failover[0m
    [37m+# a master, while a too small value may prevent the cluster from being able to[0m
    [37m+# elect a slave at all.[0m
    [37m+#[0m
    [37m+# For maximum availability, it is possible to set the slave-validity-factor[0m
    [37m+# to a value of 0, which means, that slaves will always try to failover the[0m
    [37m+# master regardless of the last time they interacted with the master.[0m
    [37m+# (However they'll always try to apply a delay proportional to their[0m
    [37m+# offset rank).[0m
    [37m+#[0m
    [37m+# Zero is the only value able to guarantee that when all the partitions heal[0m
    [37m+# the cluster will always be able to continue.[0m
    [37m+#[0m
    [37m+# cluster-slave-validity-factor 10[0m
    [37m+[0m
    [37m+# Cluster slaves are able to migrate to orphaned masters, that are masters[0m
    [37m+# that are left without working slaves. This improves the cluster ability[0m
    [37m+# to resist to failures as otherwise an orphaned master can't be failed over[0m
    [37m+# in case of failure if it has no working slaves.[0m
    [37m+#[0m
    [37m+# Slaves migrate to orphaned masters only if there are still at least a[0m
    [37m+# given number of other working slaves for their old master. This number[0m
    [37m+# is the "migration barrier". A migration barrier of 1 means that a slave[0m
    [37m+# will migrate only if there is at least 1 other working slave for its master[0m
    [37m+# and so forth. It usually reflects the number of slaves you want for every[0m
    [37m+# master in your cluster.[0m
    [37m+#[0m
    [37m+# Default is 1 (slaves migrate only if their masters remain with at least[0m
    [37m+# one slave). To disable migration just set it to a very large value.[0m
    [37m+# A value of 0 can be set but is useful only for debugging and dangerous[0m
    [37m+# in production.[0m
    [37m+#[0m
    [37m+# cluster-migration-barrier 1[0m
    [37m+[0m
    [37m+# By default Redis Cluster nodes stop accepting queries if they detect there[0m
    [37m+# is at least an hash slot uncovered (no available node is serving it).[0m
    [37m+# This way if the cluster is partially down (for example a range of hash slots[0m
    [37m+# are no longer covered) all the cluster becomes, eventually, unavailable.[0m
    [37m+# It automatically returns available as soon as all the slots are covered again.[0m
    [37m+#[0m
    [37m+# However sometimes you want the subset of the cluster which is working,[0m
    [37m+# to continue to accept queries for the part of the key space that is still[0m
    [37m+# covered. In order to do so, just set the cluster-require-full-coverage[0m
    [37m+# option to no.[0m
    [37m+#[0m
    [37m+# cluster-require-full-coverage yes[0m
    [37m+[0m
    [37m+# In order to setup your cluster make sure to read the documentation[0m
    [37m+# available at http://redis.io web site.[0m
    [37m+[0m
    [37m+################################## SLOW LOG ###################################[0m
    [37m+[0m
    [37m+# The Redis Slow Log is a system to log queries that exceeded a specified[0m
    [37m+# execution time. The execution time does not include the I/O operations[0m
    [37m+# like talking with the client, sending the reply and so forth,[0m
    [37m+# but just the time needed to actually execute the command (this is the only[0m
    [37m+# stage of command execution where the thread is blocked and can not serve[0m
    [37m+# other requests in the meantime).[0m
    [37m+#[0m
    [37m+# You can configure the slow log with two parameters: one tells Redis[0m
    [37m+# what is the execution time, in microseconds, to exceed in order for the[0m
    [37m+# command to get logged, and the other parameter is the length of the[0m
    [37m+# slow log. When a new command is logged the oldest one is removed from the[0m
    [37m+# queue of logged commands.[0m
    [37m+[0m
    [37m+# The following time is expressed in microseconds, so 1000000 is equivalent[0m
    [37m+# to one second. Note that a negative number disables the slow log, while[0m
    [37m+# a value of zero forces the logging of every command.[0m
    [37m+slowlog-log-slower-than 10000[0m
    [37m+[0m
    [37m+# There is no limit to this length. Just be aware that it will consume memory.[0m
    [37m+# You can reclaim memory used by the slow log with SLOWLOG RESET.[0m
    [37m+slowlog-max-len 128[0m
    [37m+[0m
    [37m+################################ LATENCY MONITOR ##############################[0m
    [37m+[0m
    [37m+# The Redis latency monitoring subsystem samples different operations[0m
    [37m+# at runtime in order to collect data related to possible sources of[0m
    [37m+# latency of a Redis instance.[0m
    [37m+#[0m
    [37m+# Via the LATENCY command this information is available to the user that can[0m
    [37m+# print graphs and obtain reports.[0m
    [37m+#[0m
    [37m+# The system only logs operations that were performed in a time equal or[0m
    [37m+# greater than the amount of milliseconds specified via the[0m
    [37m+# latency-monitor-threshold configuration directive. When its value is set[0m
    [37m+# to zero, the latency monitor is turned off.[0m
    [37m+#[0m
    [37m+# By default latency monitoring is disabled since it is mostly not needed[0m
    [37m+# if you don't have latency issues, and collecting data has a performance[0m
    [37m+# impact, that while very small, can be measured under big load. Latency[0m
    [37m+# monitoring can easily be enabled at runtime using the command[0m
    [37m+# "CONFIG SET latency-monitor-threshold <milliseconds>" if needed.[0m
    [37m+# latency-monitor-threshold 0[0m
    [37m+[0m
    [37m+############################# EVENT NOTIFICATION ##############################[0m
    [37m+[0m
    [37m+# Redis can notify Pub/Sub clients about events happening in the key space.[0m
    [37m+# This feature is documented at http://redis.io/topics/notifications[0m
    [37m+#[0m
    [37m+# For instance if keyspace events notification is enabled, and a client[0m
    [37m+# performs a DEL operation on key "foo" stored in the Database 0, two[0m
    [37m+# messages will be published via Pub/Sub:[0m
    [37m+#[0m
    [37m+# PUBLISH __keyspace@0__:foo del[0m
    [37m+# PUBLISH __keyevent@0__:del foo[0m
    [37m+#[0m
    [37m+# It is possible to select the events that Redis will notify among a set[0m
    [37m+# of classes. Every class is identified by a single character:[0m
    [37m+#[0m
    [37m+#  K     Keyspace events, published with __keyspace@<db>__ prefix.[0m
    [37m+#  E     Keyevent events, published with __keyevent@<db>__ prefix.[0m
    [37m+#  g     Generic commands (non-type specific) like DEL, EXPIRE, RENAME, ...[0m
    [37m+#  $     String commands[0m
    [37m+#  l     List commands[0m
    [37m+#  s     Set commands[0m
    [37m+#  h     Hash commands[0m
    [37m+#  z     Sorted set commands[0m
    [37m+#  x     Expired events (events generated every time a key expires)[0m
    [37m+#  e     Evicted events (events generated when a key is evicted for maxmemory)[0m
    [37m+#  A     Alias for g$lshzxe, so that the "AKE" string means all the events.[0m
    [37m+#[0m
    [37m+#  The "notify-keyspace-events" takes as argument a string that is composed[0m
    [37m+#  of zero or multiple characters. The empty string means that notifications[0m
    [37m+#  are disabled.[0m
    [37m+#[0m
    [37m+#  Example: to enable list and generic events, from the point of view of the[0m
    [37m+#           event name, use:[0m
    [37m+#[0m
    [37m+#  notify-keyspace-events Elg[0m
    [37m+#[0m
    [37m+#  Example 2: to get the stream of the expired keys subscribing to channel[0m
    [37m+#             name __keyevent@0__:expired use:[0m
    [37m+#[0m
    [37m+#  notify-keyspace-events Ex[0m
    [37m+#[0m
    [37m+#  By default all notifications are disabled because most users don't need[0m
    [37m+#  this feature and the feature has some overhead. Note that if you don't[0m
    [37m+#  specify at least one of K or E, no events will be delivered.[0m
    [37m+notify-keyspace-events ""[0m
    [37m+[0m
    [37m+############################### ADVANCED CONFIG ###############################[0m
    [37m+[0m
    [37m+# Hashes are encoded using a memory efficient data structure when they have a[0m
    [37m+# small number of entries, and the biggest entry does not exceed a given[0m
    [37m+# threshold. These thresholds can be configured using the following directives.[0m
    [37m+hash-max-ziplist-entries 512[0m
    [37m+hash-max-ziplist-value 64[0m
    [37m+[0m
    [37m+# Lists are also encoded in a special way to save a lot of space.[0m
    [37m+# The number of entries allowed per internal list node can be specified[0m
    [37m+# as a fixed maximum size or a maximum number of elements.[0m
    [37m+# For a fixed maximum size, use -5 through -1, meaning:[0m
    [37m+# -5: max size: 64 Kb  <-- not recommended for normal workloads[0m
    [37m+# -4: max size: 32 Kb  <-- not recommended[0m
    [37m+# -3: max size: 16 Kb  <-- probably not recommended[0m
    [37m+# -2: max size: 8 Kb   <-- good[0m
    [37m+# -1: max size: 4 Kb   <-- good[0m
    [37m+# Positive numbers mean store up to _exactly_ that number of elements[0m
    [37m+# per list node.[0m
    [37m+# The highest performing option is usually -2 (8 Kb size) or -1 (4 Kb size),[0m
    [37m+# but if your use case is unique, adjust the settings as necessary.[0m
    [37m+# list-max-ziplist-size -2[0m
    [37m+[0m
    [37m+# Lists may also be compressed.[0m
    [37m+# Compress depth is the number of quicklist ziplist nodes from *each* side of[0m
    [37m+# the list to *exclude* from compression.  The head and tail of the list[0m
    [37m+# are always uncompressed for fast push/pop operations.  Settings are:[0m
    [37m+# 0: disable all list compression[0m
    [37m+# 1: depth 1 means "don't start compressing until after 1 node into the list,[0m
    [37m+#    going from either the head or tail"[0m
    [37m+#    So: [head]->node->node->...->node->[tail][0m
    [37m+#    [head], [tail] will always be uncompressed; inner nodes will compress.[0m
    [37m+# 2: [head]->[next]->node->node->...->node->[prev]->[tail][0m
    [37m+#    2 here means: don't compress head or head->next or tail->prev or tail,[0m
    [37m+#    but compress all nodes between them.[0m
    [37m+# 3: [head]->[next]->[next]->node->node->...->node->[prev]->[prev]->[tail][0m
    [37m+# etc.[0m
    [37m+# list-compress-depth 0[0m
    [37m+[0m
    [37m+# Sets have a special encoding in just one case: when a set is composed[0m
    [37m+# of just strings that happen to be integers in radix 10 in the range[0m
    [37m+# of 64 bit signed integers.[0m
    [37m+# The following configuration setting sets the limit in the size of the[0m
    [37m+# set in order to use this special memory saving encoding.[0m
    [37m+set-max-intset-entries 512[0m
    [37m+[0m
    [37m+# Similarly to hashes and lists, sorted sets are also specially encoded in[0m
    [37m+# order to save a lot of space. This encoding is only used when the length and[0m
    [37m+# elements of a sorted set are below the following limits:[0m
    [37m+zset-max-ziplist-entries 128[0m
    [37m+zset-max-ziplist-value 64[0m
    [37m+[0m
    [37m+# HyperLogLog sparse representation bytes limit. The limit includes the[0m
    [37m+# 16 bytes header. When an HyperLogLog using the sparse representation crosses[0m
    [37m+# this limit, it is converted into the dense representation.[0m
    [37m+#[0m
    [37m+# A value greater than 16000 is totally useless, since at that point the[0m
    [37m+# dense representation is more memory efficient.[0m
    [37m+#[0m
    [37m+# The suggested value is ~ 3000 in order to have the benefits of[0m
    [37m+# the space efficient encoding without slowing down too much PFADD,[0m
    [37m+# which is O(N) with the sparse encoding. The value can be raised to[0m
    [37m+# ~ 10000 when CPU is not a concern, but space is, and the data set is[0m
    [37m+# composed of many HyperLogLogs with cardinality in the 0 - 15000 range.[0m
    [37m+# hll-sparse-max-bytes 3000[0m
    [37m+[0m
    [37m+# Active rehashing uses 1 millisecond every 100 milliseconds of CPU time in[0m
    [37m+# order to help rehashing the main Redis hash table (the one mapping top-level[0m
    [37m+# keys to values). The hash table implementation Redis uses (see dict.c)[0m
    [37m+# performs a lazy rehashing: the more operation you run into a hash table[0m
    [37m+# that is rehashing, the more rehashing "steps" are performed, so if the[0m
    [37m+# server is idle the rehashing is never complete and some more memory is used[0m
    [37m+# by the hash table.[0m
    [37m+#[0m
    [37m+# The default is to use this millisecond 10 times every second in order to[0m
    [37m+# actively rehash the main dictionaries, freeing memory when possible.[0m
    [37m+#[0m
    [37m+# If unsure:[0m
    [37m+# use "activerehashing no" if you have hard latency requirements and it is[0m
    [37m+# not a good thing in your environment that Redis can reply from time to time[0m
    [37m+# to queries with 2 milliseconds delay.[0m
    [37m+#[0m
    [37m+# use "activerehashing yes" if you don't have such hard requirements but[0m
    [37m+# want to free memory asap when possible.[0m
    [37m+activerehashing yes[0m
    [37m+[0m
    [37m+# The client output buffer limits can be used to force disconnection of clients[0m
    [37m+# that are not reading data from the server fast enough for some reason (a[0m
    [37m+# common reason is that a Pub/Sub client can't consume messages as fast as the[0m
    [37m+# publisher can produce them).[0m
    [37m+#[0m
    [37m+# The limit can be set differently for the three different classes of clients:[0m
    [37m+#[0m
    [37m+# normal -> normal clients including MONITOR clients[0m
    [37m+# slave  -> slave clients[0m
    [37m+# pubsub -> clients subscribed to at least one pubsub channel or pattern[0m
    [37m+#[0m
    [37m+# The syntax of every client-output-buffer-limit directive is the following:[0m
    [37m+#[0m
    [37m+# client-output-buffer-limit <class> <hard limit> <soft limit> <soft seconds>[0m
    [37m+#[0m
    [37m+# A client is immediately disconnected once the hard limit is reached, or if[0m
    [37m+# the soft limit is reached and remains reached for the specified number of[0m
    [37m+# seconds (continuously).[0m
    [37m+# So for instance if the hard limit is 32 megabytes and the soft limit is[0m
    [37m+# 16 megabytes / 10 seconds, the client will get disconnected immediately[0m
    [37m+# if the size of the output buffers reach 32 megabytes, but will also get[0m
    [37m+# disconnected if the client reaches 16 megabytes and continuously overcomes[0m
    [37m+# the limit for 10 seconds.[0m
    [37m+#[0m
    [37m+# By default normal clients are not limited because they don't receive data[0m
    [37m+# without asking (in a push way), but just after a request, so only[0m
    [37m+# asynchronous clients may create a scenario where data is requested faster[0m
    [37m+# than it can read.[0m
    [37m+#[0m
    [37m+# Instead there is a default limit for pubsub and slave clients, since[0m
    [37m+# subscribers and slaves receive data in a push fashion.[0m
    [37m+#[0m
    [37m+# Both the hard or the soft limit can be disabled by setting them to zero.[0m
    [37m+client-output-buffer-limit normal 0 0 0[0m
    [37m+client-output-buffer-limit slave 256mb 64mb 60[0m
    [37m+client-output-buffer-limit pubsub 32mb 8mb 60[0m
    [37m+[0m
    [37m+# Redis calls an internal function to perform many background tasks, like[0m
    [37m+# closing connections of clients in timeout, purging expired keys that are[0m
    [37m+# never requested, and so forth.[0m
    [37m+#[0m
    [37m+# Not all tasks are performed with the same frequency, but Redis checks for[0m
    [37m+# tasks to perform according to the specified "hz" value.[0m
    [37m+#[0m
    [37m+# By default "hz" is set to 10. Raising the value will use more CPU when[0m
    [37m+# Redis is idle, but at the same time will make Redis more responsive when[0m
    [37m+# there are many keys expiring at the same time, and timeouts may be[0m
    [37m+# handled with more precision.[0m
    [37m+#[0m
    [37m+# The range is between 1 and 500, however a value over 100 is usually not[0m
    [37m+# a good idea. Most users should use the default of 10 and raise this up to[0m
    [37m+# 100 only in environments where very low latency is required.[0m
    [37m+hz 10[0m
    [37m+[0m
    [37m+# When a child rewrites the AOF file, if the following option is enabled[0m
    [37m+# the file will be fsync-ed every 32 MB of data generated. This is useful[0m
    [37m+# in order to commit the file to the disk more incrementally and avoid[0m
    [37m+# big latency spikes.[0m
    [37m+aof-rewrite-incremental-fsync yes[0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'gitlab-redis'[0m
[0m  * directory[/opt/gitlab/sv/redis] action create
    [32m- create new directory /opt/gitlab/sv/redis[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/redis/log] action create
    [32m- create new directory /opt/gitlab/sv/redis/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/redis/log/main] action create
    [32m- create new directory /opt/gitlab/sv/redis/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/redis/run] action create
    [32m- create new file /opt/gitlab/sv/redis/run[0m
    [32m- update content in file /opt/gitlab/sv/redis/run from none to 535f80[0m
    [37m--- /opt/gitlab/sv/redis/run	2018-05-30 10:03:41.523708669 +0000[0m
    [37m+++ /opt/gitlab/sv/redis/.chef-run20180530-48-1aq5bv7	2018-05-30 10:03:41.523708669 +0000[0m
    [37m@@ -1 +1,6 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+umask 077[0m
    [37m+exec chpst -P -U gitlab-redis -u gitlab-redis /opt/gitlab/embedded/bin/redis-server /var/opt/gitlab/redis/redis.conf[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/redis/log/run] action create
    [32m- create new file /opt/gitlab/sv/redis/log/run[0m
    [32m- update content in file /opt/gitlab/sv/redis/log/run from none to af1017[0m
    [37m--- /opt/gitlab/sv/redis/log/run	2018-05-30 10:03:41.533708669 +0000[0m
    [37m+++ /opt/gitlab/sv/redis/log/.chef-run20180530-48-122lvp	2018-05-30 10:03:41.533708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/redis[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/redis/config] action create
    [32m- create new file /var/log/gitlab/redis/config[0m
    [32m- update content in file /var/log/gitlab/redis/config from none to 623c00[0m
    [37m--- /var/log/gitlab/redis/config	2018-05-30 10:03:41.533708669 +0000[0m
    [37m+++ /var/log/gitlab/redis/.chef-config20180530-48-1pe58pq	2018-05-30 10:03:41.533708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload redis svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart redis svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/redis/down] action delete (up to date)
  * link[/opt/gitlab/init/redis] action create
    [32m- create symlink at /opt/gitlab/init/redis to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/redis] action create
    [32m- create symlink at /opt/gitlab/service/redis to /opt/gitlab/sv/redis[0m
[0m  * ruby_block[supervise_redis_sleep] action run
    [32m- execute the ruby block supervise_redis_sleep[0m
[0m  * directory[/opt/gitlab/sv/redis/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/redis/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/redis/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/redis/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/redis/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/redis/log/supervise/control] action touch (skipped due to only_if)
  * service[redis] action nothing (skipped due to action :nothing)
  * execute[/opt/gitlab/bin/gitlab-ctl start redis] action run
    [execute] ok: run: redis: (pid 702) 2s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start redis[0m
[0mRecipe: postgresql::user[0m
  * account[Postgresql user and group] action create (up to date)
Recipe: postgresql::enable[0m
  * directory[/var/opt/gitlab/postgresql] action create (up to date)
  * directory[/var/opt/gitlab/postgresql/data] action create
    [32m- create new directory /var/opt/gitlab/postgresql/data[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
[0m  * directory[/var/log/gitlab/postgresql] action create
    [32m- create new directory /var/log/gitlab/postgresql[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
[0m  * link[/var/opt/gitlab/postgresql/data] action create (skipped due to not_if)
  * file[/var/opt/gitlab/postgresql/.profile] action create
    [32m- update content in file /var/opt/gitlab/postgresql/.profile from d8c4ba to 3b0387[0m
    [37m--- /var/opt/gitlab/postgresql/.profile	2017-05-16 12:49:38.000000000 +0000[0m
    [37m+++ /var/opt/gitlab/postgresql/.chef-.profile20180530-48-hnt7zv.profile	2018-05-30 10:03:44.273708669 +0000[0m
    [37m@@ -1,21 +1,2 @@[0m
    [37m-# ~/.profile: executed by the command interpreter for login shells.[0m
    [37m-# This file is not read by bash(1), if ~/.bash_profile or ~/.bash_login[0m
    [37m-# exists.[0m
    [37m-# see /usr/share/doc/bash/examples/startup-files for examples.[0m
    [37m-# the files are located in the bash-doc package.[0m
    [37m-[0m
    [37m-# the default umask is set in /etc/profile; for setting the umask[0m
    [37m-# for ssh logins, install and configure the libpam-umask package.[0m
    [37m-#umask 022[0m
    [37m-[0m
    [37m-# if running bash[0m
    [37m-if [ -n "$BASH_VERSION" ]; then[0m
    [37m-    # include .bashrc if it exists[0m
    [37m-    if [ -f "$HOME/.bashrc" ]; then[0m
    [37m-	. "$HOME/.bashrc"[0m
    [37m-    fi[0m
    [37m-fi[0m
    [37m-[0m
    [37m-# set PATH so it includes user's private bin directories[0m
    [37m-PATH="$HOME/bin:$HOME/.local/bin:$PATH"[0m
    [37m+PATH=/opt/gitlab/embedded/bin:/opt/gitlab/bin:$PATH[0m
    [32m- change mode from '0644' to '0600'[0m
[0m  * sysctl[kernel.shmmax] action create
    * directory[create /etc/sysctl.d for kernel.shmmax] action create (up to date)
    * file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf kernel.shmmax] action create
      [32m- create new file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf[0m
      [32m- update content in file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf from none to 75a195[0m
      [37m--- /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf	2018-05-30 10:03:44.283708669 +0000[0m
      [37m+++ /opt/gitlab/embedded/etc/.chef-90-omnibus-gitlab-kernel20180530-48-1ybhlbs.shmmax.conf	2018-05-30 10:03:44.283708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+kernel.shmmax = 17179869184[0m
[0m    * execute[load sysctl conf kernel.shmmax] action run
      [execute] sysctl: setting key "kernel.printk": Read-only file system
                sysctl: setting key "net.ipv6.conf.all.use_tempaddr": Read-only file system
                sysctl: setting key "net.ipv6.conf.default.use_tempaddr": Read-only file system
                sysctl: setting key "kernel.kptr_restrict": Read-only file system
                sysctl: setting key "fs.protected_hardlinks": Read-only file system
                sysctl: setting key "fs.protected_symlinks": Read-only file system
                sysctl: setting key "kernel.sysrq": Read-only file system
                sysctl: setting key "net.ipv4.conf.default.rp_filter": Read-only file system
                sysctl: setting key "net.ipv4.conf.all.rp_filter": Read-only file system
                sysctl: setting key "vm.mmap_min_addr": Read-only file system
      [32m- execute cat /etc/sysctl.conf /etc/sysctl.d/*.conf  | sysctl -e -p -[0m
[0m    * link[/etc/sysctl.d/90-omnibus-gitlab-kernel.shmmax.conf] action create
      [32m- create symlink at /etc/sysctl.d/90-omnibus-gitlab-kernel.shmmax.conf to /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmmax.conf[0m
[0m    * file[delete /etc/sysctl.d/90-postgresql.conf kernel.shmmax] action delete (skipped due to only_if)
    * file[delete /etc/sysctl.d/90-unicorn.conf kernel.shmmax] action delete (skipped due to only_if)
    * file[delete /opt/gitlab/embedded/etc/90-omnibus-gitlab.conf kernel.shmmax] action delete (skipped due to only_if)
    * file[delete /etc/sysctl.d/90-omnibus-gitlab.conf kernel.shmmax] action delete (skipped due to only_if)
    * execute[load sysctl conf kernel.shmmax] action nothing (skipped due to action :nothing)
  
[0m  * sysctl[kernel.shmall] action create
    * directory[create /etc/sysctl.d for kernel.shmall] action create (up to date)
    * file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf kernel.shmall] action create
      [32m- create new file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf[0m
      [32m- update content in file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf from none to 6d765d[0m
      [37m--- /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf	2018-05-30 10:03:44.323708669 +0000[0m
      [37m+++ /opt/gitlab/embedded/etc/.chef-90-omnibus-gitlab-kernel20180530-48-2hv7jo.shmall.conf	2018-05-30 10:03:44.323708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+kernel.shmall = 4194304[0m
[0m    * execute[load sysctl conf kernel.shmall] action run
      [execute] sysctl: setting key "kernel.printk": Read-only file system
                sysctl: setting key "net.ipv6.conf.all.use_tempaddr": Read-only file system
                sysctl: setting key "net.ipv6.conf.default.use_tempaddr": Read-only file system
                sysctl: setting key "kernel.kptr_restrict": Read-only file system
                sysctl: setting key "fs.protected_hardlinks": Read-only file system
                sysctl: setting key "fs.protected_symlinks": Read-only file system
                sysctl: setting key "kernel.sysrq": Read-only file system
                sysctl: setting key "net.ipv4.conf.default.rp_filter": Read-only file system
                sysctl: setting key "net.ipv4.conf.all.rp_filter": Read-only file system
                sysctl: setting key "vm.mmap_min_addr": Read-only file system
                sysctl: setting key "kernel.shmmax": Read-only file system
      [32m- execute cat /etc/sysctl.conf /etc/sysctl.d/*.conf  | sysctl -e -p -[0m
[0m    * link[/etc/sysctl.d/90-omnibus-gitlab-kernel.shmall.conf] action create
      [32m- create symlink at /etc/sysctl.d/90-omnibus-gitlab-kernel.shmall.conf to /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.shmall.conf[0m
[0m    * file[delete /etc/sysctl.d/90-postgresql.conf kernel.shmall] action delete (skipped due to only_if)
    * file[delete /etc/sysctl.d/90-unicorn.conf kernel.shmall] action delete (skipped due to only_if)
    * file[delete /opt/gitlab/embedded/etc/90-omnibus-gitlab.conf kernel.shmall] action delete (skipped due to only_if)
    * file[delete /etc/sysctl.d/90-omnibus-gitlab.conf kernel.shmall] action delete (skipped due to only_if)
    * execute[load sysctl conf kernel.shmall] action nothing (skipped due to action :nothing)
  
[0m  * sysctl[kernel.sem] action create
    * directory[create /etc/sysctl.d for kernel.sem] action create (up to date)
    * file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf kernel.sem] action create
      [32m- create new file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf[0m
      [32m- update content in file /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf from none to 09a346[0m
      [37m--- /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf	2018-05-30 10:03:44.353708669 +0000[0m
      [37m+++ /opt/gitlab/embedded/etc/.chef-90-omnibus-gitlab-kernel20180530-48-1rzxpx9.sem.conf	2018-05-30 10:03:44.343708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+kernel.sem = 250 32000 32 262[0m
[0m    * execute[load sysctl conf kernel.sem] action run
      [execute] sysctl: setting key "kernel.printk": Read-only file system
                sysctl: setting key "net.ipv6.conf.all.use_tempaddr": Read-only file system
                sysctl: setting key "net.ipv6.conf.default.use_tempaddr": Read-only file system
                sysctl: setting key "kernel.kptr_restrict": Read-only file system
                sysctl: setting key "fs.protected_hardlinks": Read-only file system
                sysctl: setting key "fs.protected_symlinks": Read-only file system
                sysctl: setting key "kernel.sysrq": Read-only file system
                sysctl: setting key "net.ipv4.conf.default.rp_filter": Read-only file system
                sysctl: setting key "net.ipv4.conf.all.rp_filter": Read-only file system
                sysctl: setting key "vm.mmap_min_addr": Read-only file system
                sysctl: setting key "kernel.shmall": Read-only file system
                sysctl: setting key "kernel.shmmax": Read-only file system
      [32m- execute cat /etc/sysctl.conf /etc/sysctl.d/*.conf  | sysctl -e -p -[0m
[0m    * link[/etc/sysctl.d/90-omnibus-gitlab-kernel.sem.conf] action create
      [32m- create symlink at /etc/sysctl.d/90-omnibus-gitlab-kernel.sem.conf to /opt/gitlab/embedded/etc/90-omnibus-gitlab-kernel.sem.conf[0m
[0m    * file[delete /etc/sysctl.d/90-postgresql.conf kernel.sem] action delete (skipped due to only_if)
    * file[delete /etc/sysctl.d/90-unicorn.conf kernel.sem] action delete (skipped due to only_if)
    * file[delete /opt/gitlab/embedded/etc/90-omnibus-gitlab.conf kernel.sem] action delete (skipped due to only_if)
    * file[delete /etc/sysctl.d/90-omnibus-gitlab.conf kernel.sem] action delete (skipped due to only_if)
    * execute[load sysctl conf kernel.sem] action nothing (skipped due to action :nothing)
  
[0m  * execute[/opt/gitlab/embedded/bin/initdb -D /var/opt/gitlab/postgresql/data -E UTF8] action run
    [execute] The files belonging to this database system will be owned by user "gitlab-psql".
              This user must also own the server process.
              
              The database cluster will be initialized with locale "C".
              The default text search configuration will be set to "english".
              
              Data page checksums are disabled.
              
              fixing permissions on existing directory /var/opt/gitlab/postgresql/data ... ok
              creating subdirectories ... ok
              selecting default max_connections ... 100
              selecting default shared_buffers ... 128MB
              selecting dynamic shared memory implementation ... posix
              creating configuration files ... ok
              running bootstrap script ... ok
              performing post-bootstrap initialization ... ok
              syncing data to disk ... ok
              
              WARNING: enabling "trust" authentication for local connections
              You can change this by editing pg_hba.conf or using the option -A, or
              --auth-local and --auth-host, the next time you run initdb.
              
              Success. You can now start the database server using:
              
                  /opt/gitlab/embedded/bin/pg_ctl -D /var/opt/gitlab/postgresql/data -l logfile start
              
    [32m- execute /opt/gitlab/embedded/bin/initdb -D /var/opt/gitlab/postgresql/data -E UTF8[0m
[0m  * file[/var/opt/gitlab/postgresql/data/server.crt] action create
    [32m- create new file /var/opt/gitlab/postgresql/data/server.crt[0m
    [32m- update content in file /var/opt/gitlab/postgresql/data/server.crt from none to 3616a3[0m
    [32m- suppressed sensitive resource[0m
    [32m- change mode from '' to '0400'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
    [32m- change group from '' to 'gitlab-psql'[0m
[0m  * file[/var/opt/gitlab/postgresql/data/server.key] action create
    [32m- create new file /var/opt/gitlab/postgresql/data/server.key[0m
    [32m- update content in file /var/opt/gitlab/postgresql/data/server.key from none to 68778f[0m
    [32m- suppressed sensitive resource[0m
    [32m- change mode from '' to '0400'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
    [32m- change group from '' to 'gitlab-psql'[0m
[0m  * template[/var/opt/gitlab/postgresql/data/postgresql.conf] action create
    [32m- update content in file /var/opt/gitlab/postgresql/data/postgresql.conf from 864e65 to 5d7043[0m
    [37m--- /var/opt/gitlab/postgresql/data/postgresql.conf	2018-05-30 10:03:44.773708669 +0000[0m
    [37m+++ /var/opt/gitlab/postgresql/data/.chef-postgresql20180530-48-uebcro.conf	2018-05-30 10:03:45.713708669 +0000[0m
    [37m@@ -1,3 +1,7 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m # -----------------------------[0m
    [37m # PostgreSQL configuration file[0m
    [37m # -----------------------------[0m
    [37m@@ -27,7 +31,7 @@[0m
    [37m # Memory units:  kB = kilobytes        Time units:  ms  = milliseconds[0m
    [37m #                MB = megabytes                     s   = seconds[0m
    [37m #                GB = gigabytes                     min = minutes[0m
    [37m-#                TB = terabytes                     h   = hours[0m
    [37m+#                                                   h   = hours[0m
    [37m #                                                   d   = days[0m
    [37m [0m
    [37m [0m
    [37m@@ -38,16 +42,16 @@[0m
    [37m # The default values of these variables are driven from the -D command-line[0m
    [37m # option or PGDATA environment variable, represented here as ConfigDir.[0m
    [37m [0m
    [37m-#data_directory = 'ConfigDir'		# use data in another directory[0m
    [37m-					# (change requires restart)[0m
    [37m-#hba_file = 'ConfigDir/pg_hba.conf'	# host-based authentication file[0m
    [37m-					# (change requires restart)[0m
    [37m-#ident_file = 'ConfigDir/pg_ident.conf'	# ident configuration file[0m
    [37m-					# (change requires restart)[0m
    [37m+#data_directory = 'ConfigDir'   # use data in another directory[0m
    [37m+          # (change requires restart)[0m
    [37m+#hba_file = 'ConfigDir/pg_hba.conf' # host-based authentication file[0m
    [37m+          # (change requires restart)[0m
    [37m+#ident_file = 'ConfigDir/pg_ident.conf' # ident configuration file[0m
    [37m+          # (change requires restart)[0m
    [37m [0m
    [37m # If external_pid_file is not explicitly set, no extra PID file is written.[0m
    [37m-#external_pid_file = ''			# write an extra PID file[0m
    [37m-					# (change requires restart)[0m
    [37m+#external_pid_file = '(none)'   # write an extra PID file[0m
    [37m+          # (change requires restart)[0m
    [37m [0m
    [37m [0m
    [37m #------------------------------------------------------------------------------[0m
    [37m@@ -56,52 +60,57 @@[0m
    [37m [0m
    [37m # - Connection Settings -[0m
    [37m [0m
    [37m-#listen_addresses = 'localhost'		# what IP address(es) to listen on;[0m
    [37m-					# comma-separated list of addresses;[0m
    [37m-					# defaults to 'localhost'; use '*' for all[0m
    [37m-					# (change requires restart)[0m
    [37m-#port = 5432				# (change requires restart)[0m
    [37m-max_connections = 100			# (change requires restart)[0m
    [37m-#superuser_reserved_connections = 3	# (change requires restart)[0m
    [37m-#unix_socket_directories = '/tmp'	# comma-separated list of directories[0m
    [37m-					# (change requires restart)[0m
    [37m-#unix_socket_group = ''			# (change requires restart)[0m
    [37m-#unix_socket_permissions = 0777		# begin with 0 to use octal notation[0m
    [37m-					# (change requires restart)[0m
    [37m-#bonjour = off				# advertise server via Bonjour[0m
    [37m-					# (change requires restart)[0m
    [37m-#bonjour_name = ''			# defaults to the computer name[0m
    [37m-					# (change requires restart)[0m
    [37m+listen_addresses = ''    # what IP address(es) to listen on;[0m
    [37m+          # comma-separated list of addresses;[0m
    [37m+          # defaults to 'localhost', '*' = all[0m
    [37m+          # (change requires restart)[0m
    [37m+port = 5432        # (change requires restart)[0m
    [37m+max_connections = 200      # (change requires restart)[0m
    [37m+# Note:  Increasing max_connections costs ~400 bytes of shared memory per[0m
    [37m+# connection slot, plus lock space (see max_locks_per_transaction).[0m
    [37m+#superuser_reserved_connections = 3 # (change requires restart)[0m
    [37m+unix_socket_directories = '/var/opt/gitlab/postgresql'   # (change requires restart)[0m
    [37m+#unix_socket_group = ''     # (change requires restart)[0m
    [37m+#unix_socket_permissions = 0777   # begin with 0 to use octal notation[0m
    [37m+          # (change requires restart)[0m
    [37m+#bonjour = off        # advertise server via Bonjour[0m
    [37m+          # (change requires restart)[0m
    [37m+#bonjour_name = ''      # defaults to the computer name[0m
    [37m+          # (change requires restart)[0m
    [37m [0m
    [37m # - Security and Authentication -[0m
    [37m [0m
    [37m-#authentication_timeout = 1min		# 1s-600s[0m
    [37m-#ssl = off				# (change requires restart)[0m
    [37m-#ssl_ciphers = 'HIGH:MEDIUM:+3DES:!aNULL' # allowed SSL ciphers[0m
    [37m-					# (change requires restart)[0m
    [37m-#ssl_prefer_server_ciphers = on		# (change requires restart)[0m
    [37m-#ssl_ecdh_curve = 'prime256v1'		# (change requires restart)[0m
    [37m-#ssl_cert_file = 'server.crt'		# (change requires restart)[0m
    [37m-#ssl_key_file = 'server.key'		# (change requires restart)[0m
    [37m-#ssl_ca_file = ''			# (change requires restart)[0m
    [37m-#ssl_crl_file = ''			# (change requires restart)[0m
    [37m+#authentication_timeout = 1min    # 1s-600s[0m
    [37m+[0m
    [37m+# change requires restart[0m
    [37m+ssl = on[0m
    [37m+[0m
    [37m+# allowed SSL ciphers[0m
    [37m+ssl_ciphers = 'HIGH:MEDIUM:+3DES:!aNULL:!SSLv3:!TLSv1'[0m
    [37m+[0m
    [37m+ssl_cert_file = 'server.crt'[0m
    [37m+ssl_key_file = 'server.key'[0m
    [37m+ssl_ca_file = '/opt/gitlab/embedded/ssl/certs/cacert.pem'[0m
    [37m+[0m
    [37m+[0m
    [37m+#ssl_renegotiation_limit = 512MB  # amount of data between renegotiations[0m
    [37m #password_encryption = on[0m
    [37m #db_user_namespace = off[0m
    [37m-#row_security = on[0m
    [37m [0m
    [37m-# GSSAPI using Kerberos[0m
    [37m+# Kerberos and GSSAPI[0m
    [37m #krb_server_keyfile = ''[0m
    [37m+#krb_srvname = 'postgres'   # (Kerberos only)[0m
    [37m #krb_caseins_users = off[0m
    [37m [0m
    [37m # - TCP Keepalives -[0m
    [37m # see "man 7 tcp" for details[0m
    [37m [0m
    [37m-#tcp_keepalives_idle = 0		# TCP_KEEPIDLE, in seconds;[0m
    [37m-					# 0 selects the system default[0m
    [37m-#tcp_keepalives_interval = 0		# TCP_KEEPINTVL, in seconds;[0m
    [37m-					# 0 selects the system default[0m
    [37m-#tcp_keepalives_count = 0		# TCP_KEEPCNT;[0m
    [37m-					# 0 selects the system default[0m
    [37m+#tcp_keepalives_idle = 0    # TCP_KEEPIDLE, in seconds;[0m
    [37m+          # 0 selects the system default[0m
    [37m+#tcp_keepalives_interval = 0    # TCP_KEEPINTVL, in seconds;[0m
    [37m+          # 0 selects the system default[0m
    [37m+#tcp_keepalives_count = 0   # TCP_KEEPCNT;[0m
    [37m+          # 0 selects the system default[0m
    [37m [0m
    [37m [0m
    [37m #------------------------------------------------------------------------------[0m
    [37m@@ -110,63 +119,40 @@[0m
    [37m [0m
    [37m # - Memory -[0m
    [37m [0m
    [37m-shared_buffers = 128MB			# min 128kB[0m
    [37m-					# (change requires restart)[0m
    [37m-#huge_pages = try			# on, off, or try[0m
    [37m-					# (change requires restart)[0m
    [37m-#temp_buffers = 8MB			# min 800kB[0m
    [37m-#max_prepared_transactions = 0		# zero disables the feature[0m
    [37m-					# (change requires restart)[0m
    [37m-# Caution: it is not advisable to set max_prepared_transactions nonzero unless[0m
    [37m-# you actively intend to use prepared transactions.[0m
    [37m-#work_mem = 4MB				# min 64kB[0m
    [37m-#maintenance_work_mem = 64MB		# min 1MB[0m
    [37m-#replacement_sort_tuples = 150000	# limits use of replacement selection sort[0m
    [37m-#autovacuum_work_mem = -1		# min 1MB, or -1 to use maintenance_work_mem[0m
    [37m-#max_stack_depth = 2MB			# min 100kB[0m
    [37m-dynamic_shared_memory_type = posix	# the default is the first option[0m
    [37m-					# supported by the operating system:[0m
    [37m-					#   posix[0m
    [37m-					#   sysv[0m
    [37m-					#   windows[0m
    [37m-					#   mmap[0m
    [37m-					# use none to disable dynamic shared memory[0m
    [37m-					# (change requires restart)[0m
    [37m+shared_buffers = 1MB # min 128kB[0m
    [37m+          # (change requires restart)[0m
    [37m+#temp_buffers = 8MB     # min 800kB[0m
    [37m+#max_prepared_transactions = 0    # zero disables the feature[0m
    [37m+          # (change requires restart)[0m
    [37m+# Note:  Increasing max_prepared_transactions costs ~600 bytes of shared memory[0m
    [37m+# per transaction slot, plus lock space (see max_locks_per_transaction).[0m
    [37m+# It is not advisable to set max_prepared_transactions nonzero unless you[0m
    [37m+# actively intend to use prepared transactions.[0m
    [37m+#max_stack_depth = 2MB      # min 100kB[0m
    [37m [0m
    [37m-# - Disk -[0m
    [37m-[0m
    [37m-#temp_file_limit = -1			# limits per-process temp file space[0m
    [37m-					# in kB, or -1 for no limit[0m
    [37m-[0m
    [37m # - Kernel Resource Usage -[0m
    [37m [0m
    [37m-#max_files_per_process = 1000		# min 25[0m
    [37m-					# (change requires restart)[0m
    [37m-#shared_preload_libraries = ''		# (change requires restart)[0m
    [37m+#max_files_per_process = 1000   # min 25[0m
    [37m+          # (change requires restart)[0m
    [37m+shared_preload_libraries = ''    # (change requires restart)[0m
    [37m [0m
    [37m # - Cost-Based Vacuum Delay -[0m
    [37m [0m
    [37m-#vacuum_cost_delay = 0			# 0-100 milliseconds[0m
    [37m-#vacuum_cost_page_hit = 1		# 0-10000 credits[0m
    [37m-#vacuum_cost_page_miss = 10		# 0-10000 credits[0m
    [37m-#vacuum_cost_page_dirty = 20		# 0-10000 credits[0m
    [37m-#vacuum_cost_limit = 200		# 1-10000 credits[0m
    [37m+#vacuum_cost_delay = 0ms    # 0-100 milliseconds[0m
    [37m+#vacuum_cost_page_hit = 1   # 0-10000 credits[0m
    [37m+#vacuum_cost_page_miss = 10   # 0-10000 credits[0m
    [37m+#vacuum_cost_page_dirty = 20    # 0-10000 credits[0m
    [37m+#vacuum_cost_limit = 200    # 1-10000 credits[0m
    [37m [0m
    [37m # - Background Writer -[0m
    [37m [0m
    [37m-#bgwriter_delay = 200ms			# 10-10000ms between rounds[0m
    [37m-#bgwriter_lru_maxpages = 100		# 0-1000 max buffers written/round[0m
    [37m-#bgwriter_lru_multiplier = 2.0		# 0-10.0 multiplier on buffers scanned/round[0m
    [37m-#bgwriter_flush_after = 512kB		# measured in pages, 0 disables[0m
    [37m+#bgwriter_delay = 200ms     # 10-10000ms between rounds[0m
    [37m+#bgwriter_lru_maxpages = 100    # 0-1000 max buffers written/round[0m
    [37m+#bgwriter_lru_multiplier = 2.0    # 0-10.0 multipler on buffers scanned/round[0m
    [37m [0m
    [37m # - Asynchronous Behavior -[0m
    [37m [0m
    [37m-#effective_io_concurrency = 1		# 1-1000; 0 disables prefetching[0m
    [37m-#max_worker_processes = 8		# (change requires restart)[0m
    [37m-#max_parallel_workers_per_gather = 0	# taken from max_worker_processes[0m
    [37m-#old_snapshot_threshold = -1		# 1min-60d; -1 disables; 0 is immediate[0m
    [37m-					# (change requires restart)[0m
    [37m-#backend_flush_after = 0		# measured in pages, 0 disables[0m
    [37m+#effective_io_concurrency = 1   # 1-1000. 0 disables prefetching[0m
    [37m [0m
    [37m [0m
    [37m #------------------------------------------------------------------------------[0m
    [37m@@ -175,103 +161,62 @@[0m
    [37m [0m
    [37m # - Settings -[0m
    [37m [0m
    [37m-#wal_level = minimal			# minimal, replica, or logical[0m
    [37m-					# (change requires restart)[0m
    [37m-#fsync = on				# flush data to disk for crash safety[0m
    [37m-						# (turning this off can cause[0m
    [37m-						# unrecoverable data corruption)[0m
    [37m-#synchronous_commit = on		# synchronization level;[0m
    [37m-					# off, local, remote_write, remote_apply, or on[0m
    [37m-#wal_sync_method = fsync		# the default is the first option[0m
    [37m-					# supported by the operating system:[0m
    [37m-					#   open_datasync[0m
    [37m-					#   fdatasync (default on Linux)[0m
    [37m-					#   fsync[0m
    [37m-					#   fsync_writethrough[0m
    [37m-					#   open_sync[0m
    [37m-#full_page_writes = on			# recover from partial page writes[0m
    [37m-#wal_compression = off			# enable compression of full-page writes[0m
    [37m-#wal_log_hints = off			# also do full page writes of non-critical updates[0m
    [37m-					# (change requires restart)[0m
    [37m-#wal_buffers = -1			# min 32kB, -1 sets based on shared_buffers[0m
    [37m-					# (change requires restart)[0m
    [37m-#wal_writer_delay = 200ms		# 1-10000 milliseconds[0m
    [37m-#wal_writer_flush_after = 1MB		# measured in pages, 0 disables[0m
    [37m+wal_level = minimal[0m
    [37m+          # (change requires restart)[0m
    [37m+#fsync = on       # turns forced synchronization on or off[0m
    [37m+#wal_sync_method = fsync    # the default is the first option[0m
    [37m+          # supported by the operating system:[0m
    [37m+          #   open_datasync[0m
    [37m+          #   fdatasync (default on Linux)[0m
    [37m+          #   fsync[0m
    [37m+          #   fsync_writethrough[0m
    [37m+          #   open_sync[0m
    [37m+#full_page_writes = on      # recover from partial page writes[0m
    [37m+wal_buffers = -1 # -1     # min 32kB, -1 sets based on shared_buffers[0m
    [37m+          # (change requires restart)[0m
    [37m+#wal_writer_delay = 200ms   # 1-10000 milliseconds[0m
    [37m [0m
    [37m-#commit_delay = 0			# range 0-100000, in microseconds[0m
    [37m-#commit_siblings = 5			# range 1-1000[0m
    [37m+#commit_delay = 0     # range 0-100000, in microseconds[0m
    [37m+#commit_siblings = 5      # range 1-1000[0m
    [37m [0m
    [37m-# - Checkpoints -[0m
    [37m+min_wal_size = 80MB[0m
    [37m+max_wal_size = 1GB[0m
    [37m [0m
    [37m-#checkpoint_timeout = 5min		# range 30s-1d[0m
    [37m-#max_wal_size = 1GB[0m
    [37m-#min_wal_size = 80MB[0m
    [37m-#checkpoint_completion_target = 0.5	# checkpoint target duration, 0.0 - 1.0[0m
    [37m-#checkpoint_flush_after = 256kB		# measured in pages, 0 disables[0m
    [37m-#checkpoint_warning = 30s		# 0 disables[0m
    [37m+# The number of replication slots to reserve.[0m
    [37m+max_replication_slots = 0[0m
    [37m [0m
    [37m+[0m
    [37m # - Archiving -[0m
    [37m [0m
    [37m-#archive_mode = off		# enables archiving; off, on, or always[0m
    [37m-				# (change requires restart)[0m
    [37m-#archive_command = ''		# command to use to archive a logfile segment[0m
    [37m-				# placeholders: %p = path of file to archive[0m
    [37m-				#               %f = file name only[0m
    [37m-				# e.g. 'test ! -f /mnt/server/archivedir/%f && cp %p /mnt/server/archivedir/%f'[0m
    [37m-#archive_timeout = 0		# force a logfile segment switch after this[0m
    [37m-				# number of seconds; 0 disables[0m
    [37m+archive_mode = off   # allows archiving to be done[0m
    [37m+        # (change requires restart, also requires 'wal_level' of 'hot_standby' OR 'replica')[0m
    [37m [0m
    [37m-[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m # REPLICATION[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m [0m
    [37m-# - Sending Server(s) -[0m
    [37m-[0m
    [37m-# Set these on the master and on any standby that will send replication data.[0m
    [37m-[0m
    [37m-#max_wal_senders = 0		# max number of walsender processes[0m
    [37m-				# (change requires restart)[0m
    [37m-#wal_keep_segments = 0		# in logfile segments, 16MB each; 0 disables[0m
    [37m-#wal_sender_timeout = 60s	# in milliseconds; 0 disables[0m
    [37m-[0m
    [37m-#max_replication_slots = 0	# max number of replication slots[0m
    [37m-				# (change requires restart)[0m
    [37m-#track_commit_timestamp = off	# collect timestamp of transaction commit[0m
    [37m-				# (change requires restart)[0m
    [37m-[0m
    [37m # - Master Server -[0m
    [37m [0m
    [37m-# These settings are ignored on a standby server.[0m
    [37m+# These settings are ignored on a standby server[0m
    [37m [0m
    [37m-#synchronous_standby_names = ''	# standby servers that provide sync rep[0m
    [37m-				# number of sync standbys and comma-separated list of application_name[0m
    [37m-				# from standby(s); '*' = all[0m
    [37m-#vacuum_defer_cleanup_age = 0	# number of xacts by which cleanup is delayed[0m
    [37m+max_wal_senders = 0[0m
    [37m+        # (change requires restart)[0m
    [37m+#wal_sender_delay = 1s    # walsender cycle time, 1-10000 milliseconds[0m
    [37m+#vacuum_defer_cleanup_age = 0 # number of xacts by which cleanup is delayed[0m
    [37m+#replication_timeout = 60s  # in milliseconds; 0 disables[0m
    [37m+#synchronous_standby_names = '' # standby servers that provide sync rep[0m
    [37m+        # comma-separated list of application_name[0m
    [37m+        # from standby(s); '*' = all[0m
    [37m [0m
    [37m # - Standby Servers -[0m
    [37m [0m
    [37m-# These settings are ignored on a master server.[0m
    [37m+# These settings are ignored on a master server[0m
    [37m [0m
    [37m-#hot_standby = off			# "on" allows queries during recovery[0m
    [37m-					# (change requires restart)[0m
    [37m-#max_standby_archive_delay = 30s	# max delay before canceling queries[0m
    [37m-					# when reading WAL from archive;[0m
    [37m-					# -1 allows indefinite delay[0m
    [37m-#max_standby_streaming_delay = 30s	# max delay before canceling queries[0m
    [37m-					# when reading streaming WAL;[0m
    [37m-					# -1 allows indefinite delay[0m
    [37m-#wal_receiver_status_interval = 10s	# send replies at least this often[0m
    [37m-					# 0 disables[0m
    [37m-#hot_standby_feedback = off		# send info from standby to prevent[0m
    [37m-					# query conflicts[0m
    [37m-#wal_receiver_timeout = 60s		# time that receiver waits for[0m
    [37m-					# communication from master[0m
    [37m-					# in milliseconds; 0 disables[0m
    [37m-#wal_retrieve_retry_interval = 5s	# time to wait before retrying to[0m
    [37m-					# retrieve WAL after a failed attempt[0m
    [37m+hot_standby = off[0m
    [37m+          # (change requires restart)[0m
    [37m+#wal_receiver_status_interval = 10s # send replies at least this often[0m
    [37m+          # 0 disables[0m
    [37m [0m
    [37m-[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m # QUERY TUNING[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m@@ -282,7 +227,6 @@[0m
    [37m #enable_hashagg = on[0m
    [37m #enable_hashjoin = on[0m
    [37m #enable_indexscan = on[0m
    [37m-#enable_indexonlyscan = on[0m
    [37m #enable_material = on[0m
    [37m #enable_mergejoin = on[0m
    [37m #enable_nestloop = on[0m
    [37m@@ -292,35 +236,28 @@[0m
    [37m [0m
    [37m # - Planner Cost Constants -[0m
    [37m [0m
    [37m-#seq_page_cost = 1.0			# measured on an arbitrary scale[0m
    [37m-#random_page_cost = 4.0			# same scale as above[0m
    [37m-#cpu_tuple_cost = 0.01			# same scale as above[0m
    [37m-#cpu_index_tuple_cost = 0.005		# same scale as above[0m
    [37m-#cpu_operator_cost = 0.0025		# same scale as above[0m
    [37m-#parallel_tuple_cost = 0.1		# same scale as above[0m
    [37m-#parallel_setup_cost = 1000.0	# same scale as above[0m
    [37m-#min_parallel_relation_size = 8MB[0m
    [37m-#effective_cache_size = 4GB[0m
    [37m+#cpu_tuple_cost = 0.01      # same scale as above[0m
    [37m+#cpu_index_tuple_cost = 0.005   # same scale as above[0m
    [37m+#cpu_operator_cost = 0.0025   # same scale as above[0m
    [37m [0m
    [37m # - Genetic Query Optimizer -[0m
    [37m [0m
    [37m #geqo = on[0m
    [37m #geqo_threshold = 12[0m
    [37m-#geqo_effort = 5			# range 1-10[0m
    [37m-#geqo_pool_size = 0			# selects default based on effort[0m
    [37m-#geqo_generations = 0			# selects default based on effort[0m
    [37m-#geqo_selection_bias = 2.0		# range 1.5-2.0[0m
    [37m-#geqo_seed = 0.0			# range 0.0-1.0[0m
    [37m+#geqo_effort = 5      # range 1-10[0m
    [37m+#geqo_pool_size = 0     # selects default based on effort[0m
    [37m+#geqo_generations = 0     # selects default based on effort[0m
    [37m+#geqo_selection_bias = 2.0    # range 1.5-2.0[0m
    [37m+#geqo_seed = 0.0      # range 0.0-1.0[0m
    [37m [0m
    [37m # - Other Planner Options -[0m
    [37m [0m
    [37m-#default_statistics_target = 100	# range 1-10000[0m
    [37m-#constraint_exclusion = partition	# on, off, or partition[0m
    [37m-#cursor_tuple_fraction = 0.1		# range 0.0-1.0[0m
    [37m+#default_statistics_target = 100  # range 1-10000[0m
    [37m+#constraint_exclusion = partition # on, off, or partition[0m
    [37m+#cursor_tuple_fraction = 0.1    # range 0.0-1.0[0m
    [37m #from_collapse_limit = 8[0m
    [37m-#join_collapse_limit = 8		# 1 disables collapsing of explicit[0m
    [37m-					# JOIN clauses[0m
    [37m-#force_parallel_mode = off[0m
    [37m+#join_collapse_limit = 8    # 1 disables collapsing of explicit[0m
    [37m+          # JOIN clauses[0m
    [37m [0m
    [37m [0m
    [37m #------------------------------------------------------------------------------[0m
    [37m@@ -329,144 +266,105 @@[0m
    [37m [0m
    [37m # - Where to Log -[0m
    [37m [0m
    [37m-#log_destination = 'stderr'		# Valid values are combinations of[0m
    [37m-					# stderr, csvlog, syslog, and eventlog,[0m
    [37m-					# depending on platform.  csvlog[0m
    [37m-					# requires logging_collector to be on.[0m
    [37m+#log_destination = 'stderr'   # Valid values are combinations of[0m
    [37m+          # stderr, csvlog, syslog, and eventlog,[0m
    [37m+          # depending on platform.  csvlog[0m
    [37m+          # requires logging_collector to be on.[0m
    [37m [0m
    [37m # This is used when logging to stderr:[0m
    [37m-#logging_collector = off		# Enable capturing of stderr and csvlog[0m
    [37m-					# into log files. Required to be on for[0m
    [37m-					# csvlogs.[0m
    [37m-					# (change requires restart)[0m
    [37m+#logging_collector = off    # Enable capturing of stderr and csvlog[0m
    [37m+          # into log files. Required to be on for[0m
    [37m+          # csvlogs.[0m
    [37m+          # (change requires restart)[0m
    [37m [0m
    [37m # These are only used if logging_collector is on:[0m
    [37m-#log_directory = 'pg_log'		# directory where log files are written,[0m
    [37m-					# can be absolute or relative to PGDATA[0m
    [37m-#log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'	# log file name pattern,[0m
    [37m-					# can include strftime() escapes[0m
    [37m-#log_file_mode = 0600			# creation mode for log files,[0m
    [37m-					# begin with 0 to use octal notation[0m
    [37m-#log_truncate_on_rotation = off		# If on, an existing log file with the[0m
    [37m-					# same name as the new log file will be[0m
    [37m-					# truncated rather than appended to.[0m
    [37m-					# But such truncation only occurs on[0m
    [37m-					# time-driven rotation, not on restarts[0m
    [37m-					# or size-driven rotation.  Default is[0m
    [37m-					# off, meaning append to existing files[0m
    [37m-					# in all cases.[0m
    [37m-#log_rotation_age = 1d			# Automatic rotation of logfiles will[0m
    [37m-					# happen after that time.  0 disables.[0m
    [37m-#log_rotation_size = 10MB		# Automatic rotation of logfiles will[0m
    [37m-					# happen after that much log output.[0m
    [37m-					# 0 disables.[0m
    [37m+#log_directory = 'pg_log'   # directory where log files are written,[0m
    [37m+          # can be absolute or relative to PGDATA[0m
    [37m+#log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'  # log file name pattern,[0m
    [37m+          # can include strftime() escapes[0m
    [37m+#log_file_mode = 0600     # creation mode for log files,[0m
    [37m+          # begin with 0 to use octal notation[0m
    [37m+#log_truncate_on_rotation = off   # If on, an existing log file with the[0m
    [37m+          # same name as the new log file will be[0m
    [37m+          # truncated rather than appended to.[0m
    [37m+          # But such truncation only occurs on[0m
    [37m+          # time-driven rotation, not on restarts[0m
    [37m+          # or size-driven rotation.  Default is[0m
    [37m+          # off, meaning append to existing files[0m
    [37m+          # in all cases.[0m
    [37m+#log_rotation_age = 1d      # Automatic rotation of logfiles will[0m
    [37m+          # happen after that time.  0 disables.[0m
    [37m+#log_rotation_size = 10MB   # Automatic rotation of logfiles will[0m
    [37m+          # happen after that much log output.[0m
    [37m+          # 0 disables.[0m
    [37m [0m
    [37m # These are relevant when logging to syslog:[0m
    [37m #syslog_facility = 'LOCAL0'[0m
    [37m #syslog_ident = 'postgres'[0m
    [37m-#syslog_sequence_numbers = on[0m
    [37m-#syslog_split_messages = on[0m
    [37m [0m
    [37m-# This is only relevant when logging to eventlog (win32):[0m
    [37m-# (change requires restart)[0m
    [37m-#event_source = 'PostgreSQL'[0m
    [37m+#silent_mode = off      # Run server silently.[0m
    [37m+          # DO NOT USE without syslog or[0m
    [37m+          # logging_collector[0m
    [37m+          # (change requires restart)[0m
    [37m [0m
    [37m+[0m
    [37m # - When to Log -[0m
    [37m [0m
    [37m-#client_min_messages = notice		# values in order of decreasing detail:[0m
    [37m-					#   debug5[0m
    [37m-					#   debug4[0m
    [37m-					#   debug3[0m
    [37m-					#   debug2[0m
    [37m-					#   debug1[0m
    [37m-					#   log[0m
    [37m-					#   notice[0m
    [37m-					#   warning[0m
    [37m-					#   error[0m
    [37m+#client_min_messages = notice   # values in order of decreasing detail:[0m
    [37m+          #   debug5[0m
    [37m+          #   debug4[0m
    [37m+          #   debug3[0m
    [37m+          #   debug2[0m
    [37m+          #   debug1[0m
    [37m+          #   log[0m
    [37m+          #   notice[0m
    [37m+          #   warning[0m
    [37m+          #   error[0m
    [37m [0m
    [37m-#log_min_messages = warning		# values in order of decreasing detail:[0m
    [37m-					#   debug5[0m
    [37m-					#   debug4[0m
    [37m-					#   debug3[0m
    [37m-					#   debug2[0m
    [37m-					#   debug1[0m
    [37m-					#   info[0m
    [37m-					#   notice[0m
    [37m-					#   warning[0m
    [37m-					#   error[0m
    [37m-					#   log[0m
    [37m-					#   fatal[0m
    [37m-					#   panic[0m
    [37m+#log_min_messages = warning   # values in order of decreasing detail:[0m
    [37m+          #   debug5[0m
    [37m+          #   debug4[0m
    [37m+          #   debug3[0m
    [37m+          #   debug2[0m
    [37m+          #   debug1[0m
    [37m+          #   info[0m
    [37m+          #   notice[0m
    [37m+          #   warning[0m
    [37m+          #   error[0m
    [37m+          #   log[0m
    [37m+          #   fatal[0m
    [37m+          #   panic[0m
    [37m [0m
    [37m-#log_min_error_statement = error	# values in order of decreasing detail:[0m
    [37m-					#   debug5[0m
    [37m-					#   debug4[0m
    [37m-					#   debug3[0m
    [37m-					#   debug2[0m
    [37m-					#   debug1[0m
    [37m-					#   info[0m
    [37m-					#   notice[0m
    [37m-					#   warning[0m
    [37m-					#   error[0m
    [37m-					#   log[0m
    [37m-					#   fatal[0m
    [37m-					#   panic (effectively off)[0m
    [37m+#log_min_error_statement = error  # values in order of decreasing detail:[0m
    [37m+          #   debug5[0m
    [37m+          #   debug4[0m
    [37m+          #   debug3[0m
    [37m+          #   debug2[0m
    [37m+          #   debug1[0m
    [37m+          #   info[0m
    [37m+          #   notice[0m
    [37m+          #   warning[0m
    [37m+          #   error[0m
    [37m+          #   log[0m
    [37m+          #   fatal[0m
    [37m+          #   panic (effectively off)[0m
    [37m [0m
    [37m-#log_min_duration_statement = -1	# -1 is disabled, 0 logs all statements[0m
    [37m-					# and their durations, > 0 logs only[0m
    [37m-					# statements running at least this number[0m
    [37m-					# of milliseconds[0m
    [37m-[0m
    [37m-[0m
    [37m # - What to Log -[0m
    [37m [0m
    [37m #debug_print_parse = off[0m
    [37m #debug_print_rewritten = off[0m
    [37m #debug_print_plan = off[0m
    [37m #debug_pretty_print = on[0m
    [37m-#log_checkpoints = off[0m
    [37m #log_connections = off[0m
    [37m #log_disconnections = off[0m
    [37m #log_duration = off[0m
    [37m-#log_error_verbosity = default		# terse, default, or verbose messages[0m
    [37m+#log_error_verbosity = default    # terse, default, or verbose messages[0m
    [37m #log_hostname = off[0m
    [37m-#log_line_prefix = ''			# special values:[0m
    [37m-					#   %a = application name[0m
    [37m-					#   %u = user name[0m
    [37m-					#   %d = database name[0m
    [37m-					#   %r = remote host and port[0m
    [37m-					#   %h = remote host[0m
    [37m-					#   %p = process ID[0m
    [37m-					#   %t = timestamp without milliseconds[0m
    [37m-					#   %m = timestamp with milliseconds[0m
    [37m-					#   %n = timestamp with milliseconds (as a Unix epoch)[0m
    [37m-					#   %i = command tag[0m
    [37m-					#   %e = SQL state[0m
    [37m-					#   %c = session ID[0m
    [37m-					#   %l = session line number[0m
    [37m-					#   %s = session start timestamp[0m
    [37m-					#   %v = virtual transaction ID[0m
    [37m-					#   %x = transaction ID (0 if none)[0m
    [37m-					#   %q = stop here in non-session[0m
    [37m-					#        processes[0m
    [37m-					#   %% = '%'[0m
    [37m-					# e.g. '<%u%%%d> '[0m
    [37m-#log_lock_waits = off			# log lock waits >= deadlock_timeout[0m
    [37m-#log_statement = 'none'			# none, ddl, mod, all[0m
    [37m-#log_replication_commands = off[0m
    [37m-#log_temp_files = -1			# log temporary files equal or larger[0m
    [37m-					# than the specified size in kilobytes;[0m
    [37m-					# -1 disables, 0 logs all temp files[0m
    [37m-log_timezone = 'UTC'[0m
    [37m+#log_lock_waits = off     # log lock waits >= deadlock_timeout[0m
    [37m+#log_statement = 'none'     # none, ddl, mod, all[0m
    [37m+#log_timezone = '(defaults to server environment setting)'[0m
    [37m [0m
    [37m [0m
    [37m-# - Process Title -[0m
    [37m-[0m
    [37m-#cluster_name = ''			# added to process titles if nonempty[0m
    [37m-					# (change requires restart)[0m
    [37m-#update_process_title = on[0m
    [37m-[0m
    [37m-[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m # RUNTIME STATISTICS[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m@@ -475,9 +373,9 @@[0m
    [37m [0m
    [37m #track_activities = on[0m
    [37m #track_counts = on[0m
    [37m-#track_io_timing = off[0m
    [37m-#track_functions = none			# none, pl, all[0m
    [37m-#track_activity_query_size = 1024	# (change requires restart)[0m
    [37m+#track_functions = none     # none, pl, all[0m
    [37m+track_activity_query_size = 1024 # (change requires restart)[0m
    [37m+#update_process_title = on[0m
    [37m #stats_temp_directory = 'pg_stat_tmp'[0m
    [37m [0m
    [37m [0m
    [37m@@ -493,93 +391,50 @@[0m
    [37m # AUTOVACUUM PARAMETERS[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m [0m
    [37m-#autovacuum = on			# Enable autovacuum subprocess?  'on'[0m
    [37m-					# requires track_counts to also be on.[0m
    [37m-#log_autovacuum_min_duration = -1	# -1 disables, 0 logs all actions and[0m
    [37m-					# their durations, > 0 logs only[0m
    [37m-					# actions running at least this number[0m
    [37m-					# of milliseconds.[0m
    [37m-#autovacuum_max_workers = 3		# max number of autovacuum subprocesses[0m
    [37m-					# (change requires restart)[0m
    [37m-#autovacuum_naptime = 1min		# time between autovacuum runs[0m
    [37m-#autovacuum_vacuum_threshold = 50	# min number of row updates before[0m
    [37m-					# vacuum[0m
    [37m-#autovacuum_analyze_threshold = 50	# min number of row updates before[0m
    [37m-					# analyze[0m
    [37m-#autovacuum_vacuum_scale_factor = 0.2	# fraction of table size before vacuum[0m
    [37m-#autovacuum_analyze_scale_factor = 0.1	# fraction of table size before analyze[0m
    [37m-#autovacuum_freeze_max_age = 200000000	# maximum XID age before forced vacuum[0m
    [37m-					# (change requires restart)[0m
    [37m-#autovacuum_multixact_freeze_max_age = 400000000	# maximum multixact age[0m
    [37m-					# before forced vacuum[0m
    [37m-					# (change requires restart)[0m
    [37m-#autovacuum_vacuum_cost_delay = 20ms	# default vacuum cost delay for[0m
    [37m-					# autovacuum, in milliseconds;[0m
    [37m-					# -1 means use vacuum_cost_delay[0m
    [37m-#autovacuum_vacuum_cost_limit = -1	# default vacuum cost limit for[0m
    [37m-					# autovacuum, -1 means use[0m
    [37m-					# vacuum_cost_limit[0m
    [37m-[0m
    [37m-[0m
    [37m+autovacuum_max_workers = 3 # max number of autovacuum subprocesses[0m
    [37m+          # (change requires restart)[0m
    [37m+autovacuum_freeze_max_age = 200000000  # maximum XID age before forced vacuum[0m
    [37m+          # (change requires restart)[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m # CLIENT CONNECTION DEFAULTS[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m [0m
    [37m # - Statement Behavior -[0m
    [37m [0m
    [37m-#search_path = '"$user", public'	# schema names[0m
    [37m-#default_tablespace = ''		# a tablespace name, '' uses the default[0m
    [37m-#temp_tablespaces = ''			# a list of tablespace names, '' uses[0m
    [37m-					# only default tablespace[0m
    [37m+#search_path = '"$user",public'   # schema names[0m
    [37m+#default_tablespace = ''    # a tablespace name, '' uses the default[0m
    [37m+#temp_tablespaces = ''      # a list of tablespace names, '' uses[0m
    [37m+          # only default tablespace[0m
    [37m #check_function_bodies = on[0m
    [37m #default_transaction_isolation = 'read committed'[0m
    [37m #default_transaction_read_only = off[0m
    [37m #default_transaction_deferrable = off[0m
    [37m #session_replication_role = 'origin'[0m
    [37m-#statement_timeout = 0			# in milliseconds, 0 is disabled[0m
    [37m-#lock_timeout = 0			# in milliseconds, 0 is disabled[0m
    [37m-#idle_in_transaction_session_timeout = 0		# in milliseconds, 0 is disabled[0m
    [37m #vacuum_freeze_min_age = 50000000[0m
    [37m #vacuum_freeze_table_age = 150000000[0m
    [37m-#vacuum_multixact_freeze_min_age = 5000000[0m
    [37m-#vacuum_multixact_freeze_table_age = 150000000[0m
    [37m-#bytea_output = 'hex'			# hex, escape[0m
    [37m+#bytea_output = 'hex'     # hex, escape[0m
    [37m #xmlbinary = 'base64'[0m
    [37m #xmloption = 'content'[0m
    [37m-#gin_fuzzy_search_limit = 0[0m
    [37m-#gin_pending_list_limit = 4MB[0m
    [37m [0m
    [37m # - Locale and Formatting -[0m
    [37m [0m
    [37m-datestyle = 'iso, mdy'[0m
    [37m #intervalstyle = 'postgres'[0m
    [37m-timezone = 'UTC'[0m
    [37m+#timezone = '(defaults to server environment setting)'[0m
    [37m #timezone_abbreviations = 'Default'     # Select the set of available time zone[0m
    [37m-					# abbreviations.  Currently, there are[0m
    [37m-					#   Default[0m
    [37m-					#   Australia (historical usage)[0m
    [37m-					#   India[0m
    [37m-					# You can create your own file in[0m
    [37m-					# share/timezonesets/.[0m
    [37m-#extra_float_digits = 0			# min -15, max 3[0m
    [37m-#client_encoding = sql_ascii		# actually, defaults to database[0m
    [37m-					# encoding[0m
    [37m+          # abbreviations.  Currently, there are[0m
    [37m+          #   Default[0m
    [37m+          #   Australia[0m
    [37m+          #   India[0m
    [37m+          # You can create your own file in[0m
    [37m+          # share/timezonesets/.[0m
    [37m+#extra_float_digits = 0     # min -15, max 3[0m
    [37m+#client_encoding = sql_ascii    # actually, defaults to database[0m
    [37m+          # encoding[0m
    [37m [0m
    [37m-# These settings are initialized by initdb, but they can be changed.[0m
    [37m-lc_messages = 'C'			# locale for system error message[0m
    [37m-					# strings[0m
    [37m-lc_monetary = 'C'			# locale for monetary formatting[0m
    [37m-lc_numeric = 'C'			# locale for number formatting[0m
    [37m-lc_time = 'C'				# locale for time formatting[0m
    [37m-[0m
    [37m-# default configuration for text search[0m
    [37m-default_text_search_config = 'pg_catalog.english'[0m
    [37m-[0m
    [37m # - Other Defaults -[0m
    [37m [0m
    [37m #dynamic_library_path = '$libdir'[0m
    [37m #local_preload_libraries = ''[0m
    [37m-#session_preload_libraries = ''[0m
    [37m [0m
    [37m [0m
    [37m #------------------------------------------------------------------------------[0m
    [37m@@ -587,12 +442,14 @@[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m [0m
    [37m #deadlock_timeout = 1s[0m
    [37m-#max_locks_per_transaction = 64		# min 10[0m
    [37m-					# (change requires restart)[0m
    [37m-#max_pred_locks_per_transaction = 64	# min 10[0m
    [37m-					# (change requires restart)[0m
    [37m+max_locks_per_transaction = 128   # min 10[0m
    [37m+          # (change requires restart)[0m
    [37m+# Note:  Each lock table slot uses ~270 bytes of shared memory, and there are[0m
    [37m+# max_locks_per_transaction * (max_connections + max_prepared_transactions)[0m
    [37m+# lock table slots.[0m
    [37m+#max_pred_locks_per_transaction = 64  # min 10[0m
    [37m+          # (change requires restart)[0m
    [37m [0m
    [37m-[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m # VERSION/PLATFORM COMPATIBILITY[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m@@ -600,11 +457,10 @@[0m
    [37m # - Previous PostgreSQL Versions -[0m
    [37m [0m
    [37m #array_nulls = on[0m
    [37m-#backslash_quote = safe_encoding	# on, off, or safe_encoding[0m
    [37m+#backslash_quote = safe_encoding  # on, off, or safe_encoding[0m
    [37m #default_with_oids = off[0m
    [37m #escape_string_warning = on[0m
    [37m #lo_compat_privileges = off[0m
    [37m-#operator_precedence_warning = off[0m
    [37m #quote_all_identifiers = off[0m
    [37m #sql_inheritance = on[0m
    [37m #standard_conforming_strings = on[0m
    [37m@@ -619,26 +475,15 @@[0m
    [37m # ERROR HANDLING[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m [0m
    [37m-#exit_on_error = off			# terminate session on any error?[0m
    [37m-#restart_after_crash = on		# reinitialize after backend crash?[0m
    [37m+#exit_on_error = off        # terminate session on any error?[0m
    [37m+#restart_after_crash = on     # reinitialize after backend crash?[0m
    [37m [0m
    [37m [0m
    [37m #------------------------------------------------------------------------------[0m
    [37m-# CONFIG FILE INCLUDES[0m
    [37m-#------------------------------------------------------------------------------[0m
    [37m-[0m
    [37m-# These options allow settings to be loaded from files other than the[0m
    [37m-# default postgresql.conf.[0m
    [37m-[0m
    [37m-#include_dir = 'conf.d'			# include files ending in '.conf' from[0m
    [37m-					# directory 'conf.d'[0m
    [37m-#include_if_exists = 'exists.conf'	# include file only if it exists[0m
    [37m-#include = 'special.conf'		# include file[0m
    [37m-[0m
    [37m-[0m
    [37m-#------------------------------------------------------------------------------[0m
    [37m # CUSTOMIZED OPTIONS[0m
    [37m #------------------------------------------------------------------------------[0m
    [37m [0m
    [37m-# Add settings for extensions here[0m
    [37m+#custom_variable_classes = ''   # list of custom variable class names[0m
    [37m+[0m
    [37m+include 'runtime.conf'[0m
    [32m- change mode from '0600' to '0644'[0m
[0m  * template[/var/opt/gitlab/postgresql/data/runtime.conf] action create
    [32m- create new file /var/opt/gitlab/postgresql/data/runtime.conf[0m
    [32m- update content in file /var/opt/gitlab/postgresql/data/runtime.conf from none to f59a98[0m
    [37m--- /var/opt/gitlab/postgresql/data/runtime.conf	2018-05-30 10:03:45.773708669 +0000[0m
    [37m+++ /var/opt/gitlab/postgresql/data/.chef-runtime20180530-48-1jtesi9.conf	2018-05-30 10:03:45.773708669 +0000[0m
    [37m@@ -1 +1,129 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m+# Changing variables in this file should only require a reload of PostgreSQL[0m
    [37m+# As the gitlab-psql user, run:[0m
    [37m+# /opt/gitlab/embedded/bin/pg_ctl reload -D /var/opt/gitlab/postgresql/data[0m
    [37m+work_mem = 16MB				# min 64kB[0m
    [37m+maintenance_work_mem = 16MB # 16MB    # min 1MB[0m
    [37m+synchronous_commit = on # synchronization level; on, off, or local[0m
    [37m+synchronous_standby_names = ''[0m
    [37m+[0m
    [37m+# - Checkpoints -[0m
    [37m+min_wal_size = 80MB[0m
    [37m+max_wal_size = 1GB[0m
    [37m+[0m
    [37m+checkpoint_timeout = 5min		# range 30s-1h, default 5min[0m
    [37m+checkpoint_completion_target = 0.9	# checkpoint target duration, 0.0 - 1.0, default 0.5[0m
    [37m+checkpoint_warning = 30s		# 0 disables, default 30s[0m
    [37m+[0m
    [37m+# - Archiving -[0m
    [37m+archive_command = ''   # command to use to archive a logfile segment[0m
    [37m+archive_timeout = 0    # force a logfile segment switch after this[0m
    [37m+        # number of seconds; 0 disables[0m
    [37m+[0m
    [37m+# - Replication[0m
    [37m+wal_keep_segments = 10[0m
    [37m+[0m
    [37m+max_standby_archive_delay = 30s # max delay before canceling queries[0m
    [37m+          # when reading WAL from archive;[0m
    [37m+          # -1 allows indefinite delay[0m
    [37m+max_standby_streaming_delay = 30s # max delay before canceling queries[0m
    [37m+          # when reading streaming WAL;[0m
    [37m+          # -1 allows indefinite delay[0m
    [37m+[0m
    [37m+hot_standby_feedback = off   # send info from standby to prevent[0m
    [37m+          # query conflicts[0m
    [37m+[0m
    [37m+# - Planner Cost Constants -[0m
    [37m+#seq_page_cost = 1.0      # measured on an arbitrary scale[0m
    [37m+random_page_cost = 2.0     # same scale as above[0m
    [37m+[0m
    [37m+effective_cache_size = 497MB # Default 128MB[0m
    [37m+[0m
    [37m+log_min_duration_statement = -1  # -1 is disabled, 0 logs all statements[0m
    [37m+          # and their durations, > 0 logs only[0m
    [37m+          # statements running at least this number[0m
    [37m+          # of milliseconds[0m
    [37m+[0m
    [37m+log_checkpoints = off[0m
    [37m+[0m
    [37m+log_line_prefix = '' # default '', special values:[0m
    [37m+          #   %a = application name[0m
    [37m+          #   %u = user name[0m
    [37m+          #   %d = database name[0m
    [37m+          #   %r = remote host and port[0m
    [37m+          #   %h = remote host[0m
    [37m+          #   %p = process ID[0m
    [37m+          #   %t = timestamp without milliseconds[0m
    [37m+          #   %m = timestamp with milliseconds[0m
    [37m+          #   %i = command tag[0m
    [37m+          #   %e = SQL state[0m
    [37m+          #   %c = session ID[0m
    [37m+          #   %l = session line number[0m
    [37m+          #   %s = session start timestamp[0m
    [37m+          #   %v = virtual transaction ID[0m
    [37m+          #   %x = transaction ID (0 if none)[0m
    [37m+          #   %q = stop here in non-session[0m
    [37m+          #        processes[0m
    [37m+          #   %% = '%'[0m
    [37m+[0m
    [37m+log_temp_files = -1      # log temporary files equal or larger[0m
    [37m+          # than the specified size in kilobytes;[0m
    [37m+          # -1 disables, 0 logs all temp files[0m
    [37m+[0m
    [37m+[0m
    [37m+# - Autovacuum parameters -[0m
    [37m+autovacuum = on # Enable autovacuum subprocess?  'on'[0m
    [37m+          # requires track_counts to also be on.[0m
    [37m+[0m
    [37m+log_autovacuum_min_duration = -1 # -1 disables, 0 logs all actions and[0m
    [37m+          # their durations, > 0 logs only[0m
    [37m+          # actions running at least this number[0m
    [37m+          # of milliseconds.[0m
    [37m+[0m
    [37m+autovacuum_naptime = 1min # time between autovacuum runs[0m
    [37m+autovacuum_vacuum_threshold = 50 # min number of row updates before[0m
    [37m+          # vacuum[0m
    [37m+autovacuum_analyze_threshold = 50 # min number of row updates before[0m
    [37m+          # analyze[0m
    [37m+autovacuum_vacuum_scale_factor = 0.02 # fraction of table size before vacuum[0m
    [37m+autovacuum_analyze_scale_factor = 0.01 # fraction of table size before analyze[0m
    [37m+autovacuum_vacuum_cost_delay = 20ms # default vacuum cost delay for[0m
    [37m+          # autovacuum, in milliseconds;[0m
    [37m+          # -1 means use vacuum_cost_delay[0m
    [37m+autovacuum_vacuum_cost_limit = -1 # default vacuum cost limit for[0m
    [37m+          # autovacuum, -1 means use[0m
    [37m+          # vacuum_cost_limit[0m
    [37m+[0m
    [37m+# - Client connection timeouts[0m
    [37m+statement_timeout = 60000[0m
    [37m+[0m
    [37m+idle_in_transaction_session_timeout = 60000[0m
    [37m+[0m
    [37m+# IO settings[0m
    [37m+effective_io_concurrency = 1[0m
    [37m+track_io_timing = 'off'[0m
    [37m+[0m
    [37m+# Parallel worker settings[0m
    [37m+max_worker_processes = 8[0m
    [37m+max_parallel_workers_per_gather = 0[0m
    [37m+[0m
    [37m+# Deadlock handling and logging[0m
    [37m+deadlock_timeout = '5s'[0m
    [37m+log_lock_waits = 1[0m
    [37m+[0m
    [37m+# - Locale and Formatting -[0m
    [37m+datestyle = 'iso, mdy'[0m
    [37m+[0m
    [37m+# These settings are initialized by initdb, but they can be changed.[0m
    [37m+lc_messages = 'C'     # locale for system error message[0m
    [37m+          # strings[0m
    [37m+lc_monetary = 'C'     # locale for monetary formatting[0m
    [37m+lc_numeric = 'C'      # locale for number formatting[0m
    [37m+lc_time = 'C'       # locale for time formatting[0m
    [37m+[0m
    [37m+# default configuration for text search[0m
    [37m+default_text_search_config = 'pg_catalog.english'[0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
[0m  * template[/var/opt/gitlab/postgresql/data/pg_hba.conf] action create
    [32m- update content in file /var/opt/gitlab/postgresql/data/pg_hba.conf from d7d331 to 40e348[0m
    [37m--- /var/opt/gitlab/postgresql/data/pg_hba.conf	2018-05-30 10:03:44.773708669 +0000[0m
    [37m+++ /var/opt/gitlab/postgresql/data/.chef-pg_hba20180530-48-17t6ef7.conf	2018-05-30 10:03:45.783708669 +0000[0m
    [37m@@ -1,94 +1,74 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m # PostgreSQL Client Authentication Configuration File[0m
    [37m # ===================================================[0m
    [37m #[0m
    [37m-# Refer to the "Client Authentication" section in the PostgreSQL[0m
    [37m-# documentation for a complete description of this file.  A short[0m
    [37m-# synopsis follows.[0m
    [37m+# Refer to the "Client Authentication" section in the[0m
    [37m+# PostgreSQL documentation for a complete description[0m
    [37m+# of this file.  A short synopsis follows.[0m
    [37m #[0m
    [37m # This file controls: which hosts are allowed to connect, how clients[0m
    [37m # are authenticated, which PostgreSQL user names they can use, which[0m
    [37m # databases they can access.  Records take one of these forms:[0m
    [37m #[0m
    [37m-# local      DATABASE  USER  METHOD  [OPTIONS][0m
    [37m-# host       DATABASE  USER  ADDRESS  METHOD  [OPTIONS][0m
    [37m-# hostssl    DATABASE  USER  ADDRESS  METHOD  [OPTIONS][0m
    [37m-# hostnossl  DATABASE  USER  ADDRESS  METHOD  [OPTIONS][0m
    [37m+# local      DATABASE  USER  METHOD  [OPTION][0m
    [37m+# host       DATABASE  USER  CIDR-ADDRESS  METHOD  [OPTION][0m
    [37m+# hostssl    DATABASE  USER  CIDR-ADDRESS  METHOD  [OPTION][0m
    [37m+# hostnossl  DATABASE  USER  CIDR-ADDRESS  METHOD  [OPTION][0m
    [37m #[0m
    [37m # (The uppercase items must be replaced by actual values.)[0m
    [37m #[0m
    [37m-# The first field is the connection type: "local" is a Unix-domain[0m
    [37m-# socket, "host" is either a plain or SSL-encrypted TCP/IP socket,[0m
    [37m-# "hostssl" is an SSL-encrypted TCP/IP socket, and "hostnossl" is a[0m
    [37m-# plain TCP/IP socket.[0m
    [37m+# The first field is the connection type: "local" is a Unix-domain socket,[0m
    [37m+# "host" is either a plain or SSL-encrypted TCP/IP socket, "hostssl" is an[0m
    [37m+# SSL-encrypted TCP/IP socket, and "hostnossl" is a plain TCP/IP socket.[0m
    [37m #[0m
    [37m-# DATABASE can be "all", "sameuser", "samerole", "replication", a[0m
    [37m-# database name, or a comma-separated list thereof. The "all"[0m
    [37m-# keyword does not match "replication". Access to replication[0m
    [37m-# must be enabled in a separate record (see example below).[0m
    [37m+# DATABASE can be "all", "sameuser", "samerole", a database name, or[0m
    [37m+# a comma-separated list thereof.[0m
    [37m #[0m
    [37m-# USER can be "all", a user name, a group name prefixed with "+", or a[0m
    [37m-# comma-separated list thereof.  In both the DATABASE and USER fields[0m
    [37m-# you can also write a file name prefixed with "@" to include names[0m
    [37m-# from a separate file.[0m
    [37m+# USER can be "all", a user name, a group name prefixed with "+", or[0m
    [37m+# a comma-separated list thereof.  In both the DATABASE and USER fields[0m
    [37m+# you can also write a file name prefixed with "@" to include names from[0m
    [37m+# a separate file.[0m
    [37m #[0m
    [37m-# ADDRESS specifies the set of hosts the record matches.  It can be a[0m
    [37m-# host name, or it is made up of an IP address and a CIDR mask that is[0m
    [37m-# an integer (between 0 and 32 (IPv4) or 128 (IPv6) inclusive) that[0m
    [37m-# specifies the number of significant bits in the mask.  A host name[0m
    [37m-# that starts with a dot (.) matches a suffix of the actual host name.[0m
    [37m-# Alternatively, you can write an IP address and netmask in separate[0m
    [37m-# columns to specify the set of hosts.  Instead of a CIDR-address, you[0m
    [37m-# can write "samehost" to match any of the server's own IP addresses,[0m
    [37m-# or "samenet" to match any address in any subnet that the server is[0m
    [37m-# directly connected to.[0m
    [37m+# CIDR-ADDRESS specifies the set of hosts the record matches.[0m
    [37m+# It is made up of an IP address and a CIDR mask that is an integer[0m
    [37m+# (between 0 and 32 (IPv4) or 128 (IPv6) inclusive) that specifies[0m
    [37m+# the number of significant bits in the mask.  Alternatively, you can write[0m
    [37m+# an IP address and netmask in separate columns to specify the set of hosts.[0m
    [37m #[0m
    [37m-# METHOD can be "trust", "reject", "md5", "password", "gss", "sspi",[0m
    [37m-# "ident", "peer", "pam", "ldap", "radius" or "cert".  Note that[0m
    [37m-# "password" sends passwords in clear text; "md5" is preferred since[0m
    [37m-# it sends encrypted passwords.[0m
    [37m+# METHOD can be "trust", "reject", "md5", "crypt", "password", "gss", "sspi",[0m
    [37m+# "krb5", "ident", "pam" or "ldap".  Note that "password" sends passwords[0m
    [37m+# in clear text; "md5" is preferred since it sends encrypted passwords.[0m
    [37m #[0m
    [37m-# OPTIONS are a set of options for the authentication in the format[0m
    [37m-# NAME=VALUE.  The available options depend on the different[0m
    [37m-# authentication methods -- refer to the "Client Authentication"[0m
    [37m-# section in the documentation for a list of which options are[0m
    [37m-# available for which authentication methods.[0m
    [37m+# OPTION is the ident map or the name of the PAM service, depending on METHOD.[0m
    [37m #[0m
    [37m-# Database and user names containing spaces, commas, quotes and other[0m
    [37m-# special characters must be quoted.  Quoting one of the keywords[0m
    [37m-# "all", "sameuser", "samerole" or "replication" makes the name lose[0m
    [37m-# its special character, and just match a database or username with[0m
    [37m-# that name.[0m
    [37m+# Database and user names containing spaces, commas, quotes and other special[0m
    [37m+# characters must be quoted. Quoting one of the keywords "all", "sameuser" or[0m
    [37m+# "samerole" makes the name lose its special character, and just match a[0m
    [37m+# database or username with that name.[0m
    [37m #[0m
    [37m # This file is read on server startup and when the postmaster receives[0m
    [37m # a SIGHUP signal.  If you edit the file on a running system, you have[0m
    [37m-# to SIGHUP the postmaster for the changes to take effect.  You can[0m
    [37m-# use "pg_ctl reload" to do that.[0m
    [37m+# to SIGHUP the postmaster for the changes to take effect.  You can use[0m
    [37m+# "pg_ctl reload" to do that.[0m
    [37m [0m
    [37m # Put your actual configuration here[0m
    [37m # ----------------------------------[0m
    [37m #[0m
    [37m # If you want to allow non-local connections, you need to add more[0m
    [37m-# "host" records.  In that case you will also need to make PostgreSQL[0m
    [37m-# listen on a non-local interface via the listen_addresses[0m
    [37m-# configuration parameter, or via the -i or -h command line switches.[0m
    [37m+# "host" records. In that case you will also need to make PostgreSQL listen[0m
    [37m+# on a non-local interface via the listen_addresses configuration parameter,[0m
    [37m+# or via the -i or -h command line switches.[0m
    [37m+#[0m
    [37m [0m
    [37m-# CAUTION: Configuring the system for local "trust" authentication[0m
    [37m-# allows any local user to connect as any PostgreSQL user, including[0m
    [37m-# the database superuser.  If you do not trust all your local users,[0m
    [37m-# use another authentication method.[0m
    [37m [0m
    [37m+# TYPE  DATABASE    USER        CIDR-ADDRESS          METHOD[0m
    [37m [0m
    [37m-# TYPE  DATABASE        USER            ADDRESS                 METHOD[0m
    [37m-[0m
    [37m # "local" is for Unix domain socket connections only[0m
    [37m-local   all             all                                     trust[0m
    [37m-# IPv4 local connections:[0m
    [37m-host    all             all             127.0.0.1/32            trust[0m
    [37m-# IPv6 local connections:[0m
    [37m-host    all             all             ::1/128                 trust[0m
    [37m-# Allow replication connections from localhost, by a user with the[0m
    [37m-# replication privilege.[0m
    [37m-#local   replication     gitlab-psql                                trust[0m
    [37m-#host    replication     gitlab-psql        127.0.0.1/32            trust[0m
    [37m-#host    replication     gitlab-psql        ::1/128                 trust[0m
    [37m+local   all         all                               peer map=gitlab[0m
    [37m+[0m
    [37m+[0m
    [37m+[0m
    [32m- change mode from '0600' to '0644'[0m
[0m  * template[/var/opt/gitlab/postgresql/data/pg_ident.conf] action create
    [32m- update content in file /var/opt/gitlab/postgresql/data/pg_ident.conf from 297f46 to 5399a1[0m
    [37m--- /var/opt/gitlab/postgresql/data/pg_ident.conf	2018-05-30 10:03:44.773708669 +0000[0m
    [37m+++ /var/opt/gitlab/postgresql/data/.chef-pg_ident20180530-48-s5fyqk.conf	2018-05-30 10:03:45.803708669 +0000[0m
    [37m@@ -40,4 +40,8 @@[0m
    [37m # ----------------------------------[0m
    [37m [0m
    [37m # MAPNAME       SYSTEM-USERNAME         PG-USERNAME[0m
    [37m+gitlab  git  gitlab[0m
    [37m+gitlab  mattermost  gitlab_mattermost[0m
    [37m+# Default to a 1-1 mapping between system usernames and Postgres usernames[0m
    [37m+gitlab  /^(.*)$  \1[0m
    [32m- change mode from '0600' to '0644'[0m
[0m  * directory[/opt/gitlab/sv/postgresql] action create
    [32m- create new directory /opt/gitlab/sv/postgresql[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/postgresql/log] action create
    [32m- create new directory /opt/gitlab/sv/postgresql/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/postgresql/log/main] action create
    [32m- create new directory /opt/gitlab/sv/postgresql/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/postgresql/run] action create
    [32m- create new file /opt/gitlab/sv/postgresql/run[0m
    [32m- update content in file /opt/gitlab/sv/postgresql/run from none to 870bb6[0m
    [37m--- /opt/gitlab/sv/postgresql/run	2018-05-30 10:03:45.823708669 +0000[0m
    [37m+++ /opt/gitlab/sv/postgresql/.chef-run20180530-48-1ibpqe8	2018-05-30 10:03:45.823708669 +0000[0m
    [37m@@ -1 +1,5 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+exec chpst -P -U gitlab-psql -u gitlab-psql /opt/gitlab/embedded/bin/postgres -D /var/opt/gitlab/postgresql/data[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/postgresql/log/run] action create
    [32m- create new file /opt/gitlab/sv/postgresql/log/run[0m
    [32m- update content in file /opt/gitlab/sv/postgresql/log/run from none to ce742a[0m
    [37m--- /opt/gitlab/sv/postgresql/log/run	2018-05-30 10:03:45.833708669 +0000[0m
    [37m+++ /opt/gitlab/sv/postgresql/log/.chef-run20180530-48-14htsmw	2018-05-30 10:03:45.823708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/postgresql[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/postgresql/config] action create
    [32m- create new file /var/log/gitlab/postgresql/config[0m
    [32m- update content in file /var/log/gitlab/postgresql/config from none to 623c00[0m
    [37m--- /var/log/gitlab/postgresql/config	2018-05-30 10:03:45.833708669 +0000[0m
    [37m+++ /var/log/gitlab/postgresql/.chef-config20180530-48-fdixlm	2018-05-30 10:03:45.833708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload postgresql svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart postgresql svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/postgresql/down] action delete (up to date)
  * directory[/opt/gitlab/sv/postgresql/control] action create
    [32m- create new directory /opt/gitlab/sv/postgresql/control[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/postgresql/control/t] action create
    [32m- create new file /opt/gitlab/sv/postgresql/control/t[0m
    [32m- update content in file /opt/gitlab/sv/postgresql/control/t from none to 05ae12[0m
    [37m--- /opt/gitlab/sv/postgresql/control/t	2018-05-30 10:03:45.843708669 +0000[0m
    [37m+++ /opt/gitlab/sv/postgresql/control/.chef-t20180530-48-1b176me	2018-05-30 10:03:45.843708669 +0000[0m
    [37m@@ -1 +1,4 @@[0m
    [37m+#!/bin/sh[0m
    [37m+echo "received TERM from runit, sending INT instead to force quit connections"[0m
    [37m+/opt/gitlab/embedded/bin/sv interrupt postgresql[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * link[/opt/gitlab/init/postgresql] action create
    [32m- create symlink at /opt/gitlab/init/postgresql to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/postgresql] action create
    [32m- create symlink at /opt/gitlab/service/postgresql to /opt/gitlab/sv/postgresql[0m
[0m  * ruby_block[supervise_postgresql_sleep] action run
    [32m- execute the ruby block supervise_postgresql_sleep[0m
[0m  * directory[/opt/gitlab/sv/postgresql/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/postgresql/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/postgresql/supervise/ok] action touch
    [32m- create new file /opt/gitlab/sv/postgresql/supervise/ok[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
    [32m- change group from '' to 'gitlab-psql'[0m
    [32m- update utime on file /opt/gitlab/sv/postgresql/supervise/ok[0m
[0m  * file[/opt/gitlab/sv/postgresql/log/supervise/ok] action touch
    [32m- create new file /opt/gitlab/sv/postgresql/log/supervise/ok[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
    [32m- change group from '' to 'gitlab-psql'[0m
    [32m- update utime on file /opt/gitlab/sv/postgresql/log/supervise/ok[0m
[0m  * file[/opt/gitlab/sv/postgresql/supervise/control] action touch
    [32m- create new file /opt/gitlab/sv/postgresql/supervise/control[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
    [32m- change group from '' to 'gitlab-psql'[0m
    [32m- update utime on file /opt/gitlab/sv/postgresql/supervise/control[0m
[0m  * file[/opt/gitlab/sv/postgresql/log/supervise/control] action touch
    [32m- create new file /opt/gitlab/sv/postgresql/log/supervise/control[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
    [32m- change group from '' to 'gitlab-psql'[0m
    [32m- update utime on file /opt/gitlab/sv/postgresql/log/supervise/control[0m
[0m  * service[postgresql] action nothing (skipped due to action :nothing)
Recipe: postgresql::bin[0m
  * ruby_block[Link postgresql bin files to the correct version] action run (skipped due to only_if)
Recipe: postgresql::enable[0m
  * execute[/opt/gitlab/bin/gitlab-ctl start postgresql] action run
    [execute] ok: run: postgresql: (pid 746) 2s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start postgresql[0m
[0m  * template[/opt/gitlab/etc/gitlab-psql-rc] action create
    [32m- create new file /opt/gitlab/etc/gitlab-psql-rc[0m
    [32m- update content in file /opt/gitlab/etc/gitlab-psql-rc from none to 4fdb89[0m
    [37m--- /opt/gitlab/etc/gitlab-psql-rc	2018-05-30 10:03:50.633708669 +0000[0m
    [37m+++ /opt/gitlab/etc/.chef-gitlab-psql-rc20180530-48-1e8wsg0	2018-05-30 10:03:50.633708669 +0000[0m
    [37m@@ -1 +1,5 @@[0m
    [37m+psql_user='gitlab-psql'[0m
    [37m+psql_host='/var/opt/gitlab/postgresql'[0m
    [37m+psql_port='5432'[0m
    [37m+psql_dbname='gitlabhq_production'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * postgresql_user[gitlab] action create
    * execute[create gitlab postgresql user] action run
      [execute] CREATE ROLE
      [32m- execute /opt/gitlab/bin/gitlab-psql -d template1 -c "CREATE USER \"gitlab\""[0m
[0m  
[0m  * execute[create gitlabhq_production database] action run
    [32m- execute /opt/gitlab/embedded/bin/createdb --port 5432 -h /var/opt/gitlab/postgresql -O gitlab gitlabhq_production[0m
[0m  * postgresql_user[gitlab_replicator] action create
    * execute[create gitlab_replicator postgresql user] action run
      [execute] CREATE ROLE
      [32m- execute /opt/gitlab/bin/gitlab-psql -d template1 -c "CREATE USER \"gitlab_replicator\""[0m
[0m    * execute[set options for gitlab_replicator postgresql user] action run
      [execute] ALTER ROLE
      [32m- execute /opt/gitlab/bin/gitlab-psql -d template1 -c "ALTER USER \"gitlab_replicator\" replication"[0m
[0m  
[0m  * postgresql_extension[pg_trgm] action enable
    * postgresql_query[enable pg_trgm extension] action run
      * execute[enable pg_trgm extension (postgresql)] action run
        [execute] CREATE EXTENSION
        [32m- execute /opt/gitlab/bin/gitlab-psql -d gitlabhq_production -c "CREATE EXTENSION IF NOT EXISTS pg_trgm"[0m
[0m    
[0m  
[0m  * execute[reload postgresql] action nothing (skipped due to action :nothing)
  * execute[start postgresql] action nothing (skipped due to action :nothing)
Recipe: gitlab::database_migrations[0m
  * bash[migrate gitlab-rails database] action run
    [execute] -- enable_extension("plpgsql")
                 -> 0.0084s
              -- enable_extension("pg_trgm")
                 -> 0.0017s
              -- create_table("abuse_reports", {:force=>:cascade})
                 -> 0.0117s
              -- create_table("appearances", {:force=>:cascade})
                 -> 0.0050s
              -- create_table("application_setting_terms", {:force=>:cascade})
                 -> 0.0043s
              -- create_table("application_settings", {:force=>:cascade})
                 -> 0.0265s
              -- create_table("audit_events", {:force=>:cascade})
                 -> 0.0044s
              -- add_index("audit_events", ["entity_id", "entity_type"], {:name=>"index_audit_events_on_entity_id_and_entity_type", :using=>:btree})
                 -> 0.0037s
              -- create_table("award_emoji", {:force=>:cascade})
                 -> 0.0049s
              -- add_index("award_emoji", ["awardable_type", "awardable_id"], {:name=>"index_award_emoji_on_awardable_type_and_awardable_id", :using=>:btree})
                 -> 0.0028s
              -- add_index("award_emoji", ["user_id", "name"], {:name=>"index_award_emoji_on_user_id_and_name", :using=>:btree})
                 -> 0.0023s
              -- create_table("badges", {:force=>:cascade})
                 -> 0.0051s
              -- add_index("badges", ["group_id"], {:name=>"index_badges_on_group_id", :using=>:btree})
                 -> 0.0029s
              -- add_index("badges", ["project_id"], {:name=>"index_badges_on_project_id", :using=>:btree})
                 -> 0.0035s
              -- create_table("boards", {:force=>:cascade})
                 -> 0.0041s
              -- add_index("boards", ["group_id"], {:name=>"index_boards_on_group_id", :using=>:btree})
                 -> 0.0033s
              -- add_index("boards", ["project_id"], {:name=>"index_boards_on_project_id", :using=>:btree})
                 -> 0.0043s
              -- create_table("broadcast_messages", {:force=>:cascade})
                 -> 0.0049s
              -- add_index("broadcast_messages", ["starts_at", "ends_at", "id"], {:name=>"index_broadcast_messages_on_starts_at_and_ends_at_and_id", :using=>:btree})
                 -> 0.0037s
              -- create_table("chat_names", {:force=>:cascade})
                 -> 0.0044s
              -- add_index("chat_names", ["service_id", "team_id", "chat_id"], {:name=>"index_chat_names_on_service_id_and_team_id_and_chat_id", :unique=>true, :using=>:btree})
                 -> 0.0043s
              -- add_index("chat_names", ["user_id", "service_id"], {:name=>"index_chat_names_on_user_id_and_service_id", :unique=>true, :using=>:btree})
                 -> 0.0031s
              -- create_table("chat_teams", {:force=>:cascade})
                 -> 0.0055s
              -- add_index("chat_teams", ["namespace_id"], {:name=>"index_chat_teams_on_namespace_id", :unique=>true, :using=>:btree})
                 -> 0.0041s
              -- create_table("ci_build_trace_chunks", {:id=>:bigserial, :force=>:cascade})
                 -> 0.0042s
              -- add_index("ci_build_trace_chunks", ["build_id", "chunk_index"], {:name=>"index_ci_build_trace_chunks_on_build_id_and_chunk_index", :unique=>true, :using=>:btree})
                 -> 0.0033s
              -- create_table("ci_build_trace_section_names", {:force=>:cascade})
                 -> 0.0060s
              -- add_index("ci_build_trace_section_names", ["project_id", "name"], {:name=>"index_ci_build_trace_section_names_on_project_id_and_name", :unique=>true, :using=>:btree})
                 -> 0.0036s
              -- create_table("ci_build_trace_sections", {:force=>:cascade})
                 -> 0.0031s
              -- add_index("ci_build_trace_sections", ["build_id", "section_name_id"], {:name=>"index_ci_build_trace_sections_on_build_id_and_section_name_id", :unique=>true, :using=>:btree})
                 -> 0.0034s
              -- add_index("ci_build_trace_sections", ["project_id"], {:name=>"index_ci_build_trace_sections_on_project_id", :using=>:btree})
                 -> 0.0053s
              -- add_index("ci_build_trace_sections", ["section_name_id"], {:name=>"index_ci_build_trace_sections_on_section_name_id", :using=>:btree})
                 -> 0.0051s
              -- create_table("ci_builds", {:force=>:cascade})
                 -> 0.0061s
              -- add_index("ci_builds", ["artifacts_expire_at"], {:name=>"index_ci_builds_on_artifacts_expire_at", :where=>"(artifacts_file <> ''::text)", :using=>:btree})
                 -> 0.0038s
              -- add_index("ci_builds", ["auto_canceled_by_id"], {:name=>"index_ci_builds_on_auto_canceled_by_id", :using=>:btree})
                 -> 0.0037s
              -- add_index("ci_builds", ["commit_id", "stage_idx", "created_at"], {:name=>"index_ci_builds_on_commit_id_and_stage_idx_and_created_at", :using=>:btree})
                 -> 0.0032s
              -- add_index("ci_builds", ["commit_id", "status", "type"], {:name=>"index_ci_builds_on_commit_id_and_status_and_type", :using=>:btree})
                 -> 0.0039s
              -- add_index("ci_builds", ["commit_id", "type", "name", "ref"], {:name=>"index_ci_builds_on_commit_id_and_type_and_name_and_ref", :using=>:btree})
                 -> 0.0039s
              -- add_index("ci_builds", ["commit_id", "type", "ref"], {:name=>"index_ci_builds_on_commit_id_and_type_and_ref", :using=>:btree})
                 -> 0.0040s
              -- add_index("ci_builds", ["project_id", "id"], {:name=>"index_ci_builds_on_project_id_and_id", :using=>:btree})
                 -> 0.0031s
              -- add_index("ci_builds", ["protected"], {:name=>"index_ci_builds_on_protected", :using=>:btree})
                 -> 0.0035s
              -- add_index("ci_builds", ["runner_id"], {:name=>"index_ci_builds_on_runner_id", :using=>:btree})
                 -> 0.0027s
              -- add_index("ci_builds", ["stage_id", "stage_idx"], {:name=>"tmp_build_stage_position_index", :where=>"(stage_idx IS NOT NULL)", :using=>:btree})
                 -> 0.0041s
              -- add_index("ci_builds", ["stage_id"], {:name=>"index_ci_builds_on_stage_id", :using=>:btree})
                 -> 0.0035s
              -- add_index("ci_builds", ["status", "type", "runner_id"], {:name=>"index_ci_builds_on_status_and_type_and_runner_id", :using=>:btree})
                 -> 0.0035s
              -- add_index("ci_builds", ["status"], {:name=>"index_ci_builds_on_status", :using=>:btree})
                 -> 0.0028s
              -- add_index("ci_builds", ["token"], {:name=>"index_ci_builds_on_token", :unique=>true, :using=>:btree})
                 -> 0.0024s
              -- add_index("ci_builds", ["updated_at"], {:name=>"index_ci_builds_on_updated_at", :using=>:btree})
                 -> 0.0031s
              -- add_index("ci_builds", ["user_id"], {:name=>"index_ci_builds_on_user_id", :using=>:btree})
                 -> 0.0036s
              -- create_table("ci_builds_metadata", {:force=>:cascade})
                 -> 0.0038s
              -- add_index("ci_builds_metadata", ["build_id"], {:name=>"index_ci_builds_metadata_on_build_id", :unique=>true, :using=>:btree})
                 -> 0.0028s
              -- add_index("ci_builds_metadata", ["project_id"], {:name=>"index_ci_builds_metadata_on_project_id", :using=>:btree})
                 -> 0.0028s
              -- create_table("ci_group_variables", {:force=>:cascade})
                 -> 0.0058s
              -- add_index("ci_group_variables", ["group_id", "key"], {:name=>"index_ci_group_variables_on_group_id_and_key", :unique=>true, :using=>:btree})
                 -> 0.0034s
              -- create_table("ci_job_artifacts", {:force=>:cascade})
                 -> 0.0059s
              -- add_index("ci_job_artifacts", ["expire_at", "job_id"], {:name=>"index_ci_job_artifacts_on_expire_at_and_job_id", :using=>:btree})
                 -> 0.0029s
              -- add_index("ci_job_artifacts", ["file_store"], {:name=>"index_ci_job_artifacts_on_file_store", :using=>:btree})
                 -> 0.0030s
              -- add_index("ci_job_artifacts", ["job_id", "file_type"], {:name=>"index_ci_job_artifacts_on_job_id_and_file_type", :unique=>true, :using=>:btree})
                 -> 0.0034s
              -- add_index("ci_job_artifacts", ["project_id"], {:name=>"index_ci_job_artifacts_on_project_id", :using=>:btree})
                 -> 0.0033s
              -- create_table("ci_pipeline_schedule_variables", {:force=>:cascade})
                 -> 0.0038s
              -- add_index("ci_pipeline_schedule_variables", ["pipeline_schedule_id", "key"], {:name=>"index_ci_pipeline_schedule_variables_on_schedule_id_and_key", :unique=>true, :using=>:btree})
                 -> 0.0027s
              -- create_table("ci_pipeline_schedules", {:force=>:cascade})
                 -> 0.0060s
              -- add_index("ci_pipeline_schedules", ["next_run_at", "active"], {:name=>"index_ci_pipeline_schedules_on_next_run_at_and_active", :using=>:btree})
                 -> 0.0033s
              -- add_index("ci_pipeline_schedules", ["project_id"], {:name=>"index_ci_pipeline_schedules_on_project_id", :using=>:btree})
                 -> 0.0029s
              -- create_table("ci_pipeline_variables", {:force=>:cascade})
                 -> 0.0049s
              -- add_index("ci_pipeline_variables", ["pipeline_id", "key"], {:name=>"index_ci_pipeline_variables_on_pipeline_id_and_key", :unique=>true, :using=>:btree})
                 -> 0.0040s
              -- create_table("ci_pipelines", {:force=>:cascade})
                 -> 0.0061s
              -- add_index("ci_pipelines", ["auto_canceled_by_id"], {:name=>"index_ci_pipelines_on_auto_canceled_by_id", :using=>:btree})
                 -> 0.0027s
              -- add_index("ci_pipelines", ["pipeline_schedule_id"], {:name=>"index_ci_pipelines_on_pipeline_schedule_id", :using=>:btree})
                 -> 0.0037s
              -- add_index("ci_pipelines", ["project_id", "ref", "status", "id"], {:name=>"index_ci_pipelines_on_project_id_and_ref_and_status_and_id", :using=>:btree})
                 -> 0.0119s
              -- add_index("ci_pipelines", ["project_id", "sha"], {:name=>"index_ci_pipelines_on_project_id_and_sha", :using=>:btree})
                 -> 0.0036s
              -- add_index("ci_pipelines", ["project_id"], {:name=>"index_ci_pipelines_on_project_id", :using=>:btree})
                 -> 0.0027s
              -- add_index("ci_pipelines", ["status"], {:name=>"index_ci_pipelines_on_status", :using=>:btree})
                 -> 0.0036s
              -- add_index("ci_pipelines", ["user_id"], {:name=>"index_ci_pipelines_on_user_id", :using=>:btree})
                 -> 0.0031s
              -- create_table("ci_runner_namespaces", {:force=>:cascade})
                 -> 0.0039s
              -- add_index("ci_runner_namespaces", ["namespace_id"], {:name=>"index_ci_runner_namespaces_on_namespace_id", :using=>:btree})
                 -> 0.0029s
              -- add_index("ci_runner_namespaces", ["runner_id", "namespace_id"], {:name=>"index_ci_runner_namespaces_on_runner_id_and_namespace_id", :unique=>true, :using=>:btree})
                 -> 0.0032s
              -- create_table("ci_runner_projects", {:force=>:cascade})
                 -> 0.0043s
              -- add_index("ci_runner_projects", ["project_id"], {:name=>"index_ci_runner_projects_on_project_id", :using=>:btree})
                 -> 0.0041s
              -- add_index("ci_runner_projects", ["runner_id"], {:name=>"index_ci_runner_projects_on_runner_id", :using=>:btree})
                 -> 0.0025s
              -- create_table("ci_runners", {:force=>:cascade})
                 -> 0.0060s
              -- add_index("ci_runners", ["contacted_at"], {:name=>"index_ci_runners_on_contacted_at", :using=>:btree})
                 -> 0.0035s
              -- add_index("ci_runners", ["is_shared"], {:name=>"index_ci_runners_on_is_shared", :using=>:btree})
                 -> 0.0026s
              -- add_index("ci_runners", ["locked"], {:name=>"index_ci_runners_on_locked", :using=>:btree})
                 -> 0.0027s
              -- add_index("ci_runners", ["token"], {:name=>"index_ci_runners_on_token", :using=>:btree})
                 -> 0.0031s
              -- create_table("ci_stages", {:force=>:cascade})
                 -> 0.0052s
              -- add_index("ci_stages", ["pipeline_id", "name"], {:name=>"index_ci_stages_on_pipeline_id_and_name", :unique=>true, :using=>:btree})
                 -> 0.0029s
              -- add_index("ci_stages", ["pipeline_id"], {:name=>"index_ci_stages_on_pipeline_id", :using=>:btree})
                 -> 0.0028s
              -- add_index("ci_stages", ["project_id"], {:name=>"index_ci_stages_on_project_id", :using=>:btree})
                 -> 0.0030s
              -- create_table("ci_trigger_requests", {:force=>:cascade})
                 -> 0.0041s
              -- add_index("ci_trigger_requests", ["commit_id"], {:name=>"index_ci_trigger_requests_on_commit_id", :using=>:btree})
                 -> 0.0031s
              -- create_table("ci_triggers", {:force=>:cascade})
                 -> 0.0048s
              -- add_index("ci_triggers", ["project_id"], {:name=>"index_ci_triggers_on_project_id", :using=>:btree})
                 -> 0.0028s
              -- create_table("ci_variables", {:force=>:cascade})
                 -> 0.0053s
              -- add_index("ci_variables", ["project_id", "key", "environment_scope"], {:name=>"index_ci_variables_on_project_id_and_key_and_environment_scope", :unique=>true, :using=>:btree})
                 -> 0.0039s
              -- create_table("cluster_platforms_kubernetes", {:force=>:cascade})
                 -> 0.0045s
              -- add_index("cluster_platforms_kubernetes", ["cluster_id"], {:name=>"index_cluster_platforms_kubernetes_on_cluster_id", :unique=>true, :using=>:btree})
                 -> 0.0029s
              -- create_table("cluster_projects", {:force=>:cascade})
                 -> 0.0029s
              -- add_index("cluster_projects", ["cluster_id"], {:name=>"index_cluster_projects_on_cluster_id", :using=>:btree})
                 -> 0.0027s
              -- add_index("cluster_projects", ["project_id"], {:name=>"index_cluster_projects_on_project_id", :using=>:btree})
                 -> 0.0026s
              -- create_table("cluster_providers_gcp", {:force=>:cascade})
                 -> 0.0044s
              -- add_index("cluster_providers_gcp", ["cluster_id"], {:name=>"index_cluster_providers_gcp_on_cluster_id", :unique=>true, :using=>:btree})
                 -> 0.0026s
              -- create_table("clusters", {:force=>:cascade})
                 -> 0.0057s
              -- add_index("clusters", ["enabled"], {:name=>"index_clusters_on_enabled", :using=>:btree})
                 -> 0.0030s
              -- add_index("clusters", ["user_id"], {:name=>"index_clusters_on_user_id", :using=>:btree})
                 -> 0.0027s
              -- create_table("clusters_applications_helm", {:force=>:cascade})
                 -> 0.0042s
              -- create_table("clusters_applications_ingress", {:force=>:cascade})
                 -> 0.0042s
              -- create_table("clusters_applications_prometheus", {:force=>:cascade})
                 -> 0.0047s
              -- create_table("clusters_applications_runners", {:force=>:cascade})
                 -> 0.0041s
              -- add_index("clusters_applications_runners", ["cluster_id"], {:name=>"index_clusters_applications_runners_on_cluster_id", :unique=>true, :using=>:btree})
                 -> 0.0027s
              -- add_index("clusters_applications_runners", ["runner_id"], {:name=>"index_clusters_applications_runners_on_runner_id", :using=>:btree})
                 -> 0.0028s
              -- create_table("container_repositories", {:force=>:cascade})
                 -> 0.0044s
              -- add_index("container_repositories", ["project_id", "name"], {:name=>"index_container_repositories_on_project_id_and_name", :unique=>true, :using=>:btree})
                 -> 0.0034s
              -- add_index("container_repositories", ["project_id"], {:name=>"index_container_repositories_on_project_id", :using=>:btree})
                 -> 0.0030s
              -- create_table("conversational_development_index_metrics", {:force=>:cascade})
                 -> 0.0060s
              -- create_table("deploy_keys_projects", {:force=>:cascade})
                 -> 0.0041s
              -- add_index("deploy_keys_projects", ["project_id"], {:name=>"index_deploy_keys_projects_on_project_id", :using=>:btree})
                 -> 0.0029s
              -- create_table("deploy_tokens", {:force=>:cascade})
                 -> 0.0058s
              -- add_index("deploy_tokens", ["token", "expires_at", "id"], {:name=>"index_deploy_tokens_on_token_and_expires_at_and_id", :where=>"(revoked IS FALSE)", :using=>:btree})
                 -> 0.0031s
              -- add_index("deploy_tokens", ["token"], {:name=>"index_deploy_tokens_on_token", :unique=>true, :using=>:btree})
                 -> 0.0030s
              -- create_table("deployments", {:force=>:cascade})
                 -> 0.0058s
              -- add_index("deployments", ["created_at"], {:name=>"index_deployments_on_created_at", :using=>:btree})
                 -> 0.0026s
              -- add_index("deployments", ["environment_id", "id"], {:name=>"index_deployments_on_environment_id_and_id", :using=>:btree})
                 -> 0.0027s
              -- add_index("deployments", ["environment_id", "iid", "project_id"], {:name=>"index_deployments_on_environment_id_and_iid_and_project_id", :using=>:btree})
                 -> 0.0031s
              -- add_index("deployments", ["project_id", "iid"], {:name=>"index_deployments_on_project_id_and_iid", :unique=>true, :using=>:btree})
                 -> 0.0033s
              -- create_table("emails", {:force=>:cascade})
                 -> 0.0052s
              -- add_index("emails", ["confirmation_token"], {:name=>"index_emails_on_confirmation_token", :unique=>true, :using=>:btree})
                 -> 0.0028s
              -- add_index("emails", ["email"], {:name=>"index_emails_on_email", :unique=>true, :using=>:btree})
                 -> 0.0037s
              -- add_index("emails", ["user_id"], {:name=>"index_emails_on_user_id", :using=>:btree})
                 -> 0.0039s
              -- create_table("environments", {:force=>:cascade})
                 -> 0.0118s
              -- add_index("environments", ["project_id", "name"], {:name=>"index_environments_on_project_id_and_name", :unique=>true, :using=>:btree})
                 -> 0.0080s
              -- add_index("environments", ["project_id", "slug"], {:name=>"index_environments_on_project_id_and_slug", :unique=>true, :using=>:btree})
                 -> 0.0073s
              -- create_table("events", {:force=>:cascade})
                 -> 0.0100s
              -- add_index("events", ["action"], {:name=>"index_events_on_action", :using=>:btree})
                 -> 0.0050s
              -- add_index("events", ["author_id", "project_id"], {:name=>"index_events_on_author_id_and_project_id", :using=>:btree})
                 -> 0.0039s
              -- add_index("events", ["project_id", "id"], {:name=>"index_events_on_project_id_and_id", :using=>:btree})
                 -> 0.0040s
              -- add_index("events", ["target_type", "target_id"], {:name=>"index_events_on_target_type_and_target_id", :using=>:btree})
                 -> 0.0033s
              -- create_table("feature_gates", {:force=>:cascade})
                 -> 0.0054s
              -- add_index("feature_gates", ["feature_key", "key", "value"], {:name=>"index_feature_gates_on_feature_key_and_key_and_value", :unique=>true, :using=>:btree})
                 -> 0.0030s
              -- create_table("features", {:force=>:cascade})
                 -> 0.0046s
              -- add_index("features", ["key"], {:name=>"index_features_on_key", :unique=>true, :using=>:btree})
                 -> 0.0030s
              -- create_table("fork_network_members", {:force=>:cascade})
                 -> 0.0034s
              -- add_index("fork_network_members", ["fork_network_id"], {:name=>"index_fork_network_members_on_fork_network_id", :using=>:btree})
                 -> 0.0064s
              -- add_index("fork_network_members", ["project_id"], {:name=>"index_fork_network_members_on_project_id", :unique=>true, :using=>:btree})
                 -> 0.0035s
              -- create_table("fork_networks", {:force=>:cascade})
                 -> 0.0043s
              -- add_index("fork_networks", ["root_project_id"], {:name=>"index_fork_networks_on_root_project_id", :unique=>true, :using=>:btree})
                 -> 0.0030s
              -- create_table("forked_project_links", {:force=>:cascade})
                 -> 0.0047s
              -- add_index("forked_project_links", ["forked_to_project_id"], {:name=>"index_forked_project_links_on_forked_to_project_id", :unique=>true, :using=>:btree})
                 -> 0.0031s
              -- create_table("gcp_clusters", {:force=>:cascade})
                 -> 0.0051s
              -- add_index("gcp_clusters", ["project_id"], {:name=>"index_gcp_clusters_on_project_id", :unique=>true, :using=>:btree})
                 -> 0.0030s
              -- create_table("gpg_key_subkeys", {:force=>:cascade})
                 -> 0.0045s
              -- add_index("gpg_key_subkeys", ["fingerprint"], {:name=>"index_gpg_key_subkeys_on_fingerprint", :unique=>true, :using=>:btree})
                 -> 0.0031s
              -- add_index("gpg_key_subkeys", ["gpg_key_id"], {:name=>"index_gpg_key_subkeys_on_gpg_key_id", :using=>:btree})
                 -> 0.0033s
              -- add_index("gpg_key_subkeys", ["keyid"], {:name=>"index_gpg_key_subkeys_on_keyid", :unique=>true, :using=>:btree})
                 -> 0.0029s
              -- create_table("gpg_keys", {:force=>:cascade})
                 -> 0.0050s
              -- add_index("gpg_keys", ["fingerprint"], {:name=>"index_gpg_keys_on_fingerprint", :unique=>true, :using=>:btree})
                 -> 0.0046s
              -- add_index("gpg_keys", ["primary_keyid"], {:name=>"index_gpg_keys_on_primary_keyid", :unique=>true, :using=>:btree})
                 -> 0.0029s
              -- add_index("gpg_keys", ["user_id"], {:name=>"index_gpg_keys_on_user_id", :using=>:btree})
                 -> 0.0032s
              -- create_table("gpg_signatures", {:force=>:cascade})
                 -> 0.0060s
              -- add_index("gpg_signatures", ["commit_sha"], {:name=>"index_gpg_signatures_on_commit_sha", :unique=>true, :using=>:btree})
                 -> 0.0037s
              -- add_index("gpg_signatures", ["gpg_key_id"], {:name=>"index_gpg_signatures_on_gpg_key_id", :using=>:btree})
                 -> 0.0039s
              -- add_index("gpg_signatures", ["gpg_key_primary_keyid"], {:name=>"index_gpg_signatures_on_gpg_key_primary_keyid", :using=>:btree})
                 -> 0.0040s
              -- add_index("gpg_signatures", ["gpg_key_subkey_id"], {:name=>"index_gpg_signatures_on_gpg_key_subkey_id", :using=>:btree})
                 -> 0.0048s
              -- add_index("gpg_signatures", ["project_id"], {:name=>"index_gpg_signatures_on_project_id", :using=>:btree})
                 -> 0.0031s
              -- create_table("group_custom_attributes", {:force=>:cascade})
                 -> 0.0043s
              -- add_index("group_custom_attributes", ["group_id", "key"], {:name=>"index_group_custom_attributes_on_group_id_and_key", :unique=>true, :using=>:btree})
                 -> 0.0032s
              -- add_index("group_custom_attributes", ["key", "value"], {:name=>"index_group_custom_attributes_on_key_and_value", :using=>:btree})
                 -> 0.0044s
              -- create_table("identities", {:force=>:cascade})
                 -> 0.0051s
              -- add_index("identities", ["user_id"], {:name=>"index_identities_on_user_id", :using=>:btree})
                 -> 0.0036s
              -- create_table("internal_ids", {:id=>:bigserial, :force=>:cascade})
                 -> 0.0029s
              -- add_index("internal_ids", ["usage", "namespace_id"], {:name=>"index_internal_ids_on_usage_and_namespace_id", :unique=>true, :where=>"(namespace_id IS NOT NULL)", :using=>:btree})
                 -> 0.0037s
              -- add_index("internal_ids", ["usage", "project_id"], {:name=>"index_internal_ids_on_usage_and_project_id", :unique=>true, :where=>"(project_id IS NOT NULL)", :using=>:btree})
                 -> 0.0035s
              -- create_table("issue_assignees", {:id=>false, :force=>:cascade})
                 -> 0.0013s
              -- add_index("issue_assignees", ["issue_id", "user_id"], {:name=>"index_issue_assignees_on_issue_id_and_user_id", :unique=>true, :using=>:btree})
                 -> 0.0034s
              -- add_index("issue_assignees", ["user_id"], {:name=>"index_issue_assignees_on_user_id", :using=>:btree})
                 -> 0.0031s
              -- create_table("issue_metrics", {:force=>:cascade})
                 -> 0.0037s
              -- add_index("issue_metrics", ["issue_id"], {:name=>"index_issue_metrics", :using=>:btree})
                 -> 0.0036s
              -- create_table("issues", {:force=>:cascade})
                 -> 0.0054s
              -- add_index("issues", ["author_id"], {:name=>"index_issues_on_author_id", :using=>:btree})
                 -> 0.0032s
              -- add_index("issues", ["confidential"], {:name=>"index_issues_on_confidential", :using=>:btree})
                 -> 0.0027s
              -- add_index("issues", ["description"], {:name=>"index_issues_on_description_trigram", :using=>:gin, :opclasses=>{"description"=>"gin_trgm_ops"}})
                 -> 0.0036s
              -- add_index("issues", ["milestone_id"], {:name=>"index_issues_on_milestone_id", :using=>:btree})
                 -> 0.0034s
              -- add_index("issues", ["moved_to_id"], {:name=>"index_issues_on_moved_to_id", :where=>"(moved_to_id IS NOT NULL)", :using=>:btree})
                 -> 0.0028s
              -- add_index("issues", ["project_id", "created_at", "id", "state"], {:name=>"index_issues_on_project_id_and_created_at_and_id_and_state", :using=>:btree})
                 -> 0.0043s
              -- add_index("issues", ["project_id", "due_date", "id", "state"], {:name=>"idx_issues_on_project_id_and_due_date_and_id_and_state_partial", :where=>"(due_date IS NOT NULL)", :using=>:btree})
                 -> 0.0072s
              -- add_index("issues", ["project_id", "iid"], {:name=>"index_issues_on_project_id_and_iid", :unique=>true, :using=>:btree})
                 -> 0.0052s
              -- add_index("issues", ["project_id", "updated_at", "id", "state"], {:name=>"index_issues_on_project_id_and_updated_at_and_id_and_state", :using=>:btree})
                 -> 0.0039s
              -- add_index("issues", ["relative_position"], {:name=>"index_issues_on_relative_position", :using=>:btree})
                 -> 0.0039s
              -- add_index("issues", ["state"], {:name=>"index_issues_on_state", :using=>:btree})
                 -> 0.0035s
              -- add_index("issues", ["title"], {:name=>"index_issues_on_title_trigram", :using=>:gin, :opclasses=>{"title"=>"gin_trgm_ops"}})
                 -> 0.0021s
              -- add_index("issues", ["updated_at"], {:name=>"index_issues_on_updated_at", :using=>:btree})
                 -> 0.0035s
              -- add_index("issues", ["updated_by_id"], {:name=>"index_issues_on_updated_by_id", :where=>"(updated_by_id IS NOT NULL)", :using=>:btree})
                 -> 0.0030s
              -- create_table("keys", {:force=>:cascade})
                 -> 0.0061s
              -- add_index("keys", ["fingerprint"], {:name=>"index_keys_on_fingerprint", :unique=>true, :using=>:btree})
                 -> 0.0035s
              -- add_index("keys", ["user_id"], {:name=>"index_keys_on_user_id", :using=>:btree})
                 -> 0.0033s
              -- create_table("label_links", {:force=>:cascade})
                 -> 0.0044s
              -- add_index("label_links", ["label_id"], {:name=>"index_label_links_on_label_id", :using=>:btree})
                 -> 0.0038s
              -- add_index("label_links", ["target_id", "target_type"], {:name=>"index_label_links_on_target_id_and_target_type", :using=>:btree})
                 -> 0.0038s
              -- create_table("label_priorities", {:force=>:cascade})
                 -> 0.0030s
              -- add_index("label_priorities", ["priority"], {:name=>"index_label_priorities_on_priority", :using=>:btree})
                 -> 0.0038s
              -- add_index("label_priorities", ["project_id", "label_id"], {:name=>"index_label_priorities_on_project_id_and_label_id", :unique=>true, :using=>:btree})
                 -> 0.0069s
              -- create_table("labels", {:force=>:cascade})
                 -> 0.0071s
              -- add_index("labels", ["group_id", "project_id", "title"], {:name=>"index_labels_on_group_id_and_project_id_and_title", :unique=>true, :using=>:btree})
                 -> 0.0038s
              -- add_index("labels", ["project_id"], {:name=>"index_labels_on_project_id", :using=>:btree})
                 -> 0.0040s
              -- add_index("labels", ["template"], {:name=>"index_labels_on_template", :where=>"template", :using=>:btree})
                 -> 0.0037s
              -- add_index("labels", ["title"], {:name=>"index_labels_on_title", :using=>:btree})
                 -> 0.0027s
              -- add_index("labels", ["type", "project_id"], {:name=>"index_labels_on_type_and_project_id", :using=>:btree})
                 -> 0.0028s
              -- create_table("lfs_file_locks", {:force=>:cascade})
                 -> 0.0044s
              -- add_index("lfs_file_locks", ["project_id", "path"], {:name=>"index_lfs_file_locks_on_project_id_and_path", :unique=>true, :using=>:btree})
                 -> 0.0033s
              -- add_index("lfs_file_locks", ["user_id"], {:name=>"index_lfs_file_locks_on_user_id", :using=>:btree})
                 -> 0.0041s
              -- create_table("lfs_objects", {:force=>:cascade})
                 -> 0.0052s
              -- add_index("lfs_objects", ["oid"], {:name=>"index_lfs_objects_on_oid", :unique=>true, :using=>:btree})
                 -> 0.0072s
              -- create_table("lfs_objects_projects", {:force=>:cascade})
                 -> 0.0033s
              -- add_index("lfs_objects_projects", ["project_id"], {:name=>"index_lfs_objects_projects_on_project_id", :using=>:btree})
                 -> 0.0038s
              -- create_table("lists", {:force=>:cascade})
                 -> 0.0040s
              -- add_index("lists", ["board_id", "label_id"], {:name=>"index_lists_on_board_id_and_label_id", :unique=>true, :using=>:btree})
                 -> 0.0030s
              -- add_index("lists", ["label_id"], {:name=>"index_lists_on_label_id", :using=>:btree})
                 -> 0.0045s
              -- create_table("members", {:force=>:cascade})
                 -> 0.0044s
              -- add_index("members", ["access_level"], {:name=>"index_members_on_access_level", :using=>:btree})
                 -> 0.0028s
              -- add_index("members", ["invite_token"], {:name=>"index_members_on_invite_token", :unique=>true, :using=>:btree})
                 -> 0.0027s
              -- add_index("members", ["requested_at"], {:name=>"index_members_on_requested_at", :using=>:btree})
                 -> 0.0029s
              -- add_index("members", ["source_id", "source_type"], {:name=>"index_members_on_source_id_and_source_type", :using=>:btree})
                 -> 0.0033s
              -- add_index("members", ["user_id"], {:name=>"index_members_on_user_id", :using=>:btree})
                 -> 0.0036s
              -- create_table("merge_request_diff_commits", {:id=>false, :force=>:cascade})
                 -> 0.0062s
              -- add_index("merge_request_diff_commits", ["merge_request_diff_id", "relative_order"], {:name=>"index_merge_request_diff_commits_on_mr_diff_id_and_order", :unique=>true, :using=>:btree})
                 -> 0.0044s
              -- add_index("merge_request_diff_commits", ["sha"], {:name=>"index_merge_request_diff_commits_on_sha", :using=>:btree})
                 -> 0.0028s
              -- create_table("merge_request_diff_files", {:id=>false, :force=>:cascade})
                 -> 0.0026s
              -- add_index("merge_request_diff_files", ["merge_request_diff_id", "relative_order"], {:name=>"index_merge_request_diff_files_on_mr_diff_id_and_order", :unique=>true, :using=>:btree})
                 -> 0.0028s
              -- create_table("merge_request_diffs", {:force=>:cascade})
                 -> 0.0064s
              -- add_index("merge_request_diffs", ["merge_request_id", "id"], {:name=>"index_merge_request_diffs_on_merge_request_id_and_id", :using=>:btree})
                 -> 0.0033s
              -- create_table("merge_request_metrics", {:force=>:cascade})
                 -> 0.0027s
              -- add_index("merge_request_metrics", ["first_deployed_to_production_at"], {:name=>"index_merge_request_metrics_on_first_deployed_to_production_at", :using=>:btree})
                 -> 0.0043s
              -- add_index("merge_request_metrics", ["merge_request_id"], {:name=>"index_merge_request_metrics", :using=>:btree})
                 -> 0.0067s
              -- add_index("merge_request_metrics", ["pipeline_id"], {:name=>"index_merge_request_metrics_on_pipeline_id", :using=>:btree})
                 -> 0.0032s
              -- create_table("merge_requests", {:force=>:cascade})
                 -> 0.0062s
              -- add_index("merge_requests", ["assignee_id"], {:name=>"index_merge_requests_on_assignee_id", :using=>:btree})
                 -> 0.0029s
              -- add_index("merge_requests", ["author_id"], {:name=>"index_merge_requests_on_author_id", :using=>:btree})
                 -> 0.0028s
              -- add_index("merge_requests", ["created_at"], {:name=>"index_merge_requests_on_created_at", :using=>:btree})
                 -> 0.0035s
              -- add_index("merge_requests", ["description"], {:name=>"index_merge_requests_on_description_trigram", :using=>:gin, :opclasses=>{"description"=>"gin_trgm_ops"}})
                 -> 0.0020s
              -- add_index("merge_requests", ["head_pipeline_id"], {:name=>"index_merge_requests_on_head_pipeline_id", :using=>:btree})
                 -> 0.0033s
              -- add_index("merge_requests", ["latest_merge_request_diff_id"], {:name=>"index_merge_requests_on_latest_merge_request_diff_id", :using=>:btree})
                 -> 0.0030s
              -- add_index("merge_requests", ["merge_user_id"], {:name=>"index_merge_requests_on_merge_user_id", :where=>"(merge_user_id IS NOT NULL)", :using=>:btree})
                 -> 0.0035s
              -- add_index("merge_requests", ["milestone_id"], {:name=>"index_merge_requests_on_milestone_id", :using=>:btree})
                 -> 0.0035s
              -- add_index("merge_requests", ["source_branch"], {:name=>"index_merge_requests_on_source_branch", :using=>:btree})
                 -> 0.0033s
              -- add_index("merge_requests", ["source_project_id", "source_branch"], {:name=>"index_merge_requests_on_source_project_and_branch_state_opened", :where=>"((state)::text = 'opened'::text)", :using=>:btree})
                 -> 0.0028s
              -- add_index("merge_requests", ["source_project_id", "source_branch"], {:name=>"index_merge_requests_on_source_project_id_and_source_branch", :using=>:btree})
                 -> 0.0025s
              -- add_index("merge_requests", ["target_branch"], {:name=>"index_merge_requests_on_target_branch", :using=>:btree})
                 -> 0.0034s
              -- add_index("merge_requests", ["target_project_id", "iid"], {:name=>"index_merge_requests_on_target_project_id_and_iid", :unique=>true, :using=>:btree})
                 -> 0.0033s
              -- add_index("merge_requests", ["target_project_id", "merge_commit_sha", "id"], {:name=>"index_merge_requests_on_tp_id_and_merge_commit_sha_and_id", :using=>:btree})
                 -> 0.0028s
              -- add_index("merge_requests", ["title"], {:name=>"index_merge_requests_on_title", :using=>:btree})
                 -> 0.0029s
              -- add_index("merge_requests", ["title"], {:name=>"index_merge_requests_on_title_trigram", :using=>:gin, :opclasses=>{"title"=>"gin_trgm_ops"}})
                 -> 0.0017s
              -- add_index("merge_requests", ["updated_by_id"], {:name=>"index_merge_requests_on_updated_by_id", :where=>"(updated_by_id IS NOT NULL)", :using=>:btree})
                 -> 0.0029s
              -- create_table("merge_requests_closing_issues", {:force=>:cascade})
                 -> 0.0042s
              -- add_index("merge_requests_closing_issues", ["issue_id"], {:name=>"index_merge_requests_closing_issues_on_issue_id", :using=>:btree})
                 -> 0.0026s
              -- add_index("merge_requests_closing_issues", ["merge_request_id"], {:name=>"index_merge_requests_closing_issues_on_merge_request_id", :using=>:btree})
                 -> 0.0025s
              -- create_table("milestones", {:force=>:cascade})
                 -> 0.0046s
              -- add_index("milestones", ["description"], {:name=>"index_milestones_on_description_trigram", :using=>:gin, :opclasses=>{"description"=>"gin_trgm_ops"}})
                 -> 0.0019s
              -- add_index("milestones", ["due_date"], {:name=>"index_milestones_on_due_date", :using=>:btree})
                 -> 0.0028s
              -- add_index("milestones", ["group_id"], {:name=>"index_milestones_on_group_id", :using=>:btree})
                 -> 0.0026s
              -- add_index("milestones", ["project_id", "iid"], {:name=>"index_milestones_on_project_id_and_iid", :unique=>true, :using=>:btree})
                 -> 0.0028s
              -- add_index("milestones", ["title"], {:name=>"index_milestones_on_title", :using=>:btree})
                 -> 0.0038s
              -- add_index("milestones", ["title"], {:name=>"index_milestones_on_title_trigram", :using=>:gin, :opclasses=>{"title"=>"gin_trgm_ops"}})
                 -> 0.0019s
              -- create_table("namespaces", {:force=>:cascade})
                 -> 0.0065s
              -- add_index("namespaces", ["created_at"], {:name=>"index_namespaces_on_created_at", :using=>:btree})
                 -> 0.0030s
              -- add_index("namespaces", ["name", "parent_id"], {:name=>"index_namespaces_on_name_and_parent_id", :unique=>true, :using=>:btree})
                 -> 0.0032s
              -- add_index("namespaces", ["name"], {:name=>"index_namespaces_on_name_trigram", :using=>:gin, :opclasses=>{"name"=>"gin_trgm_ops"}})
                 -> 0.0018s
              -- add_index("namespaces", ["owner_id"], {:name=>"index_namespaces_on_owner_id", :using=>:btree})
                 -> 0.0036s
              -- add_index("namespaces", ["parent_id", "id"], {:name=>"index_namespaces_on_parent_id_and_id", :unique=>true, :using=>:btree})
                 -> 0.0027s
              -- add_index("namespaces", ["path"], {:name=>"index_namespaces_on_path", :using=>:btree})
                 -> 0.0028s
              -- add_index("namespaces", ["path"], {:name=>"index_namespaces_on_path_trigram", :using=>:gin, :opclasses=>{"path"=>"gin_trgm_ops"}})
                 -> 0.0021s
              -- add_index("namespaces", ["require_two_factor_authentication"], {:name=>"index_namespaces_on_require_two_factor_authentication", :using=>:btree})
                 -> 0.0036s
              -- add_index("namespaces", ["runners_token"], {:name=>"index_namespaces_on_runners_token", :unique=>true, :using=>:btree})
                 -> 0.0035s
              -- add_index("namespaces", ["type"], {:name=>"index_namespaces_on_type", :using=>:btree})
                 -> 0.0034s
              -- create_table("notes", {:force=>:cascade})
                 -> 0.0058s
              -- add_index("notes", ["author_id"], {:name=>"index_notes_on_author_id", :using=>:btree})
                 -> 0.0037s
              -- add_index("notes", ["commit_id"], {:name=>"index_notes_on_commit_id", :using=>:btree})
                 -> 0.0123s
              -- add_index("notes", ["created_at"], {:name=>"index_notes_on_created_at", :using=>:btree})
                 -> 0.0042s
              -- add_index("notes", ["discussion_id"], {:name=>"index_notes_on_discussion_id", :using=>:btree})
                 -> 0.0037s
              -- add_index("notes", ["line_code"], {:name=>"index_notes_on_line_code", :using=>:btree})
                 -> 0.0027s
              -- add_index("notes", ["note"], {:name=>"index_notes_on_note_trigram", :using=>:gin, :opclasses=>{"note"=>"gin_trgm_ops"}})
                 -> 0.0017s
              -- add_index("notes", ["noteable_id", "noteable_type"], {:name=>"index_notes_on_noteable_id_and_noteable_type", :using=>:btree})
                 -> 0.0027s
              -- add_index("notes", ["noteable_type"], {:name=>"index_notes_on_noteable_type", :using=>:btree})
                 -> 0.0031s
              -- add_index("notes", ["project_id", "noteable_type"], {:name=>"index_notes_on_project_id_and_noteable_type", :using=>:btree})
                 -> 0.0038s
              -- add_index("notes", ["updated_at"], {:name=>"index_notes_on_updated_at", :using=>:btree})
                 -> 0.0028s
              -- create_table("notification_settings", {:force=>:cascade})
                 -> 0.0050s
              -- add_index("notification_settings", ["source_id", "source_type"], {:name=>"index_notification_settings_on_source_id_and_source_type", :using=>:btree})
                 -> 0.0041s
              -- add_index("notification_settings", ["user_id", "source_id", "source_type"], {:name=>"index_notifications_on_user_id_and_source_id_and_source_type", :unique=>true, :using=>:btree})
                 -> 0.0039s
              -- add_index("notification_settings", ["user_id"], {:name=>"index_notification_settings_on_user_id", :using=>:btree})
                 -> 0.0033s
              -- create_table("oauth_access_grants", {:force=>:cascade})
                 -> 0.0052s
              -- add_index("oauth_access_grants", ["token"], {:name=>"index_oauth_access_grants_on_token", :unique=>true, :using=>:btree})
                 -> 0.0030s
              -- create_table("oauth_access_tokens", {:force=>:cascade})
                 -> 0.0044s
              -- add_index("oauth_access_tokens", ["refresh_token"], {:name=>"index_oauth_access_tokens_on_refresh_token", :unique=>true, :using=>:btree})
                 -> 0.0032s
              -- add_index("oauth_access_tokens", ["resource_owner_id"], {:name=>"index_oauth_access_tokens_on_resource_owner_id", :using=>:btree})
                 -> 0.0028s
              -- add_index("oauth_access_tokens", ["token"], {:name=>"index_oauth_access_tokens_on_token", :unique=>true, :using=>:btree})
                 -> 0.0029s
              -- create_table("oauth_applications", {:force=>:cascade})
                 -> 0.0057s
              -- add_index("oauth_applications", ["owner_id", "owner_type"], {:name=>"index_oauth_applications_on_owner_id_and_owner_type", :using=>:btree})
                 -> 0.0032s
              -- add_index("oauth_applications", ["uid"], {:name=>"index_oauth_applications_on_uid", :unique=>true, :using=>:btree})
                 -> 0.0033s
              -- create_table("oauth_openid_requests", {:force=>:cascade})
                 -> 0.0055s
              -- create_table("pages_domains", {:force=>:cascade})
                 -> 0.0081s
              -- add_index("pages_domains", ["domain"], {:name=>"index_pages_domains_on_domain", :unique=>true, :using=>:btree})
                 -> 0.0027s
              -- add_index("pages_domains", ["project_id", "enabled_until"], {:name=>"index_pages_domains_on_project_id_and_enabled_until", :using=>:btree})
                 -> 0.0029s
              -- add_index("pages_domains", ["project_id"], {:name=>"index_pages_domains_on_project_id", :using=>:btree})
                 -> 0.0035s
              -- add_index("pages_domains", ["verified_at", "enabled_until"], {:name=>"index_pages_domains_on_verified_at_and_enabled_until", :using=>:btree})
                 -> 0.0029s
              -- add_index("pages_domains", ["verified_at"], {:name=>"index_pages_domains_on_verified_at", :using=>:btree})
                 -> 0.0024s
              -- create_table("personal_access_tokens", {:force=>:cascade})
                 -> 0.0058s
              -- add_index("personal_access_tokens", ["token"], {:name=>"index_personal_access_tokens_on_token", :unique=>true, :using=>:btree})
                 -> 0.0036s
              -- add_index("personal_access_tokens", ["user_id"], {:name=>"index_personal_access_tokens_on_user_id", :using=>:btree})
                 -> 0.0030s
              -- create_table("project_authorizations", {:id=>false, :force=>:cascade})
                 -> 0.0012s
              -- add_index("project_authorizations", ["project_id"], {:name=>"index_project_authorizations_on_project_id", :using=>:btree})
                 -> 0.0031s
              -- add_index("project_authorizations", ["user_id", "project_id", "access_level"], {:name=>"index_project_authorizations_on_user_id_project_id_access_level", :unique=>true, :using=>:btree})
                 -> 0.0030s
              -- create_table("project_auto_devops", {:force=>:cascade})
                 -> 0.0047s
              -- add_index("project_auto_devops", ["project_id"], {:name=>"index_project_auto_devops_on_project_id", :unique=>true, :using=>:btree})
                 -> 0.0040s
              -- create_table("project_ci_cd_settings", {:force=>:cascade})
                 -> 0.0032s
              -- add_index("project_ci_cd_settings", ["project_id"], {:name=>"index_project_ci_cd_settings_on_project_id", :unique=>true, :using=>:btree})
                 -> 0.0025s
              -- create_table("project_custom_attributes", {:force=>:cascade})
                 -> 0.0053s
              -- add_index("project_custom_attributes", ["key", "value"], {:name=>"index_project_custom_attributes_on_key_and_value", :using=>:btree})
                 -> 0.0031s
              -- add_index("project_custom_attributes", ["project_id", "key"], {:name=>"index_project_custom_attributes_on_project_id_and_key", :unique=>true, :using=>:btree})
                 -> 0.0029s
              -- create_table("project_deploy_tokens", {:force=>:cascade})
                 -> 0.0029s
              -- add_index("project_deploy_tokens", ["project_id", "deploy_token_id"], {:name=>"index_project_deploy_tokens_on_project_id_and_deploy_token_id", :unique=>true, :using=>:btree})
                 -> 0.0043s
              -- create_table("project_features", {:force=>:cascade})
                 -> 0.0054s
              -- add_index("project_features", ["project_id"], {:name=>"index_project_features_on_project_id", :using=>:btree})
                 -> 0.0035s
              -- create_table("project_group_links", {:force=>:cascade})
                 -> 0.0035s
              -- add_index("project_group_links", ["group_id"], {:name=>"index_project_group_links_on_group_id", :using=>:btree})
                 -> 0.0034s
              -- add_index("project_group_links", ["project_id"], {:name=>"index_project_group_links_on_project_id", :using=>:btree})
                 -> 0.0041s
              -- create_table("project_import_data", {:force=>:cascade})
                 -> 0.0049s
              -- add_index("project_import_data", ["project_id"], {:name=>"index_project_import_data_on_project_id", :using=>:btree})
                 -> 0.0034s
              -- create_table("project_mirror_data", {:force=>:cascade})
                 -> 0.0041s
              -- add_index("project_mirror_data", ["jid"], {:name=>"index_project_mirror_data_on_jid", :using=>:btree})
                 -> 0.0024s
              -- add_index("project_mirror_data", ["project_id"], {:name=>"index_project_mirror_data_on_project_id", :unique=>true, :using=>:btree})
                 -> 0.0033s
              -- add_index("project_mirror_data", ["status"], {:name=>"index_project_mirror_data_on_status", :using=>:btree})
                 -> 0.0030s
              -- create_table("project_statistics", {:force=>:cascade})
                 -> 0.0044s
              -- add_index("project_statistics", ["namespace_id"], {:name=>"index_project_statistics_on_namespace_id", :using=>:btree})
                 -> 0.0027s
              -- add_index("project_statistics", ["project_id"], {:name=>"index_project_statistics_on_project_id", :unique=>true, :using=>:btree})
                 -> 0.0029s
              -- create_table("projects", {:force=>:cascade})
                 -> 0.0089s
              -- add_index("projects", ["ci_id"], {:name=>"index_projects_on_ci_id", :using=>:btree})
                 -> 0.0027s
              -- add_index("projects", ["created_at"], {:name=>"index_projects_on_created_at", :using=>:btree})
                 -> 0.0035s
              -- add_index("projects", ["creator_id"], {:name=>"index_projects_on_creator_id", :using=>:btree})
                 -> 0.0030s
              -- add_index("projects", ["description"], {:name=>"index_projects_on_description_trigram", :using=>:gin, :opclasses=>{"description"=>"gin_trgm_ops"}})
                 -> 0.0020s
              -- add_index("projects", ["id"], {:name=>"index_projects_on_id_partial_for_visibility", :unique=>true, :where=>"(visibility_level = ANY (ARRAY[10, 20]))", :using=>:btree})
                 -> 0.0035s
              -- add_index("projects", ["last_activity_at"], {:name=>"index_projects_on_last_activity_at", :using=>:btree})
                 -> 0.0026s
              -- add_index("projects", ["last_repository_check_failed"], {:name=>"index_projects_on_last_repository_check_failed", :using=>:btree})
                 -> 0.0027s
              -- add_index("projects", ["last_repository_updated_at"], {:name=>"index_projects_on_last_repository_updated_at", :using=>:btree})
                 -> 0.0030s
              -- add_index("projects", ["name"], {:name=>"index_projects_on_name_trigram", :using=>:gin, :opclasses=>{"name"=>"gin_trgm_ops"}})
                 -> 0.0054s
              -- add_index("projects", ["namespace_id"], {:name=>"index_projects_on_namespace_id", :using=>:btree})
                 -> 0.0037s
              -- add_index("projects", ["path"], {:name=>"index_projects_on_path", :using=>:btree})
                 -> 0.0031s
              -- add_index("projects", ["path"], {:name=>"index_projects_on_path_trigram", :using=>:gin, :opclasses=>{"path"=>"gin_trgm_ops"}})
                 -> 0.0023s
              -- add_index("projects", ["pending_delete"], {:name=>"index_projects_on_pending_delete", :using=>:btree})
                 -> 0.0029s
              -- add_index("projects", ["repository_storage"], {:name=>"index_projects_on_repository_storage", :using=>:btree})
                 -> 0.0027s
              -- add_index("projects", ["runners_token"], {:name=>"index_projects_on_runners_token", :using=>:btree})
                 -> 0.0033s
              -- add_index("projects", ["star_count"], {:name=>"index_projects_on_star_count", :using=>:btree})
                 -> 0.0040s
              -- add_index("projects", ["visibility_level"], {:name=>"index_projects_on_visibility_level", :using=>:btree})
                 -> 0.0029s
              -- create_table("protected_branch_merge_access_levels", {:force=>:cascade})
                 -> 0.0033s
              -- add_index("protected_branch_merge_access_levels", ["protected_branch_id"], {:name=>"index_protected_branch_merge_access", :using=>:btree})
                 -> 0.0036s
              -- create_table("protected_branch_push_access_levels", {:force=>:cascade})
                 -> 0.0030s
              -- add_index("protected_branch_push_access_levels", ["protected_branch_id"], {:name=>"index_protected_branch_push_access", :using=>:btree})
                 -> 0.0029s
              -- create_table("protected_branches", {:force=>:cascade})
                 -> 0.0049s
              -- add_index("protected_branches", ["project_id"], {:name=>"index_protected_branches_on_project_id", :using=>:btree})
                 -> 0.0027s
              -- create_table("protected_tag_create_access_levels", {:force=>:cascade})
                 -> 0.0033s
              -- add_index("protected_tag_create_access_levels", ["protected_tag_id"], {:name=>"index_protected_tag_create_access", :using=>:btree})
                 -> 0.0027s
              -- add_index("protected_tag_create_access_levels", ["user_id"], {:name=>"index_protected_tag_create_access_levels_on_user_id", :using=>:btree})
                 -> 0.0042s
              -- create_table("protected_tags", {:force=>:cascade})
                 -> 0.0094s
              -- add_index("protected_tags", ["project_id"], {:name=>"index_protected_tags_on_project_id", :using=>:btree})
                 -> 0.0062s
              -- create_table("push_event_payloads", {:id=>false, :force=>:cascade})
                 -> 0.0051s
              -- add_index("push_event_payloads", ["event_id"], {:name=>"index_push_event_payloads_on_event_id", :unique=>true, :using=>:btree})
                 -> 0.0040s
              -- create_table("redirect_routes", {:force=>:cascade})
                 -> 0.0049s
              -- add_index("redirect_routes", ["path"], {:name=>"index_redirect_routes_on_path", :unique=>true, :using=>:btree})
                 -> 0.0036s
              -- add_index("redirect_routes", ["source_type", "source_id"], {:name=>"index_redirect_routes_on_source_type_and_source_id", :using=>:btree})
                 -> 0.0027s
              -- create_table("releases", {:force=>:cascade})
                 -> 0.0040s
              -- add_index("releases", ["project_id", "tag"], {:name=>"index_releases_on_project_id_and_tag", :using=>:btree})
                 -> 0.0032s
              -- add_index("releases", ["project_id"], {:name=>"index_releases_on_project_id", :using=>:btree})
                 -> 0.0031s
              -- create_table("remote_mirrors", {:force=>:cascade})
                 -> 0.0055s
              -- add_index("remote_mirrors", ["last_successful_update_at"], {:name=>"index_remote_mirrors_on_last_successful_update_at", :using=>:btree})
                 -> 0.0032s
              -- add_index("remote_mirrors", ["project_id"], {:name=>"index_remote_mirrors_on_project_id", :using=>:btree})
                 -> 0.0031s
              -- create_table("routes", {:force=>:cascade})
                 -> 0.0050s
              -- add_index("routes", ["path"], {:name=>"index_routes_on_path", :unique=>true, :using=>:btree})
                 -> 0.0032s
              -- add_index("routes", ["path"], {:name=>"index_routes_on_path_text_pattern_ops", :using=>:btree, :opclasses=>{"path"=>"varchar_pattern_ops"}})
                 -> 0.0027s
              -- add_index("routes", ["source_type", "source_id"], {:name=>"index_routes_on_source_type_and_source_id", :unique=>true, :using=>:btree})
                 -> 0.0028s
              -- create_table("sent_notifications", {:force=>:cascade})
                 -> 0.0054s
              -- add_index("sent_notifications", ["reply_key"], {:name=>"index_sent_notifications_on_reply_key", :unique=>true, :using=>:btree})
                 -> 0.0036s
              -- create_table("services", {:force=>:cascade})
                 -> 0.0081s
              -- add_index("services", ["project_id"], {:name=>"index_services_on_project_id", :using=>:btree})
                 -> 0.0040s
              -- add_index("services", ["template"], {:name=>"index_services_on_template", :using=>:btree})
                 -> 0.0030s
              -- create_table("snippets", {:force=>:cascade})
                 -> 0.0051s
              -- add_index("snippets", ["author_id"], {:name=>"index_snippets_on_author_id", :using=>:btree})
                 -> 0.0037s
              -- add_index("snippets", ["file_name"], {:name=>"index_snippets_on_file_name_trigram", :using=>:gin, :opclasses=>{"file_name"=>"gin_trgm_ops"}})
                 -> 0.0021s
              -- add_index("snippets", ["project_id"], {:name=>"index_snippets_on_project_id", :using=>:btree})
                 -> 0.0031s
              -- add_index("snippets", ["title"], {:name=>"index_snippets_on_title_trigram", :using=>:gin, :opclasses=>{"title"=>"gin_trgm_ops"}})
                 -> 0.0022s
              -- add_index("snippets", ["updated_at"], {:name=>"index_snippets_on_updated_at", :using=>:btree})
                 -> 0.0029s
              -- add_index("snippets", ["visibility_level"], {:name=>"index_snippets_on_visibility_level", :using=>:btree})
                 -> 0.0028s
              -- create_table("spam_logs", {:force=>:cascade})
                 -> 0.0056s
              -- create_table("subscriptions", {:force=>:cascade})
                 -> 0.0039s
              -- add_index("subscriptions", ["subscribable_id", "subscribable_type", "user_id", "project_id"], {:name=>"index_subscriptions_on_subscribable_and_user_id_and_project_id", :unique=>true, :using=>:btree})
                 -> 0.0032s
              -- create_table("system_note_metadata", {:force=>:cascade})
                 -> 0.0044s
              -- add_index("system_note_metadata", ["note_id"], {:name=>"index_system_note_metadata_on_note_id", :unique=>true, :using=>:btree})
                 -> 0.0029s
              -- create_table("taggings", {:force=>:cascade})
                 -> 0.0046s
              -- add_index("taggings", ["tag_id", "taggable_id", "taggable_type", "context", "tagger_id", "tagger_type"], {:name=>"taggings_idx", :unique=>true, :using=>:btree})
                 -> 0.0031s
              -- add_index("taggings", ["tag_id"], {:name=>"index_taggings_on_tag_id", :using=>:btree})
                 -> 0.0026s
              -- add_index("taggings", ["taggable_id", "taggable_type", "context"], {:name=>"index_taggings_on_taggable_id_and_taggable_type_and_context", :using=>:btree})
                 -> 0.0029s
              -- add_index("taggings", ["taggable_id", "taggable_type"], {:name=>"index_taggings_on_taggable_id_and_taggable_type", :using=>:btree})
                 -> 0.0024s
              -- create_table("tags", {:force=>:cascade})
                 -> 0.0038s
              -- add_index("tags", ["name"], {:name=>"index_tags_on_name", :unique=>true, :using=>:btree})
                 -> 0.0035s
              -- create_table("term_agreements", {:force=>:cascade})
                 -> 0.0033s
              -- add_index("term_agreements", ["term_id"], {:name=>"index_term_agreements_on_term_id", :using=>:btree})
                 -> 0.0026s
              -- add_index("term_agreements", ["user_id", "term_id"], {:name=>"term_agreements_unique_index", :unique=>true, :using=>:btree})
                 -> 0.0031s
              -- add_index("term_agreements", ["user_id"], {:name=>"index_term_agreements_on_user_id", :using=>:btree})
                 -> 0.0032s
              -- create_table("timelogs", {:force=>:cascade})
                 -> 0.0029s
              -- add_index("timelogs", ["issue_id"], {:name=>"index_timelogs_on_issue_id", :using=>:btree})
                 -> 0.0027s
              -- add_index("timelogs", ["merge_request_id"], {:name=>"index_timelogs_on_merge_request_id", :using=>:btree})
                 -> 0.0028s
              -- add_index("timelogs", ["user_id"], {:name=>"index_timelogs_on_user_id", :using=>:btree})
                 -> 0.0037s
              -- create_table("todos", {:force=>:cascade})
                 -> 0.0046s
              -- add_index("todos", ["author_id"], {:name=>"index_todos_on_author_id", :using=>:btree})
                 -> 0.0028s
              -- add_index("todos", ["commit_id"], {:name=>"index_todos_on_commit_id", :using=>:btree})
                 -> 0.0028s
              -- add_index("todos", ["note_id"], {:name=>"index_todos_on_note_id", :using=>:btree})
                 -> 0.0029s
              -- add_index("todos", ["project_id"], {:name=>"index_todos_on_project_id", :using=>:btree})
                 -> 0.0029s
              -- add_index("todos", ["target_type", "target_id"], {:name=>"index_todos_on_target_type_and_target_id", :using=>:btree})
                 -> 0.0023s
              -- add_index("todos", ["user_id", "id"], {:name=>"index_todos_on_user_id_and_id_done", :where=>"((state)::text = 'done'::text)", :using=>:btree})
                 -> 0.0080s
              -- add_index("todos", ["user_id", "id"], {:name=>"index_todos_on_user_id_and_id_pending", :where=>"((state)::text = 'pending'::text)", :using=>:btree})
                 -> 0.0028s
              -- add_index("todos", ["user_id"], {:name=>"index_todos_on_user_id", :using=>:btree})
                 -> 0.0027s
              -- create_table("trending_projects", {:force=>:cascade})
                 -> 0.0031s
              -- add_index("trending_projects", ["project_id"], {:name=>"index_trending_projects_on_project_id", :unique=>true, :using=>:btree})
                 -> 0.0034s
              -- create_table("u2f_registrations", {:force=>:cascade})
                 -> 0.0045s
              -- add_index("u2f_registrations", ["key_handle"], {:name=>"index_u2f_registrations_on_key_handle", :using=>:btree})
                 -> 0.0035s
              -- add_index("u2f_registrations", ["user_id"], {:name=>"index_u2f_registrations_on_user_id", :using=>:btree})
                 -> 0.0028s
              -- create_table("uploads", {:force=>:cascade})
                 -> 0.0078s
              -- add_index("uploads", ["checksum"], {:name=>"index_uploads_on_checksum", :using=>:btree})
                 -> 0.0042s
              -- add_index("uploads", ["model_id", "model_type"], {:name=>"index_uploads_on_model_id_and_model_type", :using=>:btree})
                 -> 0.0035s
              -- add_index("uploads", ["uploader", "path"], {:name=>"index_uploads_on_uploader_and_path", :using=>:btree})
                 -> 0.0024s
              -- create_table("user_agent_details", {:force=>:cascade})
                 -> 0.0041s
              -- add_index("user_agent_details", ["subject_id", "subject_type"], {:name=>"index_user_agent_details_on_subject_id_and_subject_type", :using=>:btree})
                 -> 0.0031s
              -- create_table("user_callouts", {:force=>:cascade})
                 -> 0.0035s
              -- add_index("user_callouts", ["user_id", "feature_name"], {:name=>"index_user_callouts_on_user_id_and_feature_name", :unique=>true, :using=>:btree})
                 -> 0.0031s
              -- add_index("user_callouts", ["user_id"], {:name=>"index_user_callouts_on_user_id", :using=>:btree})
                 -> 0.0030s
              -- create_table("user_custom_attributes", {:force=>:cascade})
                 -> 0.0054s
              -- add_index("user_custom_attributes", ["key", "value"], {:name=>"index_user_custom_attributes_on_key_and_value", :using=>:btree})
                 -> 0.0032s
              -- add_index("user_custom_attributes", ["user_id", "key"], {:name=>"index_user_custom_attributes_on_user_id_and_key", :unique=>true, :using=>:btree})
                 -> 0.0029s
              -- create_table("user_interacted_projects", {:id=>false, :force=>:cascade})
                 -> 0.0011s
              -- add_index("user_interacted_projects", ["project_id", "user_id"], {:name=>"index_user_interacted_projects_on_project_id_and_user_id", :unique=>true, :using=>:btree})
                 -> 0.0032s
              -- add_index("user_interacted_projects", ["user_id"], {:name=>"index_user_interacted_projects_on_user_id", :using=>:btree})
                 -> 0.0036s
              -- create_table("user_synced_attributes_metadata", {:force=>:cascade})
                 -> 0.0060s
              -- add_index("user_synced_attributes_metadata", ["user_id"], {:name=>"index_user_synced_attributes_metadata_on_user_id", :unique=>true, :using=>:btree})
                 -> 0.0035s
              -- create_table("users", {:force=>:cascade})
                 -> 0.0107s
              -- add_index("users", ["admin"], {:name=>"index_users_on_admin", :using=>:btree})
                 -> 0.0028s
              -- add_index("users", ["confirmation_token"], {:name=>"index_users_on_confirmation_token", :unique=>true, :using=>:btree})
                 -> 0.0039s
              -- add_index("users", ["created_at"], {:name=>"index_users_on_created_at", :using=>:btree})
                 -> 0.0059s
              -- add_index("users", ["email"], {:name=>"index_users_on_email", :unique=>true, :using=>:btree})
                 -> 0.0050s
              -- add_index("users", ["email"], {:name=>"index_users_on_email_trigram", :using=>:gin, :opclasses=>{"email"=>"gin_trgm_ops"}})
                 -> 0.0031s
              -- add_index("users", ["ghost"], {:name=>"index_users_on_ghost", :using=>:btree})
                 -> 0.0040s
              -- add_index("users", ["incoming_email_token"], {:name=>"index_users_on_incoming_email_token", :using=>:btree})
                 -> 0.0038s
              -- add_index("users", ["name"], {:name=>"index_users_on_name", :using=>:btree})
                 -> 0.0030s
              -- add_index("users", ["name"], {:name=>"index_users_on_name_trigram", :using=>:gin, :opclasses=>{"name"=>"gin_trgm_ops"}})
                 -> 0.0020s
              -- add_index("users", ["reset_password_token"], {:name=>"index_users_on_reset_password_token", :unique=>true, :using=>:btree})
                 -> 0.0035s
              -- add_index("users", ["rss_token"], {:name=>"index_users_on_rss_token", :using=>:btree})
                 -> 0.0031s
              -- add_index("users", ["state"], {:name=>"index_users_on_state", :using=>:btree})
                 -> 0.0037s
              -- add_index("users", ["username"], {:name=>"index_users_on_username", :using=>:btree})
                 -> 0.0029s
              -- add_index("users", ["username"], {:name=>"index_users_on_username_trigram", :using=>:gin, :opclasses=>{"username"=>"gin_trgm_ops"}})
                 -> 0.0018s
              -- create_table("users_star_projects", {:force=>:cascade})
                 -> 0.0033s
              -- add_index("users_star_projects", ["project_id"], {:name=>"index_users_star_projects_on_project_id", :using=>:btree})
                 -> 0.0034s
              -- add_index("users_star_projects", ["user_id", "project_id"], {:name=>"index_users_star_projects_on_user_id_and_project_id", :unique=>true, :using=>:btree})
                 -> 0.0049s
              -- create_table("web_hook_logs", {:force=>:cascade})
                 -> 0.0048s
              -- add_index("web_hook_logs", ["web_hook_id"], {:name=>"index_web_hook_logs_on_web_hook_id", :using=>:btree})
                 -> 0.0032s
              -- create_table("web_hooks", {:force=>:cascade})
                 -> 0.0092s
              -- add_index("web_hooks", ["project_id"], {:name=>"index_web_hooks_on_project_id", :using=>:btree})
                 -> 0.0030s
              -- add_index("web_hooks", ["type"], {:name=>"index_web_hooks_on_type", :using=>:btree})
                 -> 0.0030s
              -- add_foreign_key("badges", "namespaces", {:column=>"group_id", :on_delete=>:cascade})
                 -> 0.0042s
              -- add_foreign_key("badges", "projects", {:on_delete=>:cascade})
                 -> 0.0023s
              -- add_foreign_key("boards", "namespaces", {:column=>"group_id", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("boards", "projects", {:name=>"fk_f15266b5f9", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("chat_teams", "namespaces", {:on_delete=>:cascade})
                 -> 0.0010s
              -- add_foreign_key("ci_build_trace_chunks", "ci_builds", {:column=>"build_id", :on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("ci_build_trace_section_names", "projects", {:on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("ci_build_trace_sections", "ci_build_trace_section_names", {:column=>"section_name_id", :name=>"fk_264e112c66", :on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("ci_build_trace_sections", "ci_builds", {:column=>"build_id", :name=>"fk_4ebe41f502", :on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("ci_build_trace_sections", "projects", {:on_delete=>:cascade})
                 -> 0.0014s
              -- add_foreign_key("ci_builds", "ci_pipelines", {:column=>"auto_canceled_by_id", :name=>"fk_a2141b1522", :on_delete=>:nullify})
                 -> 0.0024s
              -- add_foreign_key("ci_builds", "ci_pipelines", {:column=>"commit_id", :name=>"fk_d3130c9a7f", :on_delete=>:cascade})
                 -> 0.0018s
              -- add_foreign_key("ci_builds", "ci_stages", {:column=>"stage_id", :name=>"fk_3a9eaa254d", :on_delete=>:cascade})
                 -> 0.0023s
              -- add_foreign_key("ci_builds", "projects", {:name=>"fk_befce0568a", :on_delete=>:cascade})
                 -> 0.0019s
              -- add_foreign_key("ci_builds_metadata", "ci_builds", {:column=>"build_id", :on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("ci_builds_metadata", "projects", {:on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("ci_group_variables", "namespaces", {:column=>"group_id", :name=>"fk_33ae4d58d8", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("ci_job_artifacts", "ci_builds", {:column=>"job_id", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("ci_job_artifacts", "projects", {:on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("ci_pipeline_schedule_variables", "ci_pipeline_schedules", {:column=>"pipeline_schedule_id", :name=>"fk_41c35fda51", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("ci_pipeline_schedules", "projects", {:name=>"fk_8ead60fcc4", :on_delete=>:cascade})
                 -> 0.0018s
              -- add_foreign_key("ci_pipeline_schedules", "users", {:column=>"owner_id", :name=>"fk_9ea99f58d2", :on_delete=>:nullify})
                 -> 0.0025s
              -- add_foreign_key("ci_pipeline_variables", "ci_pipelines", {:column=>"pipeline_id", :name=>"fk_f29c5f4380", :on_delete=>:cascade})
                 -> 0.0017s
              -- add_foreign_key("ci_pipelines", "ci_pipeline_schedules", {:column=>"pipeline_schedule_id", :name=>"fk_3d34ab2e06", :on_delete=>:nullify})
                 -> 0.0050s
              -- add_foreign_key("ci_pipelines", "ci_pipelines", {:column=>"auto_canceled_by_id", :name=>"fk_262d4c2d19", :on_delete=>:nullify})
                 -> 0.0011s
              -- add_foreign_key("ci_pipelines", "projects", {:name=>"fk_86635dbd80", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("ci_runner_namespaces", "ci_runners", {:column=>"runner_id", :on_delete=>:cascade})
                 -> 0.0075s
              -- add_foreign_key("ci_runner_namespaces", "namespaces", {:on_delete=>:cascade})
                 -> 0.0019s
              -- add_foreign_key("ci_runner_projects", "projects", {:name=>"fk_4478a6f1e4", :on_delete=>:cascade})
                 -> 0.0042s
              -- add_foreign_key("ci_stages", "ci_pipelines", {:column=>"pipeline_id", :name=>"fk_fb57e6cc56", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("ci_stages", "projects", {:name=>"fk_2360681d1d", :on_delete=>:cascade})
                 -> 0.0015s
              -- add_foreign_key("ci_trigger_requests", "ci_triggers", {:column=>"trigger_id", :name=>"fk_b8ec8b7245", :on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("ci_triggers", "projects", {:name=>"fk_e3e63f966e", :on_delete=>:cascade})
                 -> 0.0020s
              -- add_foreign_key("ci_triggers", "users", {:column=>"owner_id", :name=>"fk_e8e10d1964", :on_delete=>:cascade})
                 -> 0.0021s
              -- add_foreign_key("ci_variables", "projects", {:name=>"fk_ada5eb64b3", :on_delete=>:cascade})
                 -> 0.0023s
              -- add_foreign_key("cluster_platforms_kubernetes", "clusters", {:on_delete=>:cascade})
                 -> 0.0026s
              -- add_foreign_key("cluster_projects", "clusters", {:on_delete=>:cascade})
                 -> 0.0015s
              -- add_foreign_key("cluster_projects", "projects", {:on_delete=>:cascade})
                 -> 0.0017s
              -- add_foreign_key("cluster_providers_gcp", "clusters", {:on_delete=>:cascade})
                 -> 0.0014s
              -- add_foreign_key("clusters", "users", {:on_delete=>:nullify})
                 -> 0.0013s
              -- add_foreign_key("clusters_applications_helm", "clusters", {:on_delete=>:cascade})
                 -> 0.0010s
              -- add_foreign_key("clusters_applications_ingress", "clusters", {:name=>"fk_753a7b41c1", :on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("clusters_applications_prometheus", "clusters", {:name=>"fk_557e773639", :on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("clusters_applications_runners", "ci_runners", {:column=>"runner_id", :name=>"fk_02de2ded36", :on_delete=>:nullify})
                 -> 0.0020s
              -- add_foreign_key("clusters_applications_runners", "clusters", {:on_delete=>:cascade})
                 -> 0.0014s
              -- add_foreign_key("container_repositories", "projects")
                 -> 0.0021s
              -- add_foreign_key("deploy_keys_projects", "projects", {:name=>"fk_58a901ca7e", :on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("deployments", "projects", {:name=>"fk_b9a3851b82", :on_delete=>:cascade})
                 -> 0.0017s
              -- add_foreign_key("environments", "projects", {:name=>"fk_d1c8c1da6a", :on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("events", "projects", {:on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("events", "users", {:column=>"author_id", :name=>"fk_edfd187b6f", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("fork_network_members", "fork_networks", {:on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("fork_network_members", "projects", {:column=>"forked_from_project_id", :name=>"fk_b01280dae4", :on_delete=>:nullify})
                 -> 0.0018s
              -- add_foreign_key("fork_network_members", "projects", {:on_delete=>:cascade})
                 -> 0.0020s
              -- add_foreign_key("fork_networks", "projects", {:column=>"root_project_id", :name=>"fk_e7b436b2b5", :on_delete=>:nullify})
                 -> 0.0015s
              -- add_foreign_key("forked_project_links", "projects", {:column=>"forked_to_project_id", :name=>"fk_434510edb0", :on_delete=>:cascade})
                 -> 0.0015s
              -- add_foreign_key("gcp_clusters", "projects", {:on_delete=>:cascade})
                 -> 0.0017s
              -- add_foreign_key("gcp_clusters", "services", {:on_delete=>:nullify})
                 -> 0.0013s
              -- add_foreign_key("gcp_clusters", "users", {:on_delete=>:nullify})
                 -> 0.0013s
              -- add_foreign_key("gpg_key_subkeys", "gpg_keys", {:on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("gpg_keys", "users", {:on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("gpg_signatures", "gpg_key_subkeys", {:on_delete=>:nullify})
                 -> 0.0022s
              -- add_foreign_key("gpg_signatures", "gpg_keys", {:on_delete=>:nullify})
                 -> 0.0013s
              -- add_foreign_key("gpg_signatures", "projects", {:on_delete=>:cascade})
                 -> 0.0020s
              -- add_foreign_key("group_custom_attributes", "namespaces", {:column=>"group_id", :on_delete=>:cascade})
                 -> 0.0019s
              -- add_foreign_key("internal_ids", "namespaces", {:name=>"fk_162941d509", :on_delete=>:cascade})
                 -> 0.0020s
              -- add_foreign_key("internal_ids", "projects", {:on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("issue_assignees", "issues", {:name=>"fk_b7d881734a", :on_delete=>:cascade})
                 -> 0.0017s
              -- add_foreign_key("issue_assignees", "users", {:name=>"fk_5e0c8d9154", :on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("issue_metrics", "issues", {:on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("issues", "issues", {:column=>"moved_to_id", :name=>"fk_a194299be1", :on_delete=>:nullify})
                 -> 0.0010s
              -- add_foreign_key("issues", "milestones", {:name=>"fk_96b1dd429c", :on_delete=>:nullify})
                 -> 0.0014s
              -- add_foreign_key("issues", "projects", {:name=>"fk_899c8f3231", :on_delete=>:cascade})
                 -> 0.0014s
              -- add_foreign_key("issues", "users", {:column=>"author_id", :name=>"fk_05f1e72feb", :on_delete=>:nullify})
                 -> 0.0018s
              -- add_foreign_key("issues", "users", {:column=>"closed_by_id", :name=>"fk_c63cbf6c25", :on_delete=>:nullify})
                 -> 0.0022s
              -- add_foreign_key("issues", "users", {:column=>"updated_by_id", :name=>"fk_ffed080f01", :on_delete=>:nullify})
                 -> 0.0019s
              -- add_foreign_key("label_priorities", "labels", {:on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("label_priorities", "projects", {:on_delete=>:cascade})
                 -> 0.0015s
              -- add_foreign_key("labels", "namespaces", {:column=>"group_id", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("labels", "projects", {:name=>"fk_7de4989a69", :on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("lfs_file_locks", "projects", {:on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("lfs_file_locks", "users", {:on_delete=>:cascade})
                 -> 0.0020s
              -- add_foreign_key("lists", "boards", {:name=>"fk_0d3f677137", :on_delete=>:cascade})
                 -> 0.0019s
              -- add_foreign_key("lists", "labels", {:name=>"fk_7a5553d60f", :on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("members", "users", {:name=>"fk_2e88fb7ce9", :on_delete=>:cascade})
                 -> 0.0026s
              -- add_foreign_key("merge_request_diff_commits", "merge_request_diffs", {:on_delete=>:cascade})
                 -> 0.0038s
              -- add_foreign_key("merge_request_diff_files", "merge_request_diffs", {:on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("merge_request_diffs", "merge_requests", {:name=>"fk_8483f3258f", :on_delete=>:cascade})
                 -> 0.0014s
              -- add_foreign_key("merge_request_metrics", "ci_pipelines", {:column=>"pipeline_id", :on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("merge_request_metrics", "merge_requests", {:on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("merge_request_metrics", "users", {:column=>"latest_closed_by_id", :name=>"fk_ae440388cc", :on_delete=>:nullify})
                 -> 0.0013s
              -- add_foreign_key("merge_request_metrics", "users", {:column=>"merged_by_id", :name=>"fk_7f28d925f3", :on_delete=>:nullify})
                 -> 0.0015s
              -- add_foreign_key("merge_requests", "ci_pipelines", {:column=>"head_pipeline_id", :name=>"fk_fd82eae0b9", :on_delete=>:nullify})
                 -> 0.0019s
              -- add_foreign_key("merge_requests", "merge_request_diffs", {:column=>"latest_merge_request_diff_id", :name=>"fk_06067f5644", :on_delete=>:nullify})
                 -> 0.0018s
              -- add_foreign_key("merge_requests", "milestones", {:name=>"fk_6a5165a692", :on_delete=>:nullify})
                 -> 0.0013s
              -- add_foreign_key("merge_requests", "projects", {:column=>"source_project_id", :name=>"fk_3308fe130c", :on_delete=>:nullify})
                 -> 0.0016s
              -- add_foreign_key("merge_requests", "projects", {:column=>"target_project_id", :name=>"fk_a6963e8447", :on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("merge_requests", "users", {:column=>"assignee_id", :name=>"fk_6149611a04", :on_delete=>:nullify})
                 -> 0.0015s
              -- add_foreign_key("merge_requests", "users", {:column=>"author_id", :name=>"fk_e719a85f8a", :on_delete=>:nullify})
                 -> 0.0059s
              -- add_foreign_key("merge_requests", "users", {:column=>"merge_user_id", :name=>"fk_ad525e1f87", :on_delete=>:nullify})
                 -> 0.0017s
              -- add_foreign_key("merge_requests", "users", {:column=>"updated_by_id", :name=>"fk_641731faff", :on_delete=>:nullify})
                 -> 0.0017s
              -- add_foreign_key("merge_requests_closing_issues", "issues", {:on_delete=>:cascade})
                 -> 0.0021s
              -- add_foreign_key("merge_requests_closing_issues", "merge_requests", {:on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("milestones", "namespaces", {:column=>"group_id", :name=>"fk_95650a40d4", :on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("milestones", "projects", {:name=>"fk_9bd0a0c791", :on_delete=>:cascade})
                 -> 0.0014s
              -- add_foreign_key("notes", "projects", {:name=>"fk_99e097b079", :on_delete=>:cascade})
                 -> 0.0015s
              -- add_foreign_key("oauth_openid_requests", "oauth_access_grants", {:column=>"access_grant_id", :name=>"fk_oauth_openid_requests_oauth_access_grants_access_grant_id"})
                 -> 0.0010s
              -- add_foreign_key("pages_domains", "projects", {:name=>"fk_ea2f6dfc6f", :on_delete=>:cascade})
                 -> 0.0014s
              -- add_foreign_key("personal_access_tokens", "users")
                 -> 0.0014s
              -- add_foreign_key("project_authorizations", "projects", {:on_delete=>:cascade})
                 -> 0.0021s
              -- add_foreign_key("project_authorizations", "users", {:on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("project_auto_devops", "projects", {:on_delete=>:cascade})
                 -> 0.0015s
              -- add_foreign_key("project_ci_cd_settings", "projects", {:name=>"fk_24c15d2f2e", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("project_custom_attributes", "projects", {:on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("project_deploy_tokens", "deploy_tokens", {:on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("project_deploy_tokens", "projects", {:on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("project_features", "projects", {:name=>"fk_18513d9b92", :on_delete=>:cascade})
                 -> 0.0014s
              -- add_foreign_key("project_group_links", "projects", {:name=>"fk_daa8cee94c", :on_delete=>:cascade})
                 -> 0.0018s
              -- add_foreign_key("project_import_data", "projects", {:name=>"fk_ffb9ee3a10", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("project_mirror_data", "projects", {:on_delete=>:cascade})
                 -> 0.0017s
              -- add_foreign_key("project_statistics", "projects", {:on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("protected_branch_merge_access_levels", "protected_branches", {:name=>"fk_8a3072ccb3", :on_delete=>:cascade})
                 -> 0.0014s
              -- add_foreign_key("protected_branch_push_access_levels", "protected_branches", {:name=>"fk_9ffc86a3d9", :on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("protected_branches", "projects", {:name=>"fk_7a9c6d93e7", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("protected_tag_create_access_levels", "namespaces", {:column=>"group_id"})
                 -> 0.0012s
              -- add_foreign_key("protected_tag_create_access_levels", "protected_tags", {:name=>"fk_f7dfda8c51", :on_delete=>:cascade})
                 -> 0.0011s
              -- add_foreign_key("protected_tag_create_access_levels", "users")
                 -> 0.0014s
              -- add_foreign_key("protected_tags", "projects", {:name=>"fk_8e4af87648", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("push_event_payloads", "events", {:name=>"fk_36c74129da", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("releases", "projects", {:name=>"fk_47fe2a0596", :on_delete=>:cascade})
                 -> 0.0015s
              -- add_foreign_key("remote_mirrors", "projects", {:on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("services", "projects", {:name=>"fk_71cce407f9", :on_delete=>:cascade})
                 -> 0.0020s
              -- add_foreign_key("snippets", "projects", {:name=>"fk_be41fd4bb7", :on_delete=>:cascade})
                 -> 0.0025s
              -- add_foreign_key("subscriptions", "projects", {:on_delete=>:cascade})
                 -> 0.0019s
              -- add_foreign_key("system_note_metadata", "notes", {:name=>"fk_d83a918cb1", :on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("term_agreements", "application_setting_terms", {:column=>"term_id"})
                 -> 0.0012s
              -- add_foreign_key("term_agreements", "users", {:on_delete=>:cascade})
                 -> 0.0014s
              -- add_foreign_key("timelogs", "issues", {:name=>"fk_timelogs_issues_issue_id", :on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("timelogs", "merge_requests", {:name=>"fk_timelogs_merge_requests_merge_request_id", :on_delete=>:cascade})
                 -> 0.0015s
              -- add_foreign_key("todos", "notes", {:name=>"fk_91d1f47b13", :on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("todos", "projects", {:name=>"fk_45054f9c45", :on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("todos", "users", {:column=>"author_id", :name=>"fk_ccf0373936", :on_delete=>:cascade})
                 -> 0.0017s
              -- add_foreign_key("todos", "users", {:name=>"fk_d94154aa95", :on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("trending_projects", "projects", {:on_delete=>:cascade})
                 -> 0.0014s
              -- add_foreign_key("u2f_registrations", "users")
                 -> 0.0013s
              -- add_foreign_key("user_callouts", "users", {:on_delete=>:cascade})
                 -> 0.0015s
              -- add_foreign_key("user_custom_attributes", "users", {:on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("user_interacted_projects", "projects", {:name=>"fk_722ceba4f7", :on_delete=>:cascade})
                 -> 0.0046s
              -- add_foreign_key("user_interacted_projects", "users", {:name=>"fk_0894651f08", :on_delete=>:cascade})
                 -> 0.0013s
              -- add_foreign_key("user_synced_attributes_metadata", "users", {:on_delete=>:cascade})
                 -> 0.0015s
              -- add_foreign_key("users", "application_setting_terms", {:column=>"accepted_term_id", :name=>"fk_789cd90b35", :on_delete=>:cascade})
                 -> 0.0012s
              -- add_foreign_key("users_star_projects", "projects", {:name=>"fk_22cd27ddfc", :on_delete=>:cascade})
                 -> 0.0018s
              -- add_foreign_key("web_hook_logs", "web_hooks", {:on_delete=>:cascade})
                 -> 0.0016s
              -- add_foreign_key("web_hooks", "projects", {:name=>"fk_0c8ca6d9d1", :on_delete=>:cascade})
                 -> 0.0017s
              -- initialize_schema_migrations_table()
                 -> 0.0127s
              
              == Seed from /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/001_admin.rb
              Administrator account created:
              
              login:    root
              password: You'll be prompted to create one on your first visit.
              
              
              == Seed from /opt/gitlab/embedded/service/gitlab-rails/db/fixtures/production/010_settings.rb
    [32m- execute "bash"  "/tmp/chef-script20180530-48-1kkpavu"[0m
[0mRecipe: gitlab::gitlab-rails[0m
  * execute[clear the gitlab-rails cache] action run
    [32m- execute /opt/gitlab/bin/gitlab-rake cache:clear[0m
[0mRecipe: gitlab::logrotate_folders_and_configs[0m
  * directory[/var/opt/gitlab/logrotate] action create
    [32m- create new directory /var/opt/gitlab/logrotate[0m
    [32m- change mode from '' to '0700'[0m
[0m  * directory[/var/opt/gitlab/logrotate/logrotate.d] action create
    [32m- create new directory /var/opt/gitlab/logrotate/logrotate.d[0m
    [32m- change mode from '' to '0700'[0m
[0m  * directory[/var/log/gitlab/logrotate] action create
    [32m- create new directory /var/log/gitlab/logrotate[0m
    [32m- change mode from '' to '0700'[0m
[0m  * template[/var/opt/gitlab/logrotate/logrotate.conf] action create
    [32m- create new file /var/opt/gitlab/logrotate/logrotate.conf[0m
    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.conf from none to 378c95[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.conf	2018-05-30 10:04:31.533708669 +0000[0m
    [37m+++ /var/opt/gitlab/logrotate/.chef-logrotate20180530-48-zaqno3.conf	2018-05-30 10:04:31.533708669 +0000[0m
    [37m@@ -1 +1,10 @@[0m
    [37m+# Generated by 'gitlab-ctl reconfigure'.[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/nginx[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/unicorn[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse[0m
    [37m+include /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages[0m
    [32m- change mode from '' to '0644'[0m
[0m  * template[/var/opt/gitlab/logrotate/logrotate.d/nginx] action create
    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/nginx[0m
    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/nginx from none to b0c555[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/nginx	2018-05-30 10:04:31.543708669 +0000[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-nginx20180530-48-h1efvo	2018-05-30 10:04:31.543708669 +0000[0m
    [37m@@ -1 +1,15 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/nginx/*.log {[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
[0m  * template[/var/opt/gitlab/logrotate/logrotate.d/unicorn] action create
    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/unicorn[0m
    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/unicorn from none to 1520c7[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/unicorn	2018-05-30 10:04:31.553708669 +0000[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-unicorn20180530-48-19l0lmx	2018-05-30 10:04:31.553708669 +0000[0m
    [37m@@ -1 +1,15 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/unicorn/*.log {[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
[0m  * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-rails] action create
    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails[0m
    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails from none to f44586[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/gitlab-rails	2018-05-30 10:04:31.553708669 +0000[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-rails20180530-48-r94ya	2018-05-30 10:04:31.553708669 +0000[0m
    [37m@@ -1 +1,15 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/gitlab-rails/*.log {[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
[0m  * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-shell] action create
    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell[0m
    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell from none to d12268[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/gitlab-shell	2018-05-30 10:04:31.563708669 +0000[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-shell20180530-48-1xgrokn	2018-05-30 10:04:31.563708669 +0000[0m
    [37m@@ -1 +1,15 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/gitlab-shell//*.log {[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
[0m  * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse] action create
    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse[0m
    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse from none to 359431[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/gitlab-workhorse	2018-05-30 10:04:31.573708669 +0000[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-workhorse20180530-48-guw439	2018-05-30 10:04:31.573708669 +0000[0m
    [37m@@ -1 +1,15 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/gitlab-workhorse/*.log {[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
[0m  * template[/var/opt/gitlab/logrotate/logrotate.d/gitlab-pages] action create
    [32m- create new file /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages[0m
    [32m- update content in file /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages from none to 3a241b[0m
    [37m--- /var/opt/gitlab/logrotate/logrotate.d/gitlab-pages	2018-05-30 10:04:31.583708669 +0000[0m
    [37m+++ /var/opt/gitlab/logrotate/logrotate.d/.chef-gitlab-pages20180530-48-v94vgb	2018-05-30 10:04:31.583708669 +0000[0m
    [37m@@ -1 +1,15 @@[0m
    [37m+# Generated by gitlab-ctl reconfigure[0m
    [37m+# Modifications will be overwritten![0m
    [37m+[0m
    [37m+/var/log/gitlab/gitlab-pages/*.log {[0m
    [37m+  daily[0m
    [37m+  [0m
    [37m+  rotate 30[0m
    [37m+  compress[0m
    [37m+  copytruncate[0m
    [37m+  missingok[0m
    [37m+  postrotate[0m
    [37m+    [0m
    [37m+  endscript[0m
    [37m+}[0m
[0mRecipe: gitlab::unicorn[0m
  * directory[/var/log/gitlab/unicorn] action create
    [32m- create new directory /var/log/gitlab/unicorn[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[/opt/gitlab/var/unicorn] action create
    [32m- create new directory /opt/gitlab/var/unicorn[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[/var/opt/gitlab/gitlab-rails/sockets] action create
    [32m- create new directory /var/opt/gitlab/gitlab-rails/sockets[0m
    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'git'[0m
    [32m- change group from '' to 'gitlab-www'[0m
[0m  * directory[/var/opt/gitlab/gitlab-rails/etc] action create (up to date)
  * template[/var/opt/gitlab/gitlab-rails/etc/unicorn.rb] action create
    [32m- create new file /var/opt/gitlab/gitlab-rails/etc/unicorn.rb[0m
    [32m- update content in file /var/opt/gitlab/gitlab-rails/etc/unicorn.rb from none to 2a648d[0m
    [37m--- /var/opt/gitlab/gitlab-rails/etc/unicorn.rb	2018-05-30 10:04:31.613708669 +0000[0m
    [37m+++ /var/opt/gitlab/gitlab-rails/etc/.chef-unicorn20180530-48-ekab4p.rb	2018-05-30 10:04:31.613708669 +0000[0m
    [37m@@ -1 +1,59 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m+[0m
    [37m+# What ports/sockets to listen on, and what options for them.[0m
    [37m+listen "127.0.0.1:8080", :tcp_nopush => true[0m
    [37m+listen "/var/opt/gitlab/gitlab-rails/sockets/gitlab.socket", :backlog => 1024[0m
    [37m+[0m
    [37m+working_directory '/var/opt/gitlab/gitlab-rails/working'[0m
    [37m+[0m
    [37m+# What the timeout for killing busy workers is, in seconds[0m
    [37m+timeout 60[0m
    [37m+[0m
    [37m+# Whether the app should be pre-loaded[0m
    [37m+preload_app true[0m
    [37m+[0m
    [37m+# How many worker processes[0m
    [37m+worker_processes 2[0m
    [37m+[0m
    [37m+# What to do before we fork a worker[0m
    [37m+before_fork do |server, worker|[0m
    [37m+        old_pid = "#{server.config[:pid]}.oldbin"[0m
    [37m+      if old_pid != server.pid[0m
    [37m+        begin[0m
    [37m+          sig = (worker.nr + 1) >= server.worker_processes ? :QUIT : :TTOU[0m
    [37m+          Process.kill(sig, File.read(old_pid).to_i)[0m
    [37m+        rescue Errno::ENOENT, Errno::ESRCH[0m
    [37m+        end[0m
    [37m+      end[0m
    [37m+[0m
    [37m+      ActiveRecord::Base.connection.disconnect! if defined?(ActiveRecord::Base)[0m
    [37m+[0m
    [37m+end[0m
    [37m+[0m
    [37m+# What to do after we fork a worker[0m
    [37m+after_fork do |server, worker|[0m
    [37m+        ActiveRecord::Base.establish_connection if defined?(ActiveRecord::Base)[0m
    [37m+      defined?(::Prometheus::Client.reinitialize_on_pid_change) &&[0m
    [37m+        Prometheus::Client.reinitialize_on_pid_change[0m
    [37m+[0m
    [37m+end[0m
    [37m+[0m
    [37m+# Where to drop a pidfile[0m
    [37m+pid '/opt/gitlab/var/unicorn/unicorn.pid'[0m
    [37m+[0m
    [37m+# Where stderr gets logged[0m
    [37m+stderr_path '/var/log/gitlab/unicorn/unicorn_stderr.log'[0m
    [37m+[0m
    [37m+# Where stdout gets logged[0m
    [37m+stdout_path '/var/log/gitlab/unicorn/unicorn_stdout.log'[0m
    [37m+[0m
    [37m+# Min memory size (RSS) per worker[0m
    [37m+ENV['GITLAB_UNICORN_MEMORY_MIN'] = (400 * 1 << 20).to_s[0m
    [37m+[0m
    [37m+# Max memory size (RSS) per worker[0m
    [37m+ENV['GITLAB_UNICORN_MEMORY_MAX'] = (650 * 1 << 20).to_s[0m
    [37m+[0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/unicorn] action create
    [32m- create new directory /opt/gitlab/sv/unicorn[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/unicorn/log] action create
    [32m- create new directory /opt/gitlab/sv/unicorn/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/unicorn/log/main] action create
    [32m- create new directory /opt/gitlab/sv/unicorn/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/unicorn/run] action create
    [32m- create new file /opt/gitlab/sv/unicorn/run[0m
    [32m- update content in file /opt/gitlab/sv/unicorn/run from none to 8eaf78[0m
    [37m--- /opt/gitlab/sv/unicorn/run	2018-05-30 10:04:31.643708669 +0000[0m
    [37m+++ /opt/gitlab/sv/unicorn/.chef-run20180530-48-jpz0br	2018-05-30 10:04:31.643708669 +0000[0m
    [37m@@ -1 +1,19 @@[0m
    [37m+#!/bin/bash[0m
    [37m+[0m
    [37m+# Let runit capture all script error messages[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+export prometheus_run_dir=''[0m
    [37m+[0m
    [37m+[0m
    [37m+[0m
    [37m+exec chpst -P -u git \[0m
    [37m+  /usr/bin/env \[0m
    [37m+    current_pidfile=/opt/gitlab/var/unicorn/unicorn.pid \[0m
    [37m+    rails_app=gitlab-rails \[0m
    [37m+    user=git \[0m
    [37m+    environment=production \[0m
    [37m+    unicorn_rb=/var/opt/gitlab/gitlab-rails/etc/unicorn.rb \[0m
    [37m+    prometheus_multiproc_dir="${prometheus_run_dir}" \[0m
    [37m+    /opt/gitlab/embedded/bin/gitlab-unicorn-wrapper[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/unicorn/log/run] action create
    [32m- create new file /opt/gitlab/sv/unicorn/log/run[0m
    [32m- update content in file /opt/gitlab/sv/unicorn/log/run from none to d50262[0m
    [37m--- /opt/gitlab/sv/unicorn/log/run	2018-05-30 10:04:31.643708669 +0000[0m
    [37m+++ /opt/gitlab/sv/unicorn/log/.chef-run20180530-48-csmvmj	2018-05-30 10:04:31.643708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/unicorn[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/unicorn/config] action create
    [32m- create new file /var/log/gitlab/unicorn/config[0m
    [32m- update content in file /var/log/gitlab/unicorn/config from none to 623c00[0m
    [37m--- /var/log/gitlab/unicorn/config	2018-05-30 10:04:31.653708669 +0000[0m
    [37m+++ /var/log/gitlab/unicorn/.chef-config20180530-48-l7fotq	2018-05-30 10:04:31.653708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload unicorn svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart unicorn svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/unicorn/down] action delete (up to date)
  * directory[/opt/gitlab/sv/unicorn/control] action create
    [32m- create new directory /opt/gitlab/sv/unicorn/control[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/unicorn/control/t] action create
    [32m- create new file /opt/gitlab/sv/unicorn/control/t[0m
    [32m- update content in file /opt/gitlab/sv/unicorn/control/t from none to 84b233[0m
    [37m--- /opt/gitlab/sv/unicorn/control/t	2018-05-30 10:04:31.663708669 +0000[0m
    [37m+++ /opt/gitlab/sv/unicorn/control/.chef-t20180530-48-1u3zgqc	2018-05-30 10:04:31.663708669 +0000[0m
    [37m@@ -1 +1,4 @@[0m
    [37m+#!/bin/sh[0m
    [37m+echo "Received TERM from runit, sending to process group (-PID)"[0m
    [37m+kill -- -$(cat /opt/gitlab/service/unicorn/supervise/pid)[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * link[/opt/gitlab/init/unicorn] action create
    [32m- create symlink at /opt/gitlab/init/unicorn to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/unicorn] action create
    [32m- create symlink at /opt/gitlab/service/unicorn to /opt/gitlab/sv/unicorn[0m
[0m  * ruby_block[supervise_unicorn_sleep] action run
    [32m- execute the ruby block supervise_unicorn_sleep[0m
[0m  * directory[/opt/gitlab/sv/unicorn/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/unicorn/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/unicorn/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/unicorn/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/unicorn/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/unicorn/log/supervise/control] action touch (skipped due to only_if)
  * service[unicorn] action nothing (skipped due to action :nothing)
  * execute[/opt/gitlab/bin/gitlab-ctl start unicorn] action run
    [execute] ok: run: unicorn: (pid 935) 2s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start unicorn[0m
[0m  * sysctl[net.core.somaxconn] action create
    * directory[create /etc/sysctl.d for net.core.somaxconn] action create (up to date)
    * file[create /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf net.core.somaxconn] action create
      [32m- create new file /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf[0m
      [32m- update content in file /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf from none to 353a75[0m
      [37m--- /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf	2018-05-30 10:04:37.233708669 +0000[0m
      [37m+++ /opt/gitlab/embedded/etc/.chef-90-omnibus-gitlab-net20180530-48-1hzchjj.core.somaxconn.conf	2018-05-30 10:04:37.233708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+net.core.somaxconn = 1024[0m
[0m    * execute[load sysctl conf net.core.somaxconn] action run
      [execute] sysctl: setting key "kernel.printk": Read-only file system
                sysctl: setting key "net.ipv6.conf.all.use_tempaddr": Read-only file system
                sysctl: setting key "net.ipv6.conf.default.use_tempaddr": Read-only file system
                sysctl: setting key "kernel.kptr_restrict": Read-only file system
                sysctl: setting key "fs.protected_hardlinks": Read-only file system
                sysctl: setting key "fs.protected_symlinks": Read-only file system
                sysctl: setting key "kernel.sysrq": Read-only file system
                sysctl: setting key "net.ipv4.conf.default.rp_filter": Read-only file system
                sysctl: setting key "net.ipv4.conf.all.rp_filter": Read-only file system
                sysctl: setting key "vm.mmap_min_addr": Read-only file system
                sysctl: setting key "kernel.sem": Read-only file system
                sysctl: setting key "kernel.shmall": Read-only file system
                sysctl: setting key "kernel.shmmax": Read-only file system
      [32m- execute cat /etc/sysctl.conf /etc/sysctl.d/*.conf  | sysctl -e -p -[0m
[0m    * link[/etc/sysctl.d/90-omnibus-gitlab-net.core.somaxconn.conf] action create
      [32m- create symlink at /etc/sysctl.d/90-omnibus-gitlab-net.core.somaxconn.conf to /opt/gitlab/embedded/etc/90-omnibus-gitlab-net.core.somaxconn.conf[0m
[0m    * file[delete /etc/sysctl.d/90-postgresql.conf net.core.somaxconn] action delete (skipped due to only_if)
    * file[delete /etc/sysctl.d/90-unicorn.conf net.core.somaxconn] action delete (skipped due to only_if)
    * file[delete /opt/gitlab/embedded/etc/90-omnibus-gitlab.conf net.core.somaxconn] action delete (skipped due to only_if)
    * file[delete /etc/sysctl.d/90-omnibus-gitlab.conf net.core.somaxconn] action delete (skipped due to only_if)
    * execute[load sysctl conf net.core.somaxconn] action nothing (skipped due to action :nothing)
  
[0mRecipe: gitlab::sidekiq[0m
  * directory[/var/log/gitlab/sidekiq] action create
    [32m- create new directory /var/log/gitlab/sidekiq[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[/opt/gitlab/sv/sidekiq] action create
    [32m- create new directory /opt/gitlab/sv/sidekiq[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/sidekiq/log] action create
    [32m- create new directory /opt/gitlab/sv/sidekiq/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/sidekiq/log/main] action create
    [32m- create new directory /opt/gitlab/sv/sidekiq/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/sidekiq/run] action create
    [32m- create new file /opt/gitlab/sv/sidekiq/run[0m
    [32m- update content in file /opt/gitlab/sv/sidekiq/run from none to 38fc88[0m
    [37m--- /opt/gitlab/sv/sidekiq/run	2018-05-30 10:04:37.313708669 +0000[0m
    [37m+++ /opt/gitlab/sv/sidekiq/.chef-run20180530-48-1fbjyj0	2018-05-30 10:04:37.313708669 +0000[0m
    [37m@@ -1 +1,19 @@[0m
    [37m+#!/bin/sh[0m
    [37m+[0m
    [37m+cd /var/opt/gitlab/gitlab-rails/working[0m
    [37m+[0m
    [37m+exec 2>&1[0m
    [37m+export prometheus_run_dir=''[0m
    [37m+[0m
    [37m+[0m
    [37m+exec chpst -e /opt/gitlab/etc/gitlab-rails/env -P \[0m
    [37m+  -U git -u git \[0m
    [37m+  /usr/bin/env \[0m
    [37m+    prometheus_multiproc_dir="${prometheus_run_dir}" \[0m
    [37m+    /opt/gitlab/embedded/bin/bundle exec sidekiq \[0m
    [37m+      -C /opt/gitlab/embedded/service/gitlab-rails/config/sidekiq_queues.yml \[0m
    [37m+      -e production \[0m
    [37m+      -r /opt/gitlab/embedded/service/gitlab-rails \[0m
    [37m+      -t 4 \[0m
    [37m+      -c 25[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/sidekiq/log/run] action create
    [32m- create new file /opt/gitlab/sv/sidekiq/log/run[0m
    [32m- update content in file /opt/gitlab/sv/sidekiq/log/run from none to 051d8f[0m
    [37m--- /opt/gitlab/sv/sidekiq/log/run	2018-05-30 10:04:37.333708669 +0000[0m
    [37m+++ /opt/gitlab/sv/sidekiq/log/.chef-run20180530-48-1fmuahk	2018-05-30 10:04:37.333708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/sidekiq[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/sidekiq/config] action create
    [32m- create new file /var/log/gitlab/sidekiq/config[0m
    [32m- update content in file /var/log/gitlab/sidekiq/config from none to 623c00[0m
    [37m--- /var/log/gitlab/sidekiq/config	2018-05-30 10:04:37.353708669 +0000[0m
    [37m+++ /var/log/gitlab/sidekiq/.chef-config20180530-48-or4ll5	2018-05-30 10:04:37.353708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload sidekiq svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart sidekiq svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/sidekiq/down] action delete (up to date)
  * link[/opt/gitlab/init/sidekiq] action create
    [32m- create symlink at /opt/gitlab/init/sidekiq to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/sidekiq] action create
    [32m- create symlink at /opt/gitlab/service/sidekiq to /opt/gitlab/sv/sidekiq[0m
[0m  * ruby_block[supervise_sidekiq_sleep] action run
    [32m- execute the ruby block supervise_sidekiq_sleep[0m
[0m  * directory[/opt/gitlab/sv/sidekiq/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/sidekiq/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/sidekiq/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/sidekiq/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/sidekiq/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/sidekiq/log/supervise/control] action touch (skipped due to only_if)
  * service[sidekiq] action nothing (skipped due to action :nothing)
  * execute[/opt/gitlab/bin/gitlab-ctl start sidekiq] action run
    [execute] ok: run: sidekiq: (pid 969) 2s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start sidekiq[0m
[0mRecipe: gitlab::gitlab-workhorse[0m
  * directory[/var/opt/gitlab/gitlab-workhorse] action create
    [32m- create new directory /var/opt/gitlab/gitlab-workhorse[0m
    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'git'[0m
    [32m- change group from '' to 'gitlab-www'[0m
[0m  * directory[/var/log/gitlab/gitlab-workhorse] action create
    [32m- create new directory /var/log/gitlab/gitlab-workhorse[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[/opt/gitlab/etc/gitlab-workhorse] action create
    [32m- create new directory /opt/gitlab/etc/gitlab-workhorse[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * env_dir[/opt/gitlab/etc/gitlab-workhorse/env] action create
    * directory[/opt/gitlab/etc/gitlab-workhorse/env] action create
      [32m- create new directory /opt/gitlab/etc/gitlab-workhorse/env[0m
[0m    * file[/opt/gitlab/etc/gitlab-workhorse/env/PATH] action create
      [32m- create new file /opt/gitlab/etc/gitlab-workhorse/env/PATH[0m
      [32m- update content in file /opt/gitlab/etc/gitlab-workhorse/env/PATH from none to d5dc07[0m
      [37m--- /opt/gitlab/etc/gitlab-workhorse/env/PATH	2018-05-30 10:04:43.523708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitlab-workhorse/env/.chef-PATH20180530-48-i78e70	2018-05-30 10:04:43.523708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+/opt/gitlab/bin:/opt/gitlab/embedded/bin:/bin:/usr/bin[0m
[0m    * file[/opt/gitlab/etc/gitlab-workhorse/env/HOME] action create
      [32m- create new file /opt/gitlab/etc/gitlab-workhorse/env/HOME[0m
      [32m- update content in file /opt/gitlab/etc/gitlab-workhorse/env/HOME from none to 205bb9[0m
      [37m--- /opt/gitlab/etc/gitlab-workhorse/env/HOME	2018-05-30 10:04:43.523708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitlab-workhorse/env/.chef-HOME20180530-48-1b8075x	2018-05-30 10:04:43.523708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+/var/opt/gitlab[0m
[0m  
[0m  * directory[/opt/gitlab/sv/gitlab-workhorse] action create
    [32m- create new directory /opt/gitlab/sv/gitlab-workhorse[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/gitlab-workhorse/log] action create
    [32m- create new directory /opt/gitlab/sv/gitlab-workhorse/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/gitlab-workhorse/log/main] action create
    [32m- create new directory /opt/gitlab/sv/gitlab-workhorse/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/gitlab-workhorse/run] action create
    [32m- create new file /opt/gitlab/sv/gitlab-workhorse/run[0m
    [32m- update content in file /opt/gitlab/sv/gitlab-workhorse/run from none to 275116[0m
    [37m--- /opt/gitlab/sv/gitlab-workhorse/run	2018-05-30 10:04:43.563708669 +0000[0m
    [37m+++ /opt/gitlab/sv/gitlab-workhorse/.chef-run20180530-48-1cbhxrh	2018-05-30 10:04:43.563708669 +0000[0m
    [37m@@ -1 +1,27 @@[0m
    [37m+#!/bin/sh[0m
    [37m+set -e # fail on errors[0m
    [37m+[0m
    [37m+# Redirect stderr -> stdout[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+[0m
    [37m+[0m
    [37m+cd /var/opt/gitlab/gitlab-workhorse[0m
    [37m+[0m
    [37m+exec chpst -e /opt/gitlab/etc/gitlab-workhorse/env -P \[0m
    [37m+  -U git \[0m
    [37m+  -u git \[0m
    [37m+  /opt/gitlab/embedded/bin/gitlab-workhorse \[0m
    [37m+    -listenNetwork unix \[0m
    [37m+    -listenUmask 0 \[0m
    [37m+    -listenAddr /var/opt/gitlab/gitlab-workhorse/socket \[0m
    [37m+    -authBackend http://localhost:8080 \[0m
    [37m+    -authSocket /var/opt/gitlab/gitlab-rails/sockets/gitlab.socket \[0m
    [37m+    -documentRoot /opt/gitlab/embedded/service/gitlab-rails/public \[0m
    [37m+    -pprofListenAddr ''\[0m
    [37m+    -prometheusListenAddr localhost:9229 \[0m
    [37m+    -secretPath /opt/gitlab/embedded/service/gitlab-rails/.gitlab_workhorse_secret \[0m
    [37m+    -config config.toml \[0m
    [37m+[0m
    [37m+# Do not remove this line; it prevents trouble with the trailing backslashes above.[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/gitlab-workhorse/log/run] action create
    [32m- create new file /opt/gitlab/sv/gitlab-workhorse/log/run[0m
    [32m- update content in file /opt/gitlab/sv/gitlab-workhorse/log/run from none to 6ed0e1[0m
    [37m--- /opt/gitlab/sv/gitlab-workhorse/log/run	2018-05-30 10:04:43.593708669 +0000[0m
    [37m+++ /opt/gitlab/sv/gitlab-workhorse/log/.chef-run20180530-48-p5r0z0	2018-05-30 10:04:43.593708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/gitlab-workhorse[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/gitlab-workhorse/config] action create
    [32m- create new file /var/log/gitlab/gitlab-workhorse/config[0m
    [32m- update content in file /var/log/gitlab/gitlab-workhorse/config from none to 623c00[0m
    [37m--- /var/log/gitlab/gitlab-workhorse/config	2018-05-30 10:04:43.623708669 +0000[0m
    [37m+++ /var/log/gitlab/gitlab-workhorse/.chef-config20180530-48-ybaco6	2018-05-30 10:04:43.613708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload gitlab-workhorse svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart gitlab-workhorse svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/gitlab-workhorse/down] action delete (up to date)
  * link[/opt/gitlab/init/gitlab-workhorse] action create
    [32m- create symlink at /opt/gitlab/init/gitlab-workhorse to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/gitlab-workhorse] action create
    [32m- create symlink at /opt/gitlab/service/gitlab-workhorse to /opt/gitlab/sv/gitlab-workhorse[0m
[0m  * ruby_block[supervise_gitlab-workhorse_sleep] action run
    [32m- execute the ruby block supervise_gitlab-workhorse_sleep[0m
[0m  * directory[/opt/gitlab/sv/gitlab-workhorse/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/gitlab-workhorse/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/gitlab-workhorse/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/gitlab-workhorse/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/gitlab-workhorse/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/gitlab-workhorse/log/supervise/control] action touch (skipped due to only_if)
  * service[gitlab-workhorse] action nothing (skipped due to action :nothing)
  * file[/var/opt/gitlab/gitlab-workhorse/VERSION] action create
    [32m- create new file /var/opt/gitlab/gitlab-workhorse/VERSION[0m
    [32m- update content in file /var/opt/gitlab/gitlab-workhorse/VERSION from none to 49d2d7[0m
    [37m--- /var/opt/gitlab/gitlab-workhorse/VERSION	2018-05-30 10:04:47.663708669 +0000[0m
    [37m+++ /var/opt/gitlab/gitlab-workhorse/.chef-VERSION20180530-48-ydbecs	2018-05-30 10:04:47.663708669 +0000[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+gitlab-workhorse v4.2.0-20180516.154503[0m
[0m  * template[/var/opt/gitlab/gitlab-workhorse/config.toml] action create
    [32m- create new file /var/opt/gitlab/gitlab-workhorse/config.toml[0m
    [32m- update content in file /var/opt/gitlab/gitlab-workhorse/config.toml from none to cb62fe[0m
    [37m--- /var/opt/gitlab/gitlab-workhorse/config.toml	2018-05-30 10:04:47.683708669 +0000[0m
    [37m+++ /var/opt/gitlab/gitlab-workhorse/.chef-config20180530-48-7u51ah.toml	2018-05-30 10:04:47.683708669 +0000[0m
    [37m@@ -1 +1,4 @@[0m
    [37m+[redis][0m
    [37m+URL = "unix:/var/opt/gitlab/redis/redis.socket"[0m
    [37m+Password = ""[0m
    [32m- change owner from '' to 'git'[0m
[0mRecipe: gitlab::mailroom_disable[0m
  * link[/opt/gitlab/service/mailroom] action delete (up to date)
  * directory[/opt/gitlab/sv/mailroom] action delete (up to date)
Recipe: gitlab::nginx[0m
  * directory[/var/opt/gitlab/nginx] action create
    [32m- change mode from '0755' to '0750'[0m
    [32m- change owner from 'gitlab-www' to 'root'[0m
[0m  * directory[/var/opt/gitlab/nginx/conf] action create
    [32m- create new directory /var/opt/gitlab/nginx/conf[0m
    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'gitlab-www'[0m
[0m  * directory[/var/log/gitlab/nginx] action create
    [32m- create new directory /var/log/gitlab/nginx[0m
    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'gitlab-www'[0m
[0m  * link[/var/opt/gitlab/nginx/logs] action create
    [32m- create symlink at /var/opt/gitlab/nginx/logs to /var/log/gitlab/nginx[0m
[0m  * template[/var/opt/gitlab/nginx/conf/gitlab-http.conf] action create
    [32m- create new file /var/opt/gitlab/nginx/conf/gitlab-http.conf[0m
    [32m- update content in file /var/opt/gitlab/nginx/conf/gitlab-http.conf from none to 0bb89b[0m
    [37m--- /var/opt/gitlab/nginx/conf/gitlab-http.conf	2018-05-30 10:04:47.743708669 +0000[0m
    [37m+++ /var/opt/gitlab/nginx/conf/.chef-gitlab-http20180530-48-2dc7sj.conf	2018-05-30 10:04:47.743708669 +0000[0m
    [37m@@ -1 +1,120 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m+## GitLab[0m
    [37m+## Modified from https://gitlab.com/gitlab-org/gitlab-ce/blob/master/lib/support/nginx/gitlab-ssl & https://gitlab.com/gitlab-org/gitlab-ce/blob/master/lib/support/nginx/gitlab[0m
    [37m+##[0m
    [37m+## Lines starting with two hashes (##) are comments with information.[0m
    [37m+## Lines starting with one hash (#) are configuration parameters that can be uncommented.[0m
    [37m+##[0m
    [37m+##################################[0m
    [37m+##        CHUNKED TRANSFER      ##[0m
    [37m+##################################[0m
    [37m+##[0m
    [37m+## It is a known issue that Git-over-HTTP requires chunked transfer encoding [0][0m
    [37m+## which is not supported by Nginx < 1.3.9 [1]. As a result, pushing a large object[0m
    [37m+## with Git (i.e. a single large file) can lead to a 411 error. In theory you can get[0m
    [37m+## around this by tweaking this configuration file and either:[0m
    [37m+## - installing an old version of Nginx with the chunkin module [2] compiled in, or[0m
    [37m+## - using a newer version of Nginx.[0m
    [37m+##[0m
    [37m+## At the time of writing we do not know if either of these theoretical solutions works.[0m
    [37m+## As a workaround users can use Git over SSH to push large files.[0m
    [37m+##[0m
    [37m+## [0] https://git.kernel.org/cgit/git/git.git/tree/Documentation/technical/http-protocol.txt#n99[0m
    [37m+## [1] https://github.com/agentzh/chunkin-nginx-module#status[0m
    [37m+## [2] https://github.com/agentzh/chunkin-nginx-module[0m
    [37m+##[0m
    [37m+###################################[0m
    [37m+##         configuration         ##[0m
    [37m+###################################[0m
    [37m+[0m
    [37m+upstream gitlab-workhorse {[0m
    [37m+  server unix:/var/opt/gitlab/gitlab-workhorse/socket;[0m
    [37m+}[0m
    [37m+[0m
    [37m+[0m
    [37m+server {[0m
    [37m+  listen *:80;[0m
    [37m+[0m
    [37m+[0m
    [37m+  server_name 97ed981a1a04;[0m
    [37m+  server_tokens off; ## Don't show the nginx version number, a security best practice[0m
    [37m+[0m
    [37m+  ## Increase this if you want to upload large attachments[0m
    [37m+  ## Or if you want to accept large git objects over http[0m
    [37m+  client_max_body_size 0;[0m
    [37m+[0m
    [37m+[0m
    [37m+  ## Real IP Module Config[0m
    [37m+  ## http://nginx.org/en/docs/http/ngx_http_realip_module.html[0m
    [37m+[0m
    [37m+  ## HSTS Config[0m
    [37m+  ## https://www.nginx.com/blog/http-strict-transport-security-hsts-and-nginx/[0m
    [37m+  add_header Strict-Transport-Security "max-age=31536000";[0m
    [37m+[0m
    [37m+  ## Individual nginx logs for this GitLab vhost[0m
    [37m+  access_log  /var/log/gitlab/nginx/gitlab_access.log gitlab_access;[0m
    [37m+  error_log   /var/log/gitlab/nginx/gitlab_error.log;[0m
    [37m+[0m
    [37m+  if ($http_host = "") {[0m
    [37m+    set $http_host_with_default "97ed981a1a04";[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  if ($http_host != "") {[0m
    [37m+    set $http_host_with_default $http_host;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  gzip on;[0m
    [37m+  gzip_static on;[0m
    [37m+  gzip_comp_level 2;[0m
    [37m+  gzip_http_version 1.1;[0m
    [37m+  gzip_vary on;[0m
    [37m+  gzip_disable "msie6";[0m
    [37m+  gzip_min_length 10240;[0m
    [37m+  gzip_proxied no-cache no-store private expired auth;[0m
    [37m+  gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/json application/xml application/rss+xml;[0m
    [37m+[0m
    [37m+  ## https://github.com/gitlabhq/gitlabhq/issues/694[0m
    [37m+  ## Some requests take more than 30 seconds.[0m
    [37m+  proxy_read_timeout      3600;[0m
    [37m+  proxy_connect_timeout   300;[0m
    [37m+  proxy_redirect          off;[0m
    [37m+  proxy_http_version 1.1;[0m
    [37m+[0m
    [37m+  proxy_set_header Host $http_host_with_default;[0m
    [37m+  proxy_set_header X-Real-IP $remote_addr;[0m
    [37m+  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;[0m
    [37m+  proxy_set_header Upgrade $http_upgrade;[0m
    [37m+  proxy_set_header Connection $connection_upgrade;[0m
    [37m+  proxy_set_header X-Forwarded-Proto http;[0m
    [37m+[0m
    [37m+  location ~ (\.git/gitlab-lfs/objects|\.git/info/lfs/objects/batch$) {[0m
    [37m+    proxy_cache off;[0m
    [37m+    proxy_pass http://gitlab-workhorse;[0m
    [37m+    proxy_request_buffering off;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  location / {[0m
    [37m+    proxy_cache off;[0m
    [37m+    proxy_pass  http://gitlab-workhorse;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  location /assets {[0m
    [37m+    proxy_cache gitlab;[0m
    [37m+    proxy_pass  http://gitlab-workhorse;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  error_page 404 /404.html;[0m
    [37m+  error_page 422 /422.html;[0m
    [37m+  error_page 500 /500.html;[0m
    [37m+  error_page 502 /502.html;[0m
    [37m+  location ~ ^/(404|422|500|502)(-custom)?\.html$ {[0m
    [37m+    root /opt/gitlab/embedded/service/gitlab-rails/public;[0m
    [37m+    internal;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  [0m
    [37m+}[0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/opt/gitlab/nginx/conf/gitlab-pages.conf] action delete (up to date)
  * template[/var/opt/gitlab/nginx/conf/gitlab-registry.conf] action delete (up to date)
  * template[/var/opt/gitlab/nginx/conf/gitlab-mattermost-http.conf] action delete (up to date)
  * template[/var/opt/gitlab/nginx/conf/nginx-status.conf] action create
    [32m- create new file /var/opt/gitlab/nginx/conf/nginx-status.conf[0m
    [32m- update content in file /var/opt/gitlab/nginx/conf/nginx-status.conf from none to bee808[0m
    [37m--- /var/opt/gitlab/nginx/conf/nginx-status.conf	2018-05-30 10:04:47.813708669 +0000[0m
    [37m+++ /var/opt/gitlab/nginx/conf/.chef-nginx-status20180530-48-n1vahv.conf	2018-05-30 10:04:47.813708669 +0000[0m
    [37m@@ -1 +1,12 @@[0m
    [37m+server  {[0m
    [37m+    listen *:8060;[0m
    [37m+    server_name localhost;[0m
    [37m+    location /nginx_status {[0m
    [37m+      stub_status on;[0m
    [37m+      server_tokens off;[0m
    [37m+      access_log off;[0m
    [37m+      allow 127.0.0.1;[0m
    [37m+      deny all;[0m
    [37m+    }[0m
    [37m+}[0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/opt/gitlab/nginx/conf/nginx.conf] action create
    [32m- create new file /var/opt/gitlab/nginx/conf/nginx.conf[0m
    [32m- update content in file /var/opt/gitlab/nginx/conf/nginx.conf from none to a52cd0[0m
    [37m--- /var/opt/gitlab/nginx/conf/nginx.conf	2018-05-30 10:04:47.843708669 +0000[0m
    [37m+++ /var/opt/gitlab/nginx/conf/.chef-nginx20180530-48-148f3pf.conf	2018-05-30 10:04:47.843708669 +0000[0m
    [37m@@ -1 +1,83 @@[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run `sudo gitlab-ctl reconfigure`.[0m
    [37m+[0m
    [37m+user gitlab-www gitlab-www;[0m
    [37m+worker_processes 1;[0m
    [37m+error_log stderr;[0m
    [37m+pid nginx.pid;[0m
    [37m+[0m
    [37m+daemon off;[0m
    [37m+[0m
    [37m+events {[0m
    [37m+  worker_connections 10240;[0m
    [37m+}[0m
    [37m+[0m
    [37m+http {[0m
    [37m+  log_format gitlab_access '$remote_addr - $remote_user [$time_local] "$request_method $filtered_request_uri $server_protocol" $status $body_bytes_sent "$filtered_http_referer" "$http_user_agent"';[0m
    [37m+  log_format gitlab_mattermost_access '$remote_addr - $remote_user [$time_local] "$request_method $filtered_request_uri $server_protocol" $status $body_bytes_sent "$filtered_http_referer" "$http_user_agent"';[0m
    [37m+[0m
    [37m+  server_names_hash_bucket_size 64;[0m
    [37m+[0m
    [37m+  sendfile on;[0m
    [37m+  tcp_nopush on;[0m
    [37m+  tcp_nodelay on;[0m
    [37m+[0m
    [37m+  keepalive_timeout 65;[0m
    [37m+[0m
    [37m+  gzip on;[0m
    [37m+  gzip_http_version 1.0;[0m
    [37m+  gzip_comp_level 2;[0m
    [37m+  gzip_proxied any;[0m
    [37m+  gzip_types text/plain text/css application/x-javascript text/xml application/xml application/xml+rss text/javascript application/json;[0m
    [37m+[0m
    [37m+  include /opt/gitlab/embedded/conf/mime.types;[0m
    [37m+[0m
    [37m+  proxy_cache_path proxy_cache keys_zone=gitlab:10m max_size=1g levels=1:2;[0m
    [37m+  proxy_cache gitlab;[0m
    [37m+[0m
    [37m+  map $http_upgrade $connection_upgrade {[0m
    [37m+      default upgrade;[0m
    [37m+      ''      close;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  # Remove private_token from the request URI[0m
    [37m+  # In:  /foo?private_token=unfiltered&authenticity_token=unfiltered&rss_token=unfiltered&...[0m
    [37m+  # Out: /foo?private_token=[FILTERED]&authenticity_token=unfiltered&rss_token=unfiltered&...[0m
    [37m+  map $request_uri $temp_request_uri_1 {[0m
    [37m+    default $request_uri;[0m
    [37m+    ~(?i)^(?<start>.*)(?<temp>[\?&]private[\-_]token)=[^&]*(?<rest>.*)$ "$start$temp=[FILTERED]$rest";[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  # Remove authenticity_token from the request URI[0m
    [37m+  # In:  /foo?private_token=[FILTERED]&authenticity_token=unfiltered&rss_token=unfiltered&...[0m
    [37m+  # Out: /foo?private_token=[FILTERED]&authenticity_token=[FILTERED]&rss_token=unfiltered&...[0m
    [37m+  map $temp_request_uri_1 $temp_request_uri_2 {[0m
    [37m+    default $temp_request_uri_1;[0m
    [37m+    ~(?i)^(?<start>.*)(?<temp>[\?&]authenticity[\-_]token)=[^&]*(?<rest>.*)$ "$start$temp=[FILTERED]$rest";[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  # Remove rss_token from the request URI[0m
    [37m+  # In:  /foo?private_token=[FILTERED]&authenticity_token=[FILTERED]&rss_token=unfiltered&...[0m
    [37m+  # Out: /foo?private_token=[FILTERED]&authenticity_token=[FILTERED]&rss_token=[FILTERED]&...[0m
    [37m+  map $temp_request_uri_2 $filtered_request_uri {[0m
    [37m+    default $temp_request_uri_2;[0m
    [37m+    ~(?i)^(?<start>.*)(?<temp>[\?&]rss[\-_]token)=[^&]*(?<rest>.*)$ "$start$temp=[FILTERED]$rest";[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  # A version of the referer without the query string[0m
    [37m+  map $http_referer $filtered_http_referer {[0m
    [37m+    default $http_referer;[0m
    [37m+    ~^(?<temp>.*)\? $temp;[0m
    [37m+  }[0m
    [37m+[0m
    [37m+  include /var/opt/gitlab/nginx/conf/gitlab-http.conf;[0m
    [37m+[0m
    [37m+[0m
    [37m+[0m
    [37m+[0m
    [37m+  include /var/opt/gitlab/nginx/conf/nginx-status.conf;[0m
    [37m+[0m
    [37m+  [0m
    [37m+}[0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0mRecipe: nginx::enable[0m
  * directory[/opt/gitlab/sv/nginx] action create
    [32m- create new directory /opt/gitlab/sv/nginx[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/nginx/log] action create
    [32m- create new directory /opt/gitlab/sv/nginx/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/nginx/log/main] action create
    [32m- create new directory /opt/gitlab/sv/nginx/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/nginx/run] action create
    [32m- create new file /opt/gitlab/sv/nginx/run[0m
    [32m- update content in file /opt/gitlab/sv/nginx/run from none to d75aea[0m
    [37m--- /opt/gitlab/sv/nginx/run	2018-05-30 10:04:47.903708669 +0000[0m
    [37m+++ /opt/gitlab/sv/nginx/.chef-run20180530-48-1y77p5y	2018-05-30 10:04:47.903708669 +0000[0m
    [37m@@ -1 +1,6 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+cd /var/opt/gitlab/nginx[0m
    [37m+exec chpst -P /opt/gitlab/embedded/sbin/nginx -p /var/opt/gitlab/nginx[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/nginx/log/run] action create
    [32m- create new file /opt/gitlab/sv/nginx/log/run[0m
    [32m- update content in file /opt/gitlab/sv/nginx/log/run from none to c70025[0m
    [37m--- /opt/gitlab/sv/nginx/log/run	2018-05-30 10:04:47.933708669 +0000[0m
    [37m+++ /opt/gitlab/sv/nginx/log/.chef-run20180530-48-6z7ly4	2018-05-30 10:04:47.933708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/nginx[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/nginx/config] action create
    [32m- create new file /var/log/gitlab/nginx/config[0m
    [32m- update content in file /var/log/gitlab/nginx/config from none to 623c00[0m
    [37m--- /var/log/gitlab/nginx/config	2018-05-30 10:04:47.943708669 +0000[0m
    [37m+++ /var/log/gitlab/nginx/.chef-config20180530-48-gcjny6	2018-05-30 10:04:47.943708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload nginx svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart nginx svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/nginx/down] action delete (up to date)
  * link[/opt/gitlab/init/nginx] action create
    [32m- create symlink at /opt/gitlab/init/nginx to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/nginx] action create
    [32m- create symlink at /opt/gitlab/service/nginx to /opt/gitlab/sv/nginx[0m
[0m  * ruby_block[supervise_nginx_sleep] action run
    [32m- execute the ruby block supervise_nginx_sleep[0m
[0m  * directory[/opt/gitlab/sv/nginx/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/nginx/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/nginx/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/nginx/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/nginx/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/nginx/log/supervise/control] action touch (skipped due to only_if)
  * service[nginx] action nothing (skipped due to action :nothing)
  * execute[reload nginx] action nothing (skipped due to action :nothing)
Recipe: gitlab::nginx[0m
  * execute[/opt/gitlab/bin/gitlab-ctl start nginx] action run
    [execute] ok: run: nginx: (pid 988) 3s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start nginx[0m
[0mRecipe: gitlab::remote-syslog_disable[0m
  * link[/opt/gitlab/service/remote-syslog] action delete (up to date)
  * directory[/opt/gitlab/sv/remote-syslog] action delete (up to date)
Recipe: gitlab::logrotate[0m
  * directory[/opt/gitlab/sv/logrotate] action create
    [32m- create new directory /opt/gitlab/sv/logrotate[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/logrotate/log] action create
    [32m- create new directory /opt/gitlab/sv/logrotate/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/logrotate/log/main] action create
    [32m- create new directory /opt/gitlab/sv/logrotate/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/logrotate/run] action create
    [32m- create new file /opt/gitlab/sv/logrotate/run[0m
    [32m- update content in file /opt/gitlab/sv/logrotate/run from none to 07f1b6[0m
    [37m--- /opt/gitlab/sv/logrotate/run	2018-05-30 10:04:51.253708669 +0000[0m
    [37m+++ /opt/gitlab/sv/logrotate/.chef-run20180530-48-1qlmzqt	2018-05-30 10:04:51.253708669 +0000[0m
    [37m@@ -1 +1,11 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+cd /var/opt/gitlab/logrotate[0m
    [37m+[0m
    [37m+exec /opt/gitlab/embedded/bin/chpst -P /usr/bin/env \[0m
    [37m+  dir=/var/opt/gitlab/logrotate \[0m
    [37m+  pre_sleep=600 \[0m
    [37m+  post_sleep=3000 \[0m
    [37m+  /opt/gitlab/embedded/bin/gitlab-logrotate-wrapper[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/logrotate/log/run] action create
    [32m- create new file /opt/gitlab/sv/logrotate/log/run[0m
    [32m- update content in file /opt/gitlab/sv/logrotate/log/run from none to 94afe6[0m
    [37m--- /opt/gitlab/sv/logrotate/log/run	2018-05-30 10:04:51.283708669 +0000[0m
    [37m+++ /opt/gitlab/sv/logrotate/log/.chef-run20180530-48-12mn0n8	2018-05-30 10:04:51.283708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/logrotate[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/logrotate/config] action create
    [32m- create new file /var/log/gitlab/logrotate/config[0m
    [32m- update content in file /var/log/gitlab/logrotate/config from none to 623c00[0m
    [37m--- /var/log/gitlab/logrotate/config	2018-05-30 10:04:51.303708669 +0000[0m
    [37m+++ /var/log/gitlab/logrotate/.chef-config20180530-48-1j9bqqk	2018-05-30 10:04:51.303708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload logrotate svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart logrotate svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/logrotate/down] action delete (up to date)
  * directory[/opt/gitlab/sv/logrotate/control] action create
    [32m- create new directory /opt/gitlab/sv/logrotate/control[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/logrotate/control/t] action create
    [32m- create new file /opt/gitlab/sv/logrotate/control/t[0m
    [32m- update content in file /opt/gitlab/sv/logrotate/control/t from none to 8fa3fa[0m
    [37m--- /opt/gitlab/sv/logrotate/control/t	2018-05-30 10:04:51.333708669 +0000[0m
    [37m+++ /opt/gitlab/sv/logrotate/control/.chef-t20180530-48-vvfab5	2018-05-30 10:04:51.333708669 +0000[0m
    [37m@@ -1 +1,4 @@[0m
    [37m+#!/bin/sh[0m
    [37m+echo "Received TERM from runit, sending to process group (-PID)"[0m
    [37m+kill -- -$(cat /opt/gitlab/service/logrotate/supervise/pid)[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * link[/opt/gitlab/init/logrotate] action create
    [32m- create symlink at /opt/gitlab/init/logrotate to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/logrotate] action create
    [32m- create symlink at /opt/gitlab/service/logrotate to /opt/gitlab/sv/logrotate[0m
[0m  * ruby_block[supervise_logrotate_sleep] action run
    [32m- execute the ruby block supervise_logrotate_sleep[0m
[0m  * directory[/opt/gitlab/sv/logrotate/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/logrotate/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/logrotate/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/logrotate/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/logrotate/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/logrotate/log/supervise/control] action touch (skipped due to only_if)
  * service[logrotate] action nothing (skipped due to action :nothing)
  * execute[/opt/gitlab/bin/gitlab-ctl start logrotate] action run
    [execute] ok: run: logrotate: (pid 1008) 2s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start logrotate[0m
[0mRecipe: gitlab::bootstrap[0m
  * file[/var/opt/gitlab/bootstrapped] action create
    [32m- create new file /var/opt/gitlab/bootstrapped[0m
    [32m- update content in file /var/opt/gitlab/bootstrapped from none to 4ae00c[0m
    [37m--- /var/opt/gitlab/bootstrapped	2018-05-30 10:04:56.613708669 +0000[0m
    [37m+++ /var/opt/gitlab/.chef-bootstrapped20180530-48-x8wqbv	2018-05-30 10:04:56.613708669 +0000[0m
    [37m@@ -1 +1,2 @@[0m
    [37m+All your bootstraps are belong to Chef[0m
    [32m- change mode from '' to '0600'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0mRecipe: gitlab::gitlab-pages_disable[0m
  * link[/opt/gitlab/service/gitlab-pages] action delete (up to date)
  * directory[/opt/gitlab/sv/gitlab-pages] action delete (up to date)
Recipe: gitlab::storage-check_disable[0m
  * link[/opt/gitlab/service/storage-check] action delete (up to date)
  * directory[/opt/gitlab/sv/storage-check] action delete (up to date)
Recipe: registry::disable[0m
  * link[/opt/gitlab/service/registry] action delete (up to date)
  * directory[/opt/gitlab/sv/registry] action delete (up to date)
Recipe: gitaly::enable[0m
  * directory[/var/opt/gitlab/gitaly] action create
    [32m- create new directory /var/opt/gitlab/gitaly[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[/var/log/gitlab/gitaly] action create
    [32m- create new directory /var/log/gitlab/gitaly[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * env_dir[/opt/gitlab/etc/gitaly] action create
    * directory[/opt/gitlab/etc/gitaly] action create
      [32m- create new directory /opt/gitlab/etc/gitaly[0m
[0m    * file[/opt/gitlab/etc/gitaly/HOME] action create
      [32m- create new file /opt/gitlab/etc/gitaly/HOME[0m
      [32m- update content in file /opt/gitlab/etc/gitaly/HOME from none to 205bb9[0m
      [37m--- /opt/gitlab/etc/gitaly/HOME	2018-05-30 10:04:56.673708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitaly/.chef-HOME20180530-48-xdcyxa	2018-05-30 10:04:56.673708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+/var/opt/gitlab[0m
[0m    * file[/opt/gitlab/etc/gitaly/PATH] action create
      [32m- create new file /opt/gitlab/etc/gitaly/PATH[0m
      [32m- update content in file /opt/gitlab/etc/gitaly/PATH from none to d5dc07[0m
      [37m--- /opt/gitlab/etc/gitaly/PATH	2018-05-30 10:04:56.673708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitaly/.chef-PATH20180530-48-1qqgw6	2018-05-30 10:04:56.673708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+/opt/gitlab/bin:/opt/gitlab/embedded/bin:/bin:/usr/bin[0m
[0m    * file[/opt/gitlab/etc/gitaly/TZ] action create
      [32m- create new file /opt/gitlab/etc/gitaly/TZ[0m
      [32m- update content in file /opt/gitlab/etc/gitaly/TZ from none to 983a95[0m
      [37m--- /opt/gitlab/etc/gitaly/TZ	2018-05-30 10:04:56.683708669 +0000[0m
      [37m+++ /opt/gitlab/etc/gitaly/.chef-TZ20180530-48-1pxz7d2	2018-05-30 10:04:56.683708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+:/etc/localtime[0m
[0m  
[0m  * template[Create Gitaly config.toml] action create
    [32m- create new file /var/opt/gitlab/gitaly/config.toml[0m
    [32m- update content in file /var/opt/gitlab/gitaly/config.toml from none to e62e01[0m
    [37m--- /var/opt/gitlab/gitaly/config.toml	2018-05-30 10:04:56.703708669 +0000[0m
    [37m+++ /var/opt/gitlab/gitaly/.chef-config20180530-48-rtjckm.toml	2018-05-30 10:04:56.703708669 +0000[0m
    [37m@@ -1 +1,28 @@[0m
    [37m+# Gitaly configuration file[0m
    [37m+# This file is managed by gitlab-ctl. Manual changes will be[0m
    [37m+# erased! To change the contents below, edit /etc/gitlab/gitlab.rb[0m
    [37m+# and run:[0m
    [37m+# sudo gitlab-ctl reconfigure[0m
    [37m+[0m
    [37m+socket_path = '/var/opt/gitlab/gitaly/gitaly.socket'[0m
    [37m+bin_dir = '/opt/gitlab/embedded/bin'[0m
    [37m+[0m
    [37m+[0m
    [37m+# Optional: export metrics via Prometheus[0m
    [37m+prometheus_listen_addr = 'localhost:9236'[0m
    [37m+[0m
    [37m+[[storage]][0m
    [37m+name = 'default'[0m
    [37m+path = '/var/opt/gitlab/git-data/repositories'[0m
    [37m+[0m
    [37m+[logging][0m
    [37m+[0m
    [37m+[0m
    [37m+[auth][0m
    [37m+[0m
    [37m+[gitaly-ruby][0m
    [37m+dir = "/opt/gitlab/embedded/service/gitaly-ruby"[0m
    [37m+[0m
    [37m+[gitlab-shell][0m
    [37m+dir = "/opt/gitlab/embedded/service/gitlab-shell"[0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/gitaly] action create
    [32m- create new directory /opt/gitlab/sv/gitaly[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/gitaly/log] action create
    [32m- create new directory /opt/gitlab/sv/gitaly/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/gitaly/log/main] action create
    [32m- create new directory /opt/gitlab/sv/gitaly/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/gitaly/run] action create
    [32m- create new file /opt/gitlab/sv/gitaly/run[0m
    [32m- update content in file /opt/gitlab/sv/gitaly/run from none to ca190e[0m
    [37m--- /opt/gitlab/sv/gitaly/run	2018-05-30 10:04:56.763708669 +0000[0m
    [37m+++ /opt/gitlab/sv/gitaly/.chef-run20180530-48-5p2xlm	2018-05-30 10:04:56.763708669 +0000[0m
    [37m@@ -1 +1,15 @@[0m
    [37m+#!/bin/sh[0m
    [37m+set -e # fail on errors[0m
    [37m+[0m
    [37m+# Redirect stderr -> stdout[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+[0m
    [37m+[0m
    [37m+cd /var/opt/gitlab/gitaly[0m
    [37m+[0m
    [37m+exec chpst -e /opt/gitlab/etc/gitaly -P \[0m
    [37m+  -U git \[0m
    [37m+  -u git \[0m
    [37m+  /opt/gitlab/embedded/bin/gitaly /var/opt/gitlab/gitaly/config.toml[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/gitaly/log/run] action create
    [32m- create new file /opt/gitlab/sv/gitaly/log/run[0m
    [32m- update content in file /opt/gitlab/sv/gitaly/log/run from none to 0627d2[0m
    [37m--- /opt/gitlab/sv/gitaly/log/run	2018-05-30 10:04:56.793708669 +0000[0m
    [37m+++ /opt/gitlab/sv/gitaly/log/.chef-run20180530-48-1l6ha9y	2018-05-30 10:04:56.793708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/gitaly[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/gitaly/config] action create
    [32m- create new file /var/log/gitlab/gitaly/config[0m
    [32m- update content in file /var/log/gitlab/gitaly/config from none to 623c00[0m
    [37m--- /var/log/gitlab/gitaly/config	2018-05-30 10:04:56.803708669 +0000[0m
    [37m+++ /var/log/gitlab/gitaly/.chef-config20180530-48-g3ido2	2018-05-30 10:04:56.803708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload gitaly svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart gitaly svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/gitaly/down] action delete (up to date)
  * link[/opt/gitlab/init/gitaly] action create
    [32m- create symlink at /opt/gitlab/init/gitaly to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/gitaly] action create
    [32m- create symlink at /opt/gitlab/service/gitaly to /opt/gitlab/sv/gitaly[0m
[0m  * ruby_block[supervise_gitaly_sleep] action run
    [32m- execute the ruby block supervise_gitaly_sleep[0m
[0m  * directory[/opt/gitlab/sv/gitaly/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/gitaly/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/gitaly/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/gitaly/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/gitaly/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/gitaly/log/supervise/control] action touch (skipped due to only_if)
  * service[gitaly] action nothing (skipped due to action :nothing)
  * execute[/opt/gitlab/bin/gitlab-ctl start gitaly] action run
    [execute] ok: run: gitaly: (pid 1024) 4s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start gitaly[0m
[0mRecipe: mattermost::disable[0m
  * link[/opt/gitlab/service/mattermost] action delete (up to date)
  * directory[/opt/gitlab/sv/mattermost] action delete (up to date)
Recipe: gitlab::gitlab-healthcheck[0m
  * template[/opt/gitlab/etc/gitlab-healthcheck-rc] action create
    [32m- create new file /opt/gitlab/etc/gitlab-healthcheck-rc[0m
    [32m- update content in file /opt/gitlab/etc/gitlab-healthcheck-rc from none to 6da55f[0m
    [37m--- /opt/gitlab/etc/gitlab-healthcheck-rc	2018-05-30 10:05:04.653708669 +0000[0m
    [37m+++ /opt/gitlab/etc/.chef-gitlab-healthcheck-rc20180530-48-r2gma8	2018-05-30 10:05:04.653708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+url='http://localhost:80/help'[0m
    [37m+flags='--insecure'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0mRecipe: gitlab::prometheus_user[0m
  * account[Prometheus user and group] action create (up to date)
Recipe: gitlab::node-exporter[0m
  * directory[/var/log/gitlab/node-exporter] action create
    [32m- create new directory /var/log/gitlab/node-exporter[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
[0m  * directory[/var/opt/gitlab/node-exporter/textfile_collector] action create
    [32m- create new directory /var/opt/gitlab/node-exporter/textfile_collector[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
[0m  * directory[/opt/gitlab/sv/node-exporter] action create
    [32m- create new directory /opt/gitlab/sv/node-exporter[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/node-exporter/log] action create
    [32m- create new directory /opt/gitlab/sv/node-exporter/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/node-exporter/log/main] action create
    [32m- create new directory /opt/gitlab/sv/node-exporter/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/node-exporter/run] action create
    [32m- create new file /opt/gitlab/sv/node-exporter/run[0m
    [32m- update content in file /opt/gitlab/sv/node-exporter/run from none to e2ca0b[0m
    [37m--- /opt/gitlab/sv/node-exporter/run	2018-05-30 10:05:04.793708669 +0000[0m
    [37m+++ /opt/gitlab/sv/node-exporter/.chef-run20180530-48-1kfthji	2018-05-30 10:05:04.793708669 +0000[0m
    [37m@@ -1 +1,6 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+umask 077[0m
    [37m+exec chpst -P -U gitlab-prometheus -u gitlab-prometheus /opt/gitlab/embedded/bin/node_exporter --web.listen-address=localhost:9100 --collector.textfile.directory=/var/opt/gitlab/node-exporter/textfile_collector[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/node-exporter/log/run] action create
    [32m- create new file /opt/gitlab/sv/node-exporter/log/run[0m
    [32m- update content in file /opt/gitlab/sv/node-exporter/log/run from none to ae1796[0m
    [37m--- /opt/gitlab/sv/node-exporter/log/run	2018-05-30 10:05:04.843708669 +0000[0m
    [37m+++ /opt/gitlab/sv/node-exporter/log/.chef-run20180530-48-70qcly	2018-05-30 10:05:04.843708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/node-exporter[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/node-exporter/config] action create
    [32m- create new file /var/log/gitlab/node-exporter/config[0m
    [32m- update content in file /var/log/gitlab/node-exporter/config from none to 623c00[0m
    [37m--- /var/log/gitlab/node-exporter/config	2018-05-30 10:05:04.893708669 +0000[0m
    [37m+++ /var/log/gitlab/node-exporter/.chef-config20180530-48-1kcuvsu	2018-05-30 10:05:04.893708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload node-exporter svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart node-exporter svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/node-exporter/down] action delete (up to date)
  * link[/opt/gitlab/init/node-exporter] action create
    [32m- create symlink at /opt/gitlab/init/node-exporter to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/node-exporter] action create
    [32m- create symlink at /opt/gitlab/service/node-exporter to /opt/gitlab/sv/node-exporter[0m
[0m  * ruby_block[supervise_node-exporter_sleep] action run
    [32m- execute the ruby block supervise_node-exporter_sleep[0m
[0m  * directory[/opt/gitlab/sv/node-exporter/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/node-exporter/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/node-exporter/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/node-exporter/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/node-exporter/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/node-exporter/log/supervise/control] action touch (skipped due to only_if)
  * service[node-exporter] action nothing (skipped due to action :nothing)
  * execute[/opt/gitlab/bin/gitlab-ctl start node-exporter] action run
    [execute] ok: run: node-exporter: (pid 1056) 5s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start node-exporter[0m
[0mRecipe: gitlab::gitlab-monitor[0m
  * directory[/var/opt/gitlab/gitlab-monitor] action create
    [32m- create new directory /var/opt/gitlab/gitlab-monitor[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[/var/log/gitlab/gitlab-monitor] action create
    [32m- create new directory /var/log/gitlab/gitlab-monitor[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * template[/var/opt/gitlab/gitlab-monitor/gitlab-monitor.yml] action create
    [32m- create new file /var/opt/gitlab/gitlab-monitor/gitlab-monitor.yml[0m
    [32m- update content in file /var/opt/gitlab/gitlab-monitor/gitlab-monitor.yml from none to 595ab9[0m
    [37m--- /var/opt/gitlab/gitlab-monitor/gitlab-monitor.yml	2018-05-30 10:05:11.343708669 +0000[0m
    [37m+++ /var/opt/gitlab/gitlab-monitor/.chef-gitlab-monitor20180530-48-fh3170.yml	2018-05-30 10:05:11.343708669 +0000[0m
    [37m@@ -1 +1,58 @@[0m
    [37m+db_common: &db_common[0m
    [37m+  methods:[0m
    [37m+    - probe_db[0m
    [37m+  opts:[0m
    [37m+    connection_string: dbname=gitlabhq_production user=gitlab host=/var/opt/gitlab/postgresql port=5432 password=[0m
    [37m+[0m
    [37m+# Web server config[0m
    [37m+server:[0m
    [37m+  listen_address: localhost[0m
    [37m+  listen_port: 9168[0m
    [37m+[0m
    [37m+# Probes config[0m
    [37m+probes:[0m
    [37m+  git_process:[0m
    [37m+    class_name: GitProcessProber # `class_name` is redundant here[0m
    [37m+    methods:[0m
    [37m+    - probe_git[0m
    [37m+    opts:[0m
    [37m+      quantiles: true[0m
    [37m+[0m
    [37m+  # We can group multiple probes under a single endpoint by setting the `multiple` key to `true`, followed[0m
    [37m+  # by probe definitions as usual.[0m
    [37m+  database:[0m
    [37m+    multiple: true[0m
    [37m+    ci_builds:[0m
    [37m+      class_name: Database::CiBuildsProber[0m
    [37m+      <<: *db_common[0m
    [37m+    tuple_stats:[0m
    [37m+      class_name: Database::TuplesProber[0m
    [37m+      <<: *db_common[0m
    [37m+    rows_count:[0m
    [37m+      class_name: Database::RowCountProber[0m
    [37m+      <<: *db_common[0m
    [37m+[0m
    [37m+  process:[0m
    [37m+    methods:[0m
    [37m+      - probe_memory[0m
    [37m+      - probe_age[0m
    [37m+      - probe_count[0m
    [37m+    opts:[0m
    [37m+      - pid_or_pattern: "sidekiq .* \\[.*?\\]"[0m
    [37m+        name: sidekiq[0m
    [37m+      - pid_or_pattern: "unicorn worker\\[.*?\\]"[0m
    [37m+        name: unicorn[0m
    [37m+      - pid_or_pattern: "git-upload-pack --stateless-rpc"[0m
    [37m+        name: git_upload_pack[0m
    [37m+        quantiles: true[0m
    [37m+[0m
    [37m+  sidekiq:[0m
    [37m+    methods:[0m
    [37m+      - probe_queues[0m
    [37m+      - probe_jobs[0m
    [37m+      - probe_workers[0m
    [37m+      - probe_retries[0m
    [37m+      - probe_dead[0m
    [37m+    opts:[0m
    [37m+      redis_url: "unix:/var/opt/gitlab/redis/redis.socket"[0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'git'[0m
[0m  * directory[/opt/gitlab/sv/gitlab-monitor] action create
    [32m- create new directory /opt/gitlab/sv/gitlab-monitor[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/gitlab-monitor/log] action create
    [32m- create new directory /opt/gitlab/sv/gitlab-monitor/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/gitlab-monitor/log/main] action create
    [32m- create new directory /opt/gitlab/sv/gitlab-monitor/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/gitlab-monitor/run] action create
    [32m- create new file /opt/gitlab/sv/gitlab-monitor/run[0m
    [32m- update content in file /opt/gitlab/sv/gitlab-monitor/run from none to 2f480f[0m
    [37m--- /opt/gitlab/sv/gitlab-monitor/run	2018-05-30 10:05:11.423708669 +0000[0m
    [37m+++ /opt/gitlab/sv/gitlab-monitor/.chef-run20180530-48-107mxjr	2018-05-30 10:05:11.423708669 +0000[0m
    [37m@@ -1 +1,6 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+umask 077[0m
    [37m+exec chpst -P -U git -u git /opt/gitlab/embedded/bin/gitlab-mon web -c /var/opt/gitlab/gitlab-monitor/gitlab-monitor.yml[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/gitlab-monitor/log/run] action create
    [32m- create new file /opt/gitlab/sv/gitlab-monitor/log/run[0m
    [32m- update content in file /opt/gitlab/sv/gitlab-monitor/log/run from none to be403a[0m
    [37m--- /opt/gitlab/sv/gitlab-monitor/log/run	2018-05-30 10:05:11.453708669 +0000[0m
    [37m+++ /opt/gitlab/sv/gitlab-monitor/log/.chef-run20180530-48-jz4mly	2018-05-30 10:05:11.453708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/gitlab-monitor[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/gitlab-monitor/config] action create
    [32m- create new file /var/log/gitlab/gitlab-monitor/config[0m
    [32m- update content in file /var/log/gitlab/gitlab-monitor/config from none to 623c00[0m
    [37m--- /var/log/gitlab/gitlab-monitor/config	2018-05-30 10:05:11.473708669 +0000[0m
    [37m+++ /var/log/gitlab/gitlab-monitor/.chef-config20180530-48-1yiorip	2018-05-30 10:05:11.473708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload gitlab-monitor svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart gitlab-monitor svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/gitlab-monitor/down] action delete (up to date)
  * link[/opt/gitlab/init/gitlab-monitor] action create
    [32m- create symlink at /opt/gitlab/init/gitlab-monitor to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/gitlab-monitor] action create
    [32m- create symlink at /opt/gitlab/service/gitlab-monitor to /opt/gitlab/sv/gitlab-monitor[0m
[0m  * ruby_block[supervise_gitlab-monitor_sleep] action run
    [32m- execute the ruby block supervise_gitlab-monitor_sleep[0m
[0m  * directory[/opt/gitlab/sv/gitlab-monitor/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/gitlab-monitor/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/gitlab-monitor/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/gitlab-monitor/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/gitlab-monitor/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/gitlab-monitor/log/supervise/control] action touch (skipped due to only_if)
  * service[gitlab-monitor] action nothing (skipped due to action :nothing)
  * execute[/opt/gitlab/bin/gitlab-ctl start gitlab-monitor] action run
    [execute] ok: run: gitlab-monitor: (pid 1145) 4s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start gitlab-monitor[0m
[0mRecipe: gitlab::redis-exporter[0m
  * directory[/var/log/gitlab/redis-exporter] action create
    [32m- create new directory /var/log/gitlab/redis-exporter[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-redis'[0m
[0m  * directory[/opt/gitlab/sv/redis-exporter] action create
    [32m- create new directory /opt/gitlab/sv/redis-exporter[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/redis-exporter/log] action create
    [32m- create new directory /opt/gitlab/sv/redis-exporter/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/redis-exporter/log/main] action create
    [32m- create new directory /opt/gitlab/sv/redis-exporter/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/redis-exporter/run] action create
    [32m- create new file /opt/gitlab/sv/redis-exporter/run[0m
    [32m- update content in file /opt/gitlab/sv/redis-exporter/run from none to fa3e94[0m
    [37m--- /opt/gitlab/sv/redis-exporter/run	2018-05-30 10:05:16.663708669 +0000[0m
    [37m+++ /opt/gitlab/sv/redis-exporter/.chef-run20180530-48-14nog78	2018-05-30 10:05:16.663708669 +0000[0m
    [37m@@ -1 +1,6 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+umask 077[0m
    [37m+exec chpst -P -U gitlab-redis:git -u gitlab-redis:git /opt/gitlab/embedded/bin/redis_exporter -web.listen-address=localhost:9121 -redis.addr=unix:///var/opt/gitlab/redis/redis.socket[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/redis-exporter/log/run] action create
    [32m- create new file /opt/gitlab/sv/redis-exporter/log/run[0m
    [32m- update content in file /opt/gitlab/sv/redis-exporter/log/run from none to 082dea[0m
    [37m--- /opt/gitlab/sv/redis-exporter/log/run	2018-05-30 10:05:16.693708669 +0000[0m
    [37m+++ /opt/gitlab/sv/redis-exporter/log/.chef-run20180530-48-1bphhza	2018-05-30 10:05:16.693708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/redis-exporter[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/redis-exporter/config] action create
    [32m- create new file /var/log/gitlab/redis-exporter/config[0m
    [32m- update content in file /var/log/gitlab/redis-exporter/config from none to 623c00[0m
    [37m--- /var/log/gitlab/redis-exporter/config	2018-05-30 10:05:16.723708669 +0000[0m
    [37m+++ /var/log/gitlab/redis-exporter/.chef-config20180530-48-1qncnbr	2018-05-30 10:05:16.723708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload redis-exporter svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart redis-exporter svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/redis-exporter/down] action delete (up to date)
  * link[/opt/gitlab/init/redis-exporter] action create
    [32m- create symlink at /opt/gitlab/init/redis-exporter to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/redis-exporter] action create
    [32m- create symlink at /opt/gitlab/service/redis-exporter to /opt/gitlab/sv/redis-exporter[0m
[0m  * ruby_block[supervise_redis-exporter_sleep] action run
    [32m- execute the ruby block supervise_redis-exporter_sleep[0m
[0m  * directory[/opt/gitlab/sv/redis-exporter/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/redis-exporter/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/redis-exporter/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/redis-exporter/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/redis-exporter/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/redis-exporter/log/supervise/control] action touch (skipped due to only_if)
  * service[redis-exporter] action nothing (skipped due to action :nothing)
  * execute[/opt/gitlab/bin/gitlab-ctl start redis-exporter] action run
    [execute] ok: run: redis-exporter: (pid 1162) 3s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start redis-exporter[0m
[0mRecipe: gitlab::prometheus[0m
  * directory[/var/opt/gitlab/prometheus] action create
    [32m- change mode from '0755' to '0750'[0m
[0m  * directory[/var/log/gitlab/prometheus] action create
    [32m- create new directory /var/log/gitlab/prometheus[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
[0m  * file[Prometheus config] action create
    [32m- create new file /var/opt/gitlab/prometheus/prometheus.yml[0m
    [32m- update content in file /var/opt/gitlab/prometheus/prometheus.yml from none to 8f79b8[0m
    [37m--- /var/opt/gitlab/prometheus/prometheus.yml	2018-05-30 10:05:21.703708669 +0000[0m
    [37m+++ /var/opt/gitlab/prometheus/.chef-prometheus20180530-48-1v38ac6.yml	2018-05-30 10:05:21.703708669 +0000[0m
    [37m@@ -1 +1,146 @@[0m
    [37m+---[0m
    [37m+global:[0m
    [37m+  scrape_interval: 15s[0m
    [37m+  scrape_timeout: 15s[0m
    [37m+scrape_configs:[0m
    [37m+- job_name: prometheus[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9090[0m
    [37m+- job_name: redis[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9121[0m
    [37m+- job_name: postgres[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9187[0m
    [37m+- job_name: node[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9100[0m
    [37m+- job_name: gitlab-workhorse[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9229[0m
    [37m+- job_name: gitlab-unicorn[0m
    [37m+  metrics_path: "/-/metrics"[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - 127.0.0.1:8080[0m
    [37m+- job_name: gitlab-sidekiq[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - 127.0.0.1:8082[0m
    [37m+- job_name: gitlab_monitor_database[0m
    [37m+  metrics_path: "/database"[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9168[0m
    [37m+- job_name: gitlab_monitor_sidekiq[0m
    [37m+  metrics_path: "/sidekiq"[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9168[0m
    [37m+- job_name: gitlab_monitor_process[0m
    [37m+  metrics_path: "/process"[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9168[0m
    [37m+- job_name: gitaly[0m
    [37m+  static_configs:[0m
    [37m+  - targets:[0m
    [37m+    - localhost:9236[0m
    [37m+- job_name: kubernetes-cadvisor[0m
    [37m+  scheme: https[0m
    [37m+  tls_config:[0m
    [37m+    ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"[0m
    [37m+    insecure_skip_verify: true[0m
    [37m+  bearer_token_file: "/var/run/secrets/kubernetes.io/serviceaccount/token"[0m
    [37m+  kubernetes_sd_configs:[0m
    [37m+  - role: node[0m
    [37m+    api_server: https://kubernetes.default.svc:443[0m
    [37m+    tls_config:[0m
    [37m+      ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"[0m
    [37m+    bearer_token_file: "/var/run/secrets/kubernetes.io/serviceaccount/token"[0m
    [37m+  relabel_configs:[0m
    [37m+  - action: labelmap[0m
    [37m+    regex: __meta_kubernetes_node_label_(.+)[0m
    [37m+  - target_label: __address__[0m
    [37m+    replacement: kubernetes.default.svc:443[0m
    [37m+  - source_labels:[0m
    [37m+    - __meta_kubernetes_node_name[0m
    [37m+    regex: "(.+)"[0m
    [37m+    target_label: __metrics_path__[0m
    [37m+    replacement: "/api/v1/nodes/${1}/proxy/metrics/cadvisor"[0m
    [37m+  metric_relabel_configs:[0m
    [37m+  - source_labels:[0m
    [37m+    - pod_name[0m
    [37m+    target_label: environment[0m
    [37m+    regex: "(.+)-.+-.+"[0m
    [37m+- job_name: kubernetes-nodes[0m
    [37m+  scheme: https[0m
    [37m+  tls_config:[0m
    [37m+    ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"[0m
    [37m+    insecure_skip_verify: true[0m
    [37m+  bearer_token_file: "/var/run/secrets/kubernetes.io/serviceaccount/token"[0m
    [37m+  kubernetes_sd_configs:[0m
    [37m+  - role: node[0m
    [37m+    api_server: https://kubernetes.default.svc:443[0m
    [37m+    tls_config:[0m
    [37m+      ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"[0m
    [37m+    bearer_token_file: "/var/run/secrets/kubernetes.io/serviceaccount/token"[0m
    [37m+  relabel_configs:[0m
    [37m+  - action: labelmap[0m
    [37m+    regex: __meta_kubernetes_node_label_(.+)[0m
    [37m+  - target_label: __address__[0m
    [37m+    replacement: kubernetes.default.svc:443[0m
    [37m+  - source_labels:[0m
    [37m+    - __meta_kubernetes_node_name[0m
    [37m+    regex: "(.+)"[0m
    [37m+    target_label: __metrics_path__[0m
    [37m+    replacement: "/api/v1/nodes/${1}/proxy/metrics"[0m
    [37m+  metric_relabel_configs:[0m
    [37m+  - source_labels:[0m
    [37m+    - pod_name[0m
    [37m+    target_label: environment[0m
    [37m+    regex: "(.+)-.+-.+"[0m
    [37m+- job_name: kubernetes-pods[0m
    [37m+  tls_config:[0m
    [37m+    ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"[0m
    [37m+    insecure_skip_verify: true[0m
    [37m+  bearer_token_file: "/var/run/secrets/kubernetes.io/serviceaccount/token"[0m
    [37m+  kubernetes_sd_configs:[0m
    [37m+  - role: pod[0m
    [37m+    api_server: https://kubernetes.default.svc:443[0m
    [37m+    tls_config:[0m
    [37m+      ca_file: "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt"[0m
    [37m+    bearer_token_file: "/var/run/secrets/kubernetes.io/serviceaccount/token"[0m
    [37m+  relabel_configs:[0m
    [37m+  - source_labels:[0m
    [37m+    - __meta_kubernetes_pod_annotation_prometheus_io_scrape[0m
    [37m+    action: keep[0m
    [37m+    regex: 'true'[0m
    [37m+  - source_labels:[0m
    [37m+    - __meta_kubernetes_pod_annotation_prometheus_io_path[0m
    [37m+    action: replace[0m
    [37m+    target_label: __metrics_path__[0m
    [37m+    regex: "(.+)"[0m
    [37m+  - source_labels:[0m
    [37m+    - __address__[0m
    [37m+    - __meta_kubernetes_pod_annotation_prometheus_io_port[0m
    [37m+    action: replace[0m
    [37m+    regex: "([^:]+)(?::[0-9]+)?;([0-9]+)"[0m
    [37m+    replacement: "$1:$2"[0m
    [37m+    target_label: __address__[0m
    [37m+  - action: labelmap[0m
    [37m+    regex: __meta_kubernetes_pod_label_(.+)[0m
    [37m+  - source_labels:[0m
    [37m+    - __meta_kubernetes_namespace[0m
    [37m+    action: replace[0m
    [37m+    target_label: kubernetes_namespace[0m
    [37m+  - source_labels:[0m
    [37m+    - __meta_kubernetes_pod_name[0m
    [37m+    action: replace[0m
    [37m+    target_label: kubernetes_pod_name[0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
[0m  * directory[/opt/gitlab/sv/prometheus] action create
    [32m- create new directory /opt/gitlab/sv/prometheus[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/prometheus/log] action create
    [32m- create new directory /opt/gitlab/sv/prometheus/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/prometheus/log/main] action create
    [32m- create new directory /opt/gitlab/sv/prometheus/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/prometheus/run] action create
    [32m- create new file /opt/gitlab/sv/prometheus/run[0m
    [32m- update content in file /opt/gitlab/sv/prometheus/run from none to 8ce158[0m
    [37m--- /opt/gitlab/sv/prometheus/run	2018-05-30 10:05:21.803708669 +0000[0m
    [37m+++ /opt/gitlab/sv/prometheus/.chef-run20180530-48-sp9a04	2018-05-30 10:05:21.803708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+umask 077[0m
    [37m+exec chpst -P -U gitlab-prometheus -u gitlab-prometheus \[0m
    [37m+  /opt/gitlab/embedded/bin/prometheus -web.listen-address=localhost:9090 -storage.local.path=/var/opt/gitlab/prometheus/data -storage.local.chunk-encoding-version=2 -storage.local.target-heap-size=47096791 -config.file=/var/opt/gitlab/prometheus/prometheus.yml[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/prometheus/log/run] action create
    [32m- create new file /opt/gitlab/sv/prometheus/log/run[0m
    [32m- update content in file /opt/gitlab/sv/prometheus/log/run from none to 072b20[0m
    [37m--- /opt/gitlab/sv/prometheus/log/run	2018-05-30 10:05:21.813708669 +0000[0m
    [37m+++ /opt/gitlab/sv/prometheus/log/.chef-run20180530-48-o3m2ac	2018-05-30 10:05:21.813708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/prometheus[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/prometheus/config] action create
    [32m- create new file /var/log/gitlab/prometheus/config[0m
    [32m- update content in file /var/log/gitlab/prometheus/config from none to 623c00[0m
    [37m--- /var/log/gitlab/prometheus/config	2018-05-30 10:05:21.843708669 +0000[0m
    [37m+++ /var/log/gitlab/prometheus/.chef-config20180530-48-1n7p3f1	2018-05-30 10:05:21.843708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload prometheus svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart prometheus svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/prometheus/down] action delete (up to date)
  * link[/opt/gitlab/init/prometheus] action create
    [32m- create symlink at /opt/gitlab/init/prometheus to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/prometheus] action create
    [32m- create symlink at /opt/gitlab/service/prometheus to /opt/gitlab/sv/prometheus[0m
[0m  * ruby_block[supervise_prometheus_sleep] action run
    [32m- execute the ruby block supervise_prometheus_sleep[0m
[0m  * directory[/opt/gitlab/sv/prometheus/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/prometheus/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/prometheus/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/prometheus/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/prometheus/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/prometheus/log/supervise/control] action touch (skipped due to only_if)
  * service[prometheus] action nothing (skipped due to action :nothing)
  * execute[/opt/gitlab/bin/gitlab-ctl start prometheus] action run
    [execute] ok: run: prometheus: (pid 1183) 4s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start prometheus[0m
[0mRecipe: gitlab::alertmanager[0m
  * directory[/var/opt/gitlab/alertmanager] action create
    [32m- create new directory /var/opt/gitlab/alertmanager[0m
    [32m- change mode from '' to '0750'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
[0m  * directory[/var/log/gitlab/alertmanager] action create
    [32m- create new directory /var/log/gitlab/alertmanager[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
[0m  * file[Alertmanager config] action create
    [32m- create new file /var/opt/gitlab/alertmanager/alertmanager.yml[0m
    [32m- update content in file /var/opt/gitlab/alertmanager/alertmanager.yml from none to 21b7be[0m
    [37m--- /var/opt/gitlab/alertmanager/alertmanager.yml	2018-05-30 10:05:28.143708669 +0000[0m
    [37m+++ /var/opt/gitlab/alertmanager/.chef-alertmanager20180530-48-u1uo9r.yml	2018-05-30 10:05:28.143708669 +0000[0m
    [37m@@ -1 +1,10 @@[0m
    [37m+---[0m
    [37m+global: {}[0m
    [37m+templates: [][0m
    [37m+route:[0m
    [37m+  receiver: default-receiver[0m
    [37m+  routes: [][0m
    [37m+receivers:[0m
    [37m+- name: default-receiver[0m
    [37m+inhibit_rules: [][0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'gitlab-prometheus'[0m
[0m  * directory[/opt/gitlab/sv/alertmanager] action create
    [32m- create new directory /opt/gitlab/sv/alertmanager[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/alertmanager/log] action create
    [32m- create new directory /opt/gitlab/sv/alertmanager/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/alertmanager/log/main] action create
    [32m- create new directory /opt/gitlab/sv/alertmanager/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/alertmanager/run] action create
    [32m- create new file /opt/gitlab/sv/alertmanager/run[0m
    [32m- update content in file /opt/gitlab/sv/alertmanager/run from none to ac906d[0m
    [37m--- /opt/gitlab/sv/alertmanager/run	2018-05-30 10:05:28.213708669 +0000[0m
    [37m+++ /opt/gitlab/sv/alertmanager/.chef-run20180530-48-1dda7h2	2018-05-30 10:05:28.213708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+umask 077[0m
    [37m+exec chpst -P -U gitlab-prometheus -u gitlab-prometheus \[0m
    [37m+  /opt/gitlab/embedded/bin/alertmanager --web.listen-address=localhost:9093 --storage.path=/var/opt/gitlab/alertmanager/data --config.file=/var/opt/gitlab/alertmanager/alertmanager.yml[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/alertmanager/log/run] action create
    [32m- create new file /opt/gitlab/sv/alertmanager/log/run[0m
    [32m- update content in file /opt/gitlab/sv/alertmanager/log/run from none to 2feab9[0m
    [37m--- /opt/gitlab/sv/alertmanager/log/run	2018-05-30 10:05:28.243708669 +0000[0m
    [37m+++ /opt/gitlab/sv/alertmanager/log/.chef-run20180530-48-1eoggnk	2018-05-30 10:05:28.243708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/alertmanager[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/alertmanager/config] action create
    [32m- create new file /var/log/gitlab/alertmanager/config[0m
    [32m- update content in file /var/log/gitlab/alertmanager/config from none to 623c00[0m
    [37m--- /var/log/gitlab/alertmanager/config	2018-05-30 10:05:28.273708669 +0000[0m
    [37m+++ /var/log/gitlab/alertmanager/.chef-config20180530-48-z5r62r	2018-05-30 10:05:28.273708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload alertmanager svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart alertmanager svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/alertmanager/down] action delete (up to date)
  * link[/opt/gitlab/init/alertmanager] action create
    [32m- create symlink at /opt/gitlab/init/alertmanager to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/alertmanager] action create
    [32m- create symlink at /opt/gitlab/service/alertmanager to /opt/gitlab/sv/alertmanager[0m
[0m  * ruby_block[supervise_alertmanager_sleep] action run
    [32m- execute the ruby block supervise_alertmanager_sleep[0m
[0m  * directory[/opt/gitlab/sv/alertmanager/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/alertmanager/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/alertmanager/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/alertmanager/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/alertmanager/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/alertmanager/log/supervise/control] action touch (skipped due to only_if)
  * service[alertmanager] action nothing (skipped due to action :nothing)
  * execute[/opt/gitlab/bin/gitlab-ctl start alertmanager] action run
    [execute] ok: run: alertmanager: (pid 1207) 4s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start alertmanager[0m
[0mRecipe: gitlab::postgres-exporter[0m
  * directory[/var/log/gitlab/postgres-exporter] action create
    [32m- create new directory /var/log/gitlab/postgres-exporter[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
[0m  * directory[/var/opt/gitlab/postgres-exporter] action create
    [32m- create new directory /var/opt/gitlab/postgres-exporter[0m
    [32m- change mode from '' to '0700'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
[0m  * env_dir[/opt/gitlab/etc/postgres-exporter/env] action create
    * directory[/opt/gitlab/etc/postgres-exporter/env] action create
      [32m- create new directory /opt/gitlab/etc/postgres-exporter/env[0m
[0m    * file[/opt/gitlab/etc/postgres-exporter/env/DATA_SOURCE_NAME] action create
      [32m- create new file /opt/gitlab/etc/postgres-exporter/env/DATA_SOURCE_NAME[0m
      [32m- update content in file /opt/gitlab/etc/postgres-exporter/env/DATA_SOURCE_NAME from none to cd58e5[0m
      [37m--- /opt/gitlab/etc/postgres-exporter/env/DATA_SOURCE_NAME	2018-05-30 10:05:34.153708669 +0000[0m
      [37m+++ /opt/gitlab/etc/postgres-exporter/env/.chef-DATA_SOURCE_NAME20180530-48-10ldxg9	2018-05-30 10:05:34.153708669 +0000[0m
      [37m@@ -1 +1,2 @@[0m
      [37m+user=gitlab-psql host=/var/opt/gitlab/postgresql database=postgres sslmode=allow[0m
[0m  
[0m  * directory[/opt/gitlab/sv/postgres-exporter] action create
    [32m- create new directory /opt/gitlab/sv/postgres-exporter[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/postgres-exporter/log] action create
    [32m- create new directory /opt/gitlab/sv/postgres-exporter/log[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * directory[/opt/gitlab/sv/postgres-exporter/log/main] action create
    [32m- create new directory /opt/gitlab/sv/postgres-exporter/log/main[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/postgres-exporter/run] action create
    [32m- create new file /opt/gitlab/sv/postgres-exporter/run[0m
    [32m- update content in file /opt/gitlab/sv/postgres-exporter/run from none to b40d34[0m
    [37m--- /opt/gitlab/sv/postgres-exporter/run	2018-05-30 10:05:34.223708669 +0000[0m
    [37m+++ /opt/gitlab/sv/postgres-exporter/.chef-run20180530-48-1dx8c7q	2018-05-30 10:05:34.223708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec 2>&1[0m
    [37m+[0m
    [37m+umask 077[0m
    [37m+exec chpst -e /opt/gitlab/etc/postgres-exporter/env -P -U gitlab-psql:git -u gitlab-psql:git /opt/gitlab/embedded/bin/postgres_exporter --web.listen-address=localhost:9187 --extend.query-path=/var/opt/gitlab/postgres-exporter/queries.yaml[0m
    [37m+[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/opt/gitlab/sv/postgres-exporter/log/run] action create
    [32m- create new file /opt/gitlab/sv/postgres-exporter/log/run[0m
    [32m- update content in file /opt/gitlab/sv/postgres-exporter/log/run from none to b971c9[0m
    [37m--- /opt/gitlab/sv/postgres-exporter/log/run	2018-05-30 10:05:34.243708669 +0000[0m
    [37m+++ /opt/gitlab/sv/postgres-exporter/log/.chef-run20180530-48-cd7gwn	2018-05-30 10:05:34.243708669 +0000[0m
    [37m@@ -1 +1,3 @@[0m
    [37m+#!/bin/sh[0m
    [37m+exec svlogd -tt /var/log/gitlab/postgres-exporter[0m
    [32m- change mode from '' to '0755'[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * template[/var/log/gitlab/postgres-exporter/config] action create
    [32m- create new file /var/log/gitlab/postgres-exporter/config[0m
    [32m- update content in file /var/log/gitlab/postgres-exporter/config from none to 623c00[0m
    [37m--- /var/log/gitlab/postgres-exporter/config	2018-05-30 10:05:34.273708669 +0000[0m
    [37m+++ /var/log/gitlab/postgres-exporter/.chef-config20180530-48-17k23ub	2018-05-30 10:05:34.273708669 +0000[0m
    [37m@@ -1 +1,7 @@[0m
    [37m+s209715200[0m
    [37m+n30[0m
    [37m+t86400[0m
    [37m+!gzip[0m
    [37m+[0m
    [37m+[0m
    [32m- change owner from '' to 'root'[0m
    [32m- change group from '' to 'root'[0m
[0m  * ruby_block[reload postgres-exporter svlogd configuration] action nothing (skipped due to action :nothing)
  * ruby_block[restart postgres-exporter svlogd configuration] action nothing (skipped due to action :nothing)
  * file[/opt/gitlab/sv/postgres-exporter/down] action delete (up to date)
  * link[/opt/gitlab/init/postgres-exporter] action create
    [32m- create symlink at /opt/gitlab/init/postgres-exporter to /opt/gitlab/embedded/bin/sv[0m
[0m  * link[/opt/gitlab/service/postgres-exporter] action create
    [32m- create symlink at /opt/gitlab/service/postgres-exporter to /opt/gitlab/sv/postgres-exporter[0m
[0m  * ruby_block[supervise_postgres-exporter_sleep] action run
    [32m- execute the ruby block supervise_postgres-exporter_sleep[0m
[0m  * directory[/opt/gitlab/sv/postgres-exporter/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * directory[/opt/gitlab/sv/postgres-exporter/log/supervise] action create
    [32m- change mode from '0700' to '0755'[0m
[0m  * file[/opt/gitlab/sv/postgres-exporter/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/postgres-exporter/log/supervise/ok] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/postgres-exporter/supervise/control] action touch (skipped due to only_if)
  * file[/opt/gitlab/sv/postgres-exporter/log/supervise/control] action touch (skipped due to only_if)
  * service[postgres-exporter] action nothing (skipped due to action :nothing)
  * template[/var/opt/gitlab/postgres-exporter/queries.yaml] action create
    [32m- create new file /var/opt/gitlab/postgres-exporter/queries.yaml[0m
    [32m- update content in file /var/opt/gitlab/postgres-exporter/queries.yaml from none to 40142b[0m
    [37m--- /var/opt/gitlab/postgres-exporter/queries.yaml	2018-05-30 10:05:37.343708669 +0000[0m
    [37m+++ /var/opt/gitlab/postgres-exporter/.chef-queries20180530-48-1g55frh.yaml	2018-05-30 10:05:37.343708669 +0000[0m
    [37m@@ -1 +1,175 @@[0m
    [37m+pg_replication:[0m
    [37m+  query: "SELECT EXTRACT(EPOCH FROM (now() - pg_last_xact_replay_timestamp()))::INT as lag, CASE WHEN pg_is_in_recovery() THEN 1 ELSE 0 END as is_replica"[0m
    [37m+  metrics:[0m
    [37m+    - lag:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Replication lag behind master in seconds"[0m
    [37m+    - is_replica:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Indicates if this host is a slave"[0m
    [37m+[0m
    [37m+pg_postmaster:[0m
    [37m+  query: "SELECT pg_postmaster_start_time as start_time_seconds from pg_postmaster_start_time()"[0m
    [37m+  metrics:[0m
    [37m+    - start_time_seconds:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Time at which postmaster started"[0m
    [37m+[0m
    [37m+pg_stat_user_tables:[0m
    [37m+  query: "SELECT schemaname, relname, seq_scan, seq_tup_read, idx_scan, idx_tup_fetch, n_tup_ins, n_tup_upd, n_tup_del, n_tup_hot_upd, n_live_tup, n_dead_tup, n_mod_since_analyze, last_vacuum, last_autovacuum, last_analyze, last_autoanalyze, vacuum_count, autovacuum_count, analyze_count, autoanalyze_count FROM pg_stat_user_tables"[0m
    [37m+  metrics:[0m
    [37m+    - schemaname:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Name of the schema that this table is in"[0m
    [37m+    - relname:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Name of this table"[0m
    [37m+    - seq_scan:[0m
    [37m+        usage: "COUNTER"[0m
    [37m+        description: "Number of sequential scans initiated on this table"[0m
    [37m+    - seq_tup_read:[0m
    [37m+        usage: "COUNTER"[0m
    [37m+        description: "Number of live rows fetched by sequential scans"[0m
    [37m+    - idx_scan:[0m
    [37m+        usage: "COUNTER"[0m
    [37m+        description: "Number of index scans initiated on this table"[0m
    [37m+    - idx_tup_fetch:[0m
    [37m+        usage: "COUNTER"[0m
    [37m+        description: "Number of live rows fetched by index scans"[0m
    [37m+    - n_tup_ins:[0m
    [37m+        usage: "COUNTER"[0m
    [37m+        description: "Number of rows inserted"[0m
    [37m+    - n_tup_upd:[0m
    [37m+        usage: "COUNTER"[0m
    [37m+        description: "Number of rows updated"[0m
    [37m+    - n_tup_del:[0m
    [37m+        usage: "COUNTER"[0m
    [37m+        description: "Number of rows deleted"[0m
    [37m+    - n_tup_hot_upd:[0m
    [37m+        usage: "COUNTER"[0m
    [37m+        description: "Number of rows HOT updated (i.e., with no separate index update required)"[0m
    [37m+    - n_live_tup:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Estimated number of live rows"[0m
    [37m+    - n_dead_tup:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Estimated number of dead rows"[0m
    [37m+    - n_mod_since_analyze:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Estimated number of rows changed since last analyze"[0m
    [37m+    - last_vacuum:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Last time at which this table was manually vacuumed (not counting VACUUM FULL)"[0m
    [37m+    - last_autovacuum:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Last time at which this table was vacuumed by the autovacuum daemon"[0m
    [37m+    - last_analyze:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Last time at which this table was manually analyzed"[0m
    [37m+    - last_autoanalyze:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Last time at which this table was analyzed by the autovacuum daemon"[0m
    [37m+    - vacuum_count:[0m
    [37m+        usage: "COUNTER"[0m
    [37m+        description: "Number of times this table has been manually vacuumed (not counting VACUUM FULL)"[0m
    [37m+    - autovacuum_count:[0m
    [37m+        usage: "COUNTER"[0m
    [37m+        description: "Number of times this table has been vacuumed by the autovacuum daemon"[0m
    [37m+    - analyze_count:[0m
    [37m+        usage: "COUNTER"[0m
    [37m+        description: "Number of times this table has been manually analyzed"[0m
    [37m+    - autoanalyze_count:[0m
    [37m+        usage: "COUNTER"[0m
    [37m+        description: "Number of times this table has been analyzed by the autovacuum daemon"[0m
    [37m+[0m
    [37m+pg_total_relation_size:[0m
    [37m+  query: |[0m
    [37m+    SELECT relnamespace::regnamespace as schemaname,[0m
    [37m+           relname as relname,[0m
    [37m+           pg_total_relation_size(oid) bytes[0m
    [37m+      FROM pg_class[0m
    [37m+     WHERE relkind = 'r';[0m
    [37m+  metrics:[0m
    [37m+    - schemaname:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Name of the schema that this table is in"[0m
    [37m+    - relname:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "Name of this table"[0m
    [37m+    - bytes:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "total disk space usage for the specified table and associated indexes"[0m
    [37m+[0m
    [37m+pg_blocked:[0m
    [37m+  query: |[0m
    [37m+    SELECT[0m
    [37m+      count(blocked.transactionid) AS queries,[0m
    [37m+      '__transaction__' AS table[0m
    [37m+    FROM pg_catalog.pg_locks blocked[0m
    [37m+    WHERE NOT blocked.granted AND locktype = 'transactionid'[0m
    [37m+    GROUP BY locktype[0m
    [37m+    UNION[0m
    [37m+    SELECT[0m
    [37m+      count(blocked.relation) AS queries,[0m
    [37m+      blocked.relation::regclass::text AS table[0m
    [37m+    FROM pg_catalog.pg_locks blocked[0m
    [37m+    WHERE NOT blocked.granted AND locktype != 'transactionid'[0m
    [37m+    GROUP BY relation[0m
    [37m+  metrics:[0m
    [37m+    - queries:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "The current number of blocked queries"[0m
    [37m+    - table:[0m
    [37m+        usage: "LABEL"[0m
    [37m+        description: "The table on which a query is blocked"[0m
    [37m+[0m
    [37m+pg_slow:[0m
    [37m+  query: |[0m
    [37m+    SELECT COUNT(*) AS queries[0m
    [37m+    FROM pg_stat_activity[0m
    [37m+    WHERE state = 'active' AND (now() - query_start) > '1 seconds'::interval[0m
    [37m+  metrics:[0m
    [37m+    - queries:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Current number of slow queries"[0m
    [37m+[0m
    [37m+pg_vacuum:[0m
    [37m+  query: |[0m
    [37m+    SELECT[0m
    [37m+      COUNT(*) AS queries,[0m
    [37m+      MAX(EXTRACT(EPOCH FROM (clock_timestamp() - query_start))) AS age_in_seconds[0m
    [37m+    FROM pg_catalog.pg_stat_activity[0m
    [37m+    WHERE state = 'active' AND trim(query) ~* '\AVACUUM (?!ANALYZE)'[0m
    [37m+  metrics:[0m
    [37m+    - queries:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "The current number of VACUUM queries"[0m
    [37m+    - age_in_seconds:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "The current maximum VACUUM query age in seconds"[0m
    [37m+[0m
    [37m+pg_vacuum_analyze:[0m
    [37m+  query: |[0m
    [37m+    SELECT[0m
    [37m+      COUNT(*) AS queries,[0m
    [37m+      MAX(EXTRACT(EPOCH FROM (clock_timestamp() - query_start))) AS age_in_seconds[0m
    [37m+    FROM pg_catalog.pg_stat_activity[0m
    [37m+    WHERE state = 'active' AND trim(query) ~* '\AVACUUM ANALYZE'[0m
    [37m+  metrics:[0m
    [37m+    - queries:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "The current number of VACUUM ANALYZE queries"[0m
    [37m+    - age_in_seconds:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "The current maximum VACUUM ANALYZE query age in seconds"[0m
    [37m+[0m
    [37m+pg_stuck_idle_in_transaction:[0m
    [37m+  query: |[0m
    [37m+    SELECT COUNT(*) AS queries[0m
    [37m+    FROM pg_stat_activity[0m
    [37m+    WHERE state = 'idle in transaction' AND (now() - query_start) > '10 minutes'::interval[0m
    [37m+  metrics:[0m
    [37m+    - queries:[0m
    [37m+        usage: "GAUGE"[0m
    [37m+        description: "Current number of queries that are stuck being idle in transactions"[0m
    [32m- change mode from '' to '0644'[0m
    [32m- change owner from '' to 'gitlab-psql'[0m
[0m  * execute[/opt/gitlab/bin/gitlab-ctl start postgres-exporter] action run
    [execute] ok: run: postgres-exporter: (pid 1228) 4s
    [32m- execute /opt/gitlab/bin/gitlab-ctl start postgres-exporter[0m
[0mRecipe: gitlab::deprecate-skip-auto-migrations[0m
  * file[/etc/gitlab/skip-auto-reconfigure] action create (skipped due to only_if)
  * ruby_block[skip-auto-migrations deprecation] action run (skipped due to only_if)
Recipe: gitlab::gitlab-rails[0m
